/*!CK:1181880035!*//*1444429444,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["CD1\/B"]); }

__d('UFIAddCommentController',['Parent','React','ReactDOM','ShortProfiles','UFIActionTypes','UFIAddComment.react','UFICallbackStore','UFICentralUpdates','UFIDispatcher','UFIDispatcherContext.react','UFIFeedbackTargets','UFIInstanceState','UFINewCommentNotifier'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();function u(v,w,x){if(!x)x=arguments[3];this._root=v;this._id=w;this._ufiInstanceID=x.instanceid;this._contextArgs=x;if(!this._contextArgs.rootid)this._contextArgs.rootid=v.id;this._contextArgs.ftentidentifier=w;this._dispatcher=new p();this._stores={UFICallbackStore:new n(this._dispatcher)};this._stores.UFICallbackStore.on(l.ADD_COMMENT.SUBMIT_NEW,(function(y){return t.onNewComment(this._id,this._ufiInstanceID,h.byTag(v,'form'),this._contextArgs,y.comment,y.target,y.replyCommentID,y.replyCommentParentID);}).bind(this));this.render();o.subscribe('instance-updated',(function(y,z){var aa=z.updates;if(this._ufiInstanceID in aa)this.render();}).bind(this));o.subscribe('feedback-updated',(function(y,z){var aa=z.updates;if(this._id in aa)this.render();}).bind(this));o.subscribe('feedback-id-changed',(function(y,z){var aa=z.updates;if(this._id in aa)this._id=aa[this._id];}).bind(this));}Object.assign(u.prototype,{render:function(){var v=this._contextArgs,w=s.getKeyForInstance(this._ufiInstanceID,'isediting');r.getFeedbackTarget(this._id,(function(x){v.feedbackisranked=x.isranked;if(x.cancomment&&x.actorforpost)k.get(x.actorforpost,(function(y){var z=i.createElement(q,{dispatcher:this._dispatcher,stores:this._stores},i.createElement(m,{viewerActorID:y.id,hide:w,replyCommentID:null,replyCommentParentID:null,targetID:x.ownerid,initialData:null,ref:null,withoutSeparator:null,editingComment:{},isEditing:false,mentionsDataSource:x.mentionsdatasource,showSendOnEnterTip:x.showsendonentertip,allowPhotoAttachments:x.allowphotoattachments&&!v.isstreaming,allowStickerAttachments:x.allowstickerattachments&&!v.isstreaming,source:v.source,contextArgs:v,subtitle:x.subtitle,isQAndA:x.isqanda,isSnowlift:v.issnowlift,feedbackIsRanked:v.feedbackisranked}));j.render(z,this._root);}).bind(this));}).bind(this));}});f.exports=u;},null);
__d('QuestionsCommentLink',['DOM','Parent'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(l){var m=l&&i.byClass(l,'questionsFeedback'),n=m&&h.scry(m,'.addCommentForm')[0];n&&(n.add_comment_text_text||n.add_comment_text).focus();}var k={question_comment_click:j};b.question_comment_click=j;f.exports=k;},null);
__d('QuestionsFeedback',['Event','Arbiter','DOM','ScrollableArea','UFIUIEvents'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();Object.assign(m,{init:function(n,o){new m(n,o);}});function m(n,o){this._comments=n;this._add_comment=o;i.subscribe(l.Comment,(function(p,q){this._scrollComments(q.isinverted?'toTop':'toBottom');}).bind(this));this._initCommentTextAreaAndFocusListener();}Object.assign(m.prototype,{_scrollComments:function(n){var o=this._comments&&j.scry(this._comments,'.uiScrollableAreaWrap')[0],p=o&&k.getInstance(o);if(n==='toTop'){p&&p.scrollToTop();}else p&&p.scrollToBottom();},_initCommentTextAreaAndFocusListener:function(){var n=this._add_comment&&j.scry(this._add_comment,'.questionsFeedbackAddComment textarea')[0];if(!n)return;this._focusListener=h.listen(n,'focus',this._scrollComments.bind(this));}});f.exports=m;},null);