/*!CK:1969196588!*//*1444165253,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["9rrFr"]); }

__d('loadImage',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j){var k=new Image();k.onload=function(){j(k.width,k.height,k);};k.src=i;}f.exports=h;},null);
__d('PhotoResizeMath',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={getScaledPhotoDimensions:function(i,j,k,l,m){var n=i/j,o=k/l;if(k&&l&&m==='stretch')return {width:k,height:l};if(!k&&l||m==='contain'!==n>=o)return {width:l*n,height:l};if(k)return {width:k,height:k/n};return {width:i,height:j};}};f.exports=h;},null);
__d('PixelzFocus',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={search:function(i,j){var k=0,l=i.length-1;while(k<=l){var m=k+Math.floor((l-k)/2),n=i[m];if(n>j){l=m-1;}else if(n<j){k=m+1;}else return m;}return Math.min(k,l);},forceSpecificPoint:function(i,j,k){var l=1e-09,m=h.search(i,j-k-l)+1,n=h.search(i,j+k);return i.slice(m,n+1);},findBiggestSets:function(i,j){var k=[],l=-1;for(var m=0;m<i.length;++m){var n=i[m],o=m,p=h.search(i,n+j),q=p-o;if(q>l)k=[];if(q>=l){l=q;k.push({low:o,high:p});}}return k;},getBestSet:function(i,j,k){var l=-1,m=null;for(var n=0;n<j.length;++n){var o=j[n],p=i[o.low],q=i[o.high],r=p+(q-p)/2,s=Math.min(p-(r-k),r+k-q);if(s>l){l=s;m=o;}}return m;},getFocusFromSet:function(i,j){var k=i[j.low],l=i[j.high];return k+(l-k)/2;},clampFocus:function(i,j){var k=j/2,l=1-j/2;if(i<k)return k;if(i>l)return l;return i;},convertFromCenterToCSS:function(i,j){if(Math.abs(1-j)<1e-05)return 0;return (i-j/2)/(1-j);},convertFromCSSToCenter:function(i,j){return i*(1-j)+j/2;},getVisible:function(i,j){if(i<j)return i/j;return j/i;},getHidden:function(i,j){return 1-h.getVisible(i,j);},focusHorizontally:function(i,j){return i<j;},convertVectorFromCenterToCSS:function(i,j,k){var l=h.focusHorizontally(j,k),m;if(l){m=i.x/100;}else m=i.x/100;var n=h.convertFromCenterToCSS(m,h.getVisible(j,k));if(l){return {x:n,y:0};}else return {x:0,y:n};},getCropRect:function(i,j,k){var l=h.focusHorizontally(j,k),m=h.getVisible(j,k);if(l){var n=(1-m)*i.x;return {left:n,top:0,width:m,height:1};}else{var o=(1-m)*i.y;return {left:0,top:o,width:1,height:m};}}};f.exports=h;},null);
__d('Pixelz.react',['arrayContains','cx','loadImage','joinClasses','React','PhotoResizeMath','PixelzFocus'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){'use strict';if(c.__markCompiled)c.__markCompiled();var o=l.PropTypes,p=l.createClass({displayName:'Pixelz',propTypes:{width:o.number,height:o.number,resizeMode:o.oneOf(['contain','cover','stretch']),alt:o.string,letterbox:o.bool,borderRadius:o.number,insetBorderColor:o.string,animated:o.bool,upscale:o.bool,cropRect:function(q,r,s){var t=q[r],u='Invalid prop `'+r+'` supplied to `'+s+'`, expected a rectangle with values normalized '+'between 0 and 1.';if(t.left<0||t.top<0||t.width<0||t.height<0||t.left+t.width>1||t.top+t.height>1)return new Error(u);},focus:function(q,r,s){var t=q[r],u='Invalid prop `'+r+'` supplied to `'+s+'`, expected either a {x, y, type} vector where type '+'is `css` or `center` or an array of {x, y} vectors. All the vectors '+'have with values normalized between 0 and 1.';if(Array.isArray(t)){for(var v=0;v<t.length;++v)if(!(t[v].x>=0&&t[v].x<=1)||!(t[v].y>=0&&t[v].y<=1))return new Error(u);}else{if(!t.type)t.type='css';if(!(t.x>=0&&t.x<=1)||!(t.y>=0&&t.y<=1)||!h(['center','css'],t.type))return new Error(u);}}},getDefaultProps:function(){return {resizeMode:'cover',alt:'',letterbox:true,upscale:true,cropRect:{width:1,height:1,top:0,left:0},focus:{x:.5,y:.5,type:'css'}};},getInitialState:function(){return {srcDimensions:{}};},getSrcDimensions:function(){var q=this.props.src,r=this.state.srcDimensions[q];if(r)return r;j(q,(function(s,t){var u={};u[q]={width:s,height:t};this.isMounted()&&this.setState({srcDimensions:u});}).bind(this));return null;},getCropSrcDimensions:function(){var q=this.getSrcDimensions();return {width:q.width*this.props.cropRect.width,height:q.height*this.props.cropRect.height};},getUpscaleCropDimensions:function(){var q=this.getCropSrcDimensions();return m.getScaledPhotoDimensions(q.width,q.height,this.props.width,this.props.height,this.props.resizeMode);},getCropDimensions:function(){var q=this.getUpscaleCropDimensions(),r=this.getCropSrcDimensions();if(!this.props.upscale)return {width:Math.min(q.width,r.width),height:Math.min(q.height,r.height)};return q;},getCropAspectRatio:function(){var q=this.getCropDimensions();return q.width/q.height;},getContainerDimensions:function(){if(this.props.letterbox&&this.props.width&&this.props.height)return {width:this.props.width,height:this.props.height};return this.getCropDimensions();},getContainerAspectRatio:function(){var q=this.getContainerDimensions();return q.width/q.height;},getContainerPosition:function(){return {left:0,top:0};},getFocus:function(){var q=this.props.focus;if(!Array.isArray(q)&&q.type==='css')return {x:q.x,y:q.y};var r=this.getContainerAspectRatio(),s=this.getCropAspectRatio(),t=n.getVisible(r,s),u=n.focusHorizontally(r,s),v;if(!Array.isArray(q)){v=n.convertFromCenterToCSS(u?q.x:q.y,t);}else{var w=q.map(function(z){return u?z.x:z.y;});w.sort();var x=n.findBiggestSets(w,t),y=n.getBestSet(w,x,t);v=n.getFocusFromSet(w,y);}return {x:u?v:.5,y:u?.5:v};},getCropPosition:function(){var q=this.getCropDimensions(),r=this.getContainerDimensions(),s=this.getFocus();return {left:s.x*(r.width-q.width),top:s.y*(r.height-q.height)};},getScaleDimensions:function(){var q=this.getCropDimensions();return {width:q.width/this.props.cropRect.width,height:q.height/this.props.cropRect.height};},getScalePosition:function(){var q=this.getScaleDimensions();return {left:-q.width*this.props.cropRect.left,top:-q.height*this.props.cropRect.top};},getClipCropRectangle:function(){var q=this.getContainerDimensions(),r=this.getCropDimensions(),s=this.getContainerPosition(),t=this.getCropPosition(),u=Math.max(s.left,t.left),v=Math.max(s.top,t.top),w=Math.min(s.top+q.height,t.top+r.height),x=Math.min(s.left+q.width,t.left+r.width);return {left:u,top:v,width:x-u,height:w-v};},getClipCropPosition:function(){var q=this.getClipCropRectangle();return {left:q.left,top:q.top};},getClipCropDimensions:function(){var q=this.getClipCropRectangle();return {width:q.width,height:q.height};},getClipScalePosition:function(){var q=this.getScalePosition(),r=this.getClipCropPosition(),s=this.getCropPosition();return {left:q.left+(s.left-r.left),top:q.top+(s.top-r.top)};},getClipScaleDimensions:function(){return this.getScaleDimensions();},areDimensionsEqual:function(q,r){return q.width===r.width&&q.height===r.height;},shouldAddAllNodesAndStyles:function(){return this.props.animated;},hasCrop:function(){if(this.shouldAddAllNodesAndStyles())return true;var q=this.getContainerDimensions(),r=this.getClipCropDimensions(),s=this.getClipScaleDimensions();if(this.areDimensionsEqual(q,r)||this.areDimensionsEqual(r,s))return false;return true;},hasContainer:function(){if(this.shouldAddAllNodesAndStyles()||this.hasInsetBorder())return true;var q=this.getContainerDimensions(),r=this.getClipScaleDimensions();if(this.areDimensionsEqual(q,r))return false;return true;},hasInsetBorder:function(){return this.shouldAddAllNodesAndStyles()||this.props.insetBorderColor;},applyPositionStyle:function(q,r){if(this.shouldAddAllNodesAndStyles()||r.left)q.left=Math.round(r.left);if(this.shouldAddAllNodesAndStyles()||r.top)q.top=Math.round(r.top);},applyDimensionsStyle:function(q,r){q.width=Math.round(r.width);q.height=Math.round(r.height);},applyBorderRadiusStyle:function(q){if(this.shouldAddAllNodesAndStyles()||this.props.borderRadius)q.borderRadius=this.props.borderRadius||0;},getScaleStyle:function(){var q={},r=this.getClipCropDimensions(),s=this.getClipScaleDimensions();if(this.shouldAddAllNodesAndStyles()||!this.areDimensionsEqual(r,s)){this.applyPositionStyle(q,this.getClipScalePosition());}else this.applyPositionStyle(q,this.getClipCropPosition());this.applyDimensionsStyle(q,this.getClipScaleDimensions());this.applyBorderRadiusStyle(q);return q;},getCropStyle:function(){var q={};this.applyPositionStyle(q,this.getClipCropPosition());this.applyDimensionsStyle(q,this.getClipCropDimensions());this.applyBorderRadiusStyle(q);return q;},getInsetBorderStyle:function(){var q={borderColor:this.props.insetBorderColor||'transparent'};this.applyPositionStyle(q,this.getClipCropPosition());this.applyDimensionsStyle(q,this.getClipCropDimensions());this.applyBorderRadiusStyle(q);return q;},getContainerStyle:function(){var q={};this.applyDimensionsStyle(q,this.getContainerDimensions());this.applyBorderRadiusStyle(q);return q;},getScale:function(){var q=this.getScaleStyle(),r=q.width,s=q.height;q=babelHelpers._extends({},q);delete q.width;delete q.height;return (l.createElement('img',babelHelpers._extends({},this.props,{alt:this.props.alt,className:k(this.props.className,"_56wb"+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":'')),src:this.props.src,style:babelHelpers._extends({},this.props.style||{},q),width:r,height:s})));},getCrop:function(){var q=this.getScale();if(!this.hasCrop())return q;return (l.createElement('div',{className:"_56ma"+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":''),style:this.getCropStyle()},q));},getInsetBorder:function(){if(!this.hasInsetBorder())return null;return (l.createElement('div',{className:"_56lv"+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":''),style:this.getInsetBorderStyle()}));},getContainer:function(){var q=this.getCrop();if(!this.hasContainer())return q;var r=this.getInsetBorder();return (l.createElement('div',{className:"_56jj"+(this.shouldAddAllNodesAndStyles()?' '+"_56t5":''),style:this.getContainerStyle()},q,r));},render:function(){var q=this.getSrcDimensions();if(!q)return l.createElement('span',null);return this.getContainer();}});f.exports=p;},null);
__d('XComposerPhotoUploader',['AsyncUploadRequest','FileInputUploader','JSLogger','PhotosMimeType','PhotosUploadID','createArrayFromMixed','curry','emptyFunction','performanceNow'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';if(c.__markCompiled)c.__markCompiled();function q(r){this.$XComposerPhotoUploader1=r.uploadData||{};this.$XComposerPhotoUploader2=r.uploadEndpoint;this.$XComposerPhotoUploader3=r.retryLimit;this.$XComposerPhotoUploader4=r.concurrentLimit;this.$XComposerPhotoUploader5=r.resizer;this.$XComposerPhotoUploader6=r.onUploadEnqueued||o;this.$XComposerPhotoUploader7=r.onUploadsEnqueued||o;this.$XComposerPhotoUploader8=r.onResizeStart||o;this.$XComposerPhotoUploader9=r.onResizeProgress||o;this.$XComposerPhotoUploader10=r.onResizeSuccess||o;this.$XComposerPhotoUploader11=r.onResizeFailure||o;this.$XComposerPhotoUploader12=r.onUploadSent||o;this.$XComposerPhotoUploader13=r.onUploadStart||o;this.$XComposerPhotoUploader14=r.onUploadProgress||o;this.$XComposerPhotoUploader15=r.onUploadSuccess||o;this.$XComposerPhotoUploader16=r.onUploadFailure||o;this.$XComposerPhotoUploader17=j.create('composer');}q.prototype.upload=function(r){var s=Object.assign({},this.$XComposerPhotoUploader1),t=null;if(!this.$XComposerPhotoUploader18(r)){var u=l.getNewID();r.uploadID=u;s.upload_id=u;this.$XComposerPhotoUploader6({uploadID:u,fileName:r.value.split('/').pop().split('\\').pop()});}else{t=m(r.files);t.forEach((function(x){if(!x.uploadID)x.uploadID=l.getNewID();this.$XComposerPhotoUploader6({uploadID:x.uploadID,fileName:x.name});}).bind(this));}this.$XComposerPhotoUploader7();var v=new i(r).setURI(this.$XComposerPhotoUploader2).setData(s).setAllowCrossOrigin(true).setNetworkErrorRetryLimit(this.$XComposerPhotoUploader3).setUploadInParallel(true);if(t&&t.length>0){v.setFiles({farr:t});if(this.$XComposerPhotoUploader5)v.setPreprocessHandler(this.$XComposerPhotoUploader19.bind(this));if(this.$XComposerPhotoUploader4)v.setConcurrentLimit(this.$XComposerPhotoUploader4);}v.subscribe('progress',(function(x,y){return (this.$XComposerPhotoUploader14(this.$XComposerPhotoUploader20(y,r),y));}).bind(this));v.subscribe('failure',(function(x,y){return (this.$XComposerPhotoUploader16(this.$XComposerPhotoUploader20(y,r),y,t));}).bind(this));v.subscribe('start',(function(x,y){return (this.$XComposerPhotoUploader13(this.$XComposerPhotoUploader20(y,r),y));}).bind(this));v.subscribe('success',(function(x,y){return (this.$XComposerPhotoUploader15(this.$XComposerPhotoUploader20(y,r),y));}).bind(this));try{v.send();this.$XComposerPhotoUploader12(r);}catch(w){this.$XComposerPhotoUploader17.error('error_send_unpublished_files',w);throw w;}};q.prototype.getAsyncUploadRequest=function(r,s){var t=new h().setData(Object.assign({},s&&s.data,this.$XComposerPhotoUploader1)).setFiles({farr:r}).setAllowCrossOrigin(true).setURI(this.$XComposerPhotoUploader2);if(this.$XComposerPhotoUploader4)t.setLimit(this.$XComposerPhotoUploader4);if(this.$XComposerPhotoUploader5)t.setPreprocessHandler(this.$XComposerPhotoUploader19.bind(this));t.subscribe('start',(function(u,v){return (this.$XComposerPhotoUploader13(v.getFile().uploadID,{upload:v}));}).bind(this));t.subscribe('progress',(function(u,v){return (this.$XComposerPhotoUploader14(v.getFile().uploadID,{upload:v,event:v.getProgressEvent()}));}).bind(this));t.subscribe('success',(function(u,v){return (this.$XComposerPhotoUploader15(v.getFile().uploadID,{upload:v,response:v.getResponse()}));}).bind(this));t.subscribe('failure',(function(u,v){return (this.$XComposerPhotoUploader16(v.getFile().uploadID,{upload:v,response:v.getResponse()},r));}).bind(this));return t;};q.prototype.$XComposerPhotoUploader20=function(r,s){if(r.upload){return r.upload.getFile().uploadID;}else return s.uploadID;};q.prototype.$XComposerPhotoUploader19=function(r,s){var t=r.getFile();if(!t||!k(t.type).isJpeg())return s(r);var u=p();this.$XComposerPhotoUploader8(t);this.$XComposerPhotoUploader5.resizeBlob(t,(function(v,w,x){w=w||t;if(v){var y=p()-u;this.$XComposerPhotoUploader11(t,w,v,y);return s(r);}w.uploadID=t.uploadID;w.filename=t.name;r.setFile(w);this.$XComposerPhotoUploader10(t,w,x,p()-u);s(r);}).bind(this),n(this.$XComposerPhotoUploader9,t.uploadID));};q.prototype.$XComposerPhotoUploader18=function(r){return !!r.files&&h.isSupported();};f.exports=q;},null);
__d('updatePhotoProgressBar',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,event){if(event.loaded!=event.total){i.setPosition(50*event.loaded/event.total);}else{i.setPosition(50);i.setTarget(100,2000);}}f.exports=h;},null);
__d('BanzaiScribe',['Banzai'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(k){return {log:function(l,m,n){var o=[m];if(n!=null)o.push(n);h.post('scribe:'+l,o,k);}};}var j=i({});j.create=i;f.exports=j;},null);
__d('SamplingPolicyBase',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(){'use strict';throw 'Tried to instantiate SamplingPolicyBase';}h.prototype.getName=function(){'use strict';return this.name;};h.prototype.isSampled=function(){'use strict';if(typeof this.sampled=='undefined')this.sampled=this.decideIfSampled();return this.sampled;};f.exports=h;},null);
__d('FbtraceForcedByServerPolicy',['FbtraceForcedByServer','SamplingPolicyBase'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j;function k(){this.name='FbtraceForcedByServerPolicy';}k.get=function(){if(typeof j=='undefined')j=new k();return j;};function l(){return h.forced;}Object.assign(k.prototype,i.prototype,{decideIfSampled:l});f.exports=k;},null);
/**
 * @generated SignedSource<<623c7cbcff19956af736c3d064fc689d>>
 *
 * !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 * !! This file is a check-in of a static_upstream project!      !!
 * !!                                                            !!
 * !! You should not modify this file directly. Instead:         !!
 * !! 1) Use `fjs use-upstream` to temporarily replace this with !!
 * !!    the latest version from upstream.                       !!
 * !! 2) Make your changes, test them, etc.                      !!
 * !! 3) Use `fjs push-upstream` to copy your changes back to    !!
 * !!    static_upstream.                                        !!
 * !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 *
 * Copyright (C) 2010 by Johannes Baagoe <baagoe@baagoe.org>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 * @providesModule Alea
 * @preserve-header
 */__d('Alea',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(){var j=4022871197,k=function(l){l=l.toString();for(var m=0;m<l.length;m++){j+=l.charCodeAt(m);var o=.02519603282416938*j;j=o>>>0;o-=j;o*=j;j=o>>>0;o-=j;j+=o*4294967296;}return (j>>>0)*2.3283064365386963e-10;};k.version='Mash 0.9';return k;}function i(){return (function(j){var k=0,l=0,m=0,n=1;if(j.length===0)j=[new Date()];var o=new h();k=o(' ');l=o(' ');m=o(' ');for(var p=0;p<j.length;p++){k-=o(j[p]);if(k<0)k+=1;l-=o(j[p]);if(l<0)l+=1;m-=o(j[p]);if(m<0)m+=1;}o=null;var q=function(){var r=2091639*k+n*2.3283064365386963e-10;k=l;l=m;m=r-(n=r|0);return m;};q.version='Alea 0.9';q.args=j;return q;})(Array.prototype.slice.call(arguments));}f.exports=i;},null);
__d('Random',['Alea','ServerNonce'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('ServerNonce').ServerNonce,j=h(i),k={random:j,uint32:function(){return Math.floor(j()*4294967296);}};f.exports=k;},null);
__d("guardFunction",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j,k){return function(){if(i.apply(k||this,arguments))j.apply(k||this,arguments);};}f.exports=h;},null);
__d('Fbtrace',['Arbiter','BanzaiScribe','ErrorUtils','FbtraceForcedByServer','FbtraceForcedByServerPolicy','Random','SiteData','guardFunction'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p,q;'use strict';var r='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',s='AAAAAAAAAAA';p=babelHelpers.inherits(t,Error);q=p&&p.prototype;function t(ia){q.constructor.call(this,ia);}function u(ia){j.reportError(new t(ia));}function v(){var ia=function(){var la=0,ma=0,na='';for(var oa=10;oa>=0;oa--){if(la<6){ma=m.uint32();la=32;}if(oa===0)ma=ma&7;na=r.charAt(ma&63)+na;ma>>=6;la-=6;}return na;},ja,ka;for(ja=3;ja>0;ja--){ka=ia();if(ka!=s)return ka;}u('failed to generate valid Fbtrace id');return s;}function w(){Object.assign(this,w);}Object.assign(w,{isOn:function(){return false;},replySend:function(ia,ja){},requestSend:function(ia,ja,ka){ca(ia,ja);return {metadata:function(){return undefined;},replyReceive:function(la){}};}});var x=new w();function y(ia,ja,ka){if(!ia)throw {name:'ArgumentError',message:'no valid service name specified'};if(!ja)throw {name:'ArgumentError',message:'no valid version specified'};var la=i,ma=0,na=v(),oa=v(),pa=ba(na),qa={service:ia,version:ja},ra=function(wa){if(typeof wa=='undefined')return 'undefined';if(typeof wa!='string')wa=ra(JSON.stringify(wa));return wa;},sa=function(wa){var xa='';for(var ya in wa){if(xa.length>0)xa+='\x02';xa+=ra(ya)+'\x03'+ra(wa[ya]);}return xa;},ta=function(wa,xa,event,ya,za){ma++;return [za,ma,na,wa,xa,ra(event),sa(ya)].join('\x01');},ua=function(wa,xa,event,ya,za){if(!za&&typeof za=='undefined')za=Date.now()*1000;var ab=ta(wa,xa,event,ya,za);la.log('fbtrace',ab,pa);},va=function(){return oa;};ua(s,oa,'#rqrecv',Object.assign(ka||{},qa));Object.assign(this,y,{replySend:function(wa,xa){xa=babelHelpers._extends({},xa,qa,{success:wa?'true':'false'});ua(s,oa,'#rpsend',xa);},requestSend:function(wa,xa,ya){ca(wa,xa);var za=va(),ab=v();ya=babelHelpers._extends({},ya,qa,{op:wa,'remote:service':xa});ua(za,ab,'#rqsend',ya);return {metadata:function(){return na+ab;},replyReceive:function(bb){ua(za,ab,'#rprecv',Object.assign(bb||{},qa));},parentNode:this};}});}Object.assign(y,{isOn:function(){return true;}});function z(){return x;}function aa(ia,ja,ka){ka=ka||{};ka.init=true;var la=l.get();if(la.isSampled()){return new y(ia,ja,ka);}else return new w();}function ba(ia){var ja=ia.charAt(ia.length-1);return r.indexOf(ja)%32;}function ca(ia,ja){if(!ia)throw {name:'ArgumentError',message:'no valid operation specified'};if(!ja)throw {name:'ArgumentError',message:'no valid remote:service specified'};}function da(ia,ja){var ka=x,la;x=ia;try{la=ja();}finally{x=ka;}return la;}var ea=function(ia,ja){var ka=z(),la=ja.request,ma=false;if(!ka.isOn()&&k.forced&&/\/upload\/(?:composer|photos)\/|\/ajax\/composerx\/attachment\/media\//.test(la.uri.toString())){ka=aa('photo_upload_kludge',String(n.revision||'dev'),{policy:'PhotoUpload'});ma=true;}if(ka.isOn()){var na=ma?{policy:'PhotoUpload'}:{};if(la.userActionId)na.user_action_id=la.userActionId;var oa=ka.requestSend(la.uri.toString(),'www',na);la.fbtraceRemoteNode=oa;la.transport.setRequestHeader('X-Fbtrace-Meta',oa.metadata());}},fa=function(ia,ja){ja.request.fbtraceRemoteNode.replyReceive({is_last:ja.response.is_last,success:true});setTimeout(function(){ja.request.fbtraceRemoteNode.parentNode.replySend(true,{});},0);},ga=function(ia,ja){ja.request.fbtraceRemoteNode.replyReceive({is_last:ja.response.is_last,success:false,error_code:ja.response.error,error_summary:ja.response.errorSummary,error_description:ja.response.errorDescription});setTimeout(function(){ja.request.fbtraceRemoteNode.parentNode.replySend(false,{});},0);},ha=function(ia,ja){return ja.request.fbtraceRemoteNode;};h.subscribe('AsyncRequest/will_send',ea);h.subscribe('AsyncRequest/response',o(ha,fa));h.subscribe('AsyncRequest/error',o(ha,ga));f.exports={defaultNode:z,requestReceive:aa,withDefaultNode:da};},null);
__d('PhotosMultiUploadInput',['Arbiter','Animation','AsyncUploadRequest','ComposerWaterfallEvent','ComposerXController','ComposerXDragDropUtils','ComposerXMarauderLogger','ComposerXMediaUploadHandler','CSS','Dialog','DOM','DragDropTarget','Event','JpegResizer','Parent','PhotosMimeType','PhotosUploadID','PhotosUploadWaterfallXMixin','PUWApplications','PUWMethods','PUWSteps','ProgressBar','Tooltip','WaterfallIDGenerator','XComposerPhotoUploader','$','csx','cx','mixin','performanceNow','fbt','updatePhotoProgressBar','Fbtrace'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma){if(c.__markCompiled)c.__markCompiled();var na,oa,pa=1366052;c("Fbtrace");function qa(wa,xa,ya,za){'use strict';this._grid=ta.getInstance(za.gridID);this._grid.setProgressBarMarkup(wa).setVideoIconMarkup(xa).setConfig(za);ya.getInput().multiple=za.maxselect!=1&&j.isSupported();ya.subscribe('change',(function(ab,event){if(event.getTarget().value)this._grid.doFileUpload(ya);}).bind(this));if(!this._grid.sessionStarted){this._grid.sessionStarted=true;this._grid.logStep(ba.CLIENT_FLOW_BEGIN,{custom_tags:{high_quality:za.initWithHighQuality}});}this._grid.logStep(ba.CLIENT_SELECT_BEGIN);h.inform('PhotosMultiUploadInput/loaded/'+za.gridID,null,h.BEHAVIOR_PERSISTENT);}qa.prototype.getGrid=function(){'use strict';return this._grid;};qa.prototype.onQualitySettingChanged=function(wa){'use strict';this._grid.setQuality(wa);};Object.assign(qa,{imageUploadDone:function(wa,xa,ya,za,ab){ra[wa].imageUploadDone(xa,ya,za,ab);},addCameraImage:function(wa,xa,ya){ra[wa].addCameraImage(xa,ya);},initDragDrop:function(wa,xa){h.inform('PhotosMultiUploadInput/initDragDrop/'+wa,{dragDropArea:xa},h.BEHAVIOR_PERSISTENT);},imageUploadFail:function(wa,xa){ra[wa].removeLoadingIndicator(xa.getFile().uploadID);},doFileUpload:function(wa,xa){ra[wa].doFileUpload(xa);},onFilesDrop:function(wa,xa){ra[wa].onFilesDrop(xa);},onVaultImagesAdded:function(wa,xa){ra[wa].onVaultImagesAdded(xa);},getWaterfallID:function(wa){return ta.getInstance(wa).getWaterfallID();},clearSession:function(wa){ra[wa].clearSession();},getConfig:function(wa){return ra[wa].getConfig();}});var ra={},sa=0;na=babelHelpers.inherits(ta,ja(y));oa=na&&na.prototype;function ta(wa){'use strict';oa.constructor.call(this);this._loadingIndicators={};this._numRemainingFiles=0;this._progressBarMarkup=null;this._videoIconMarkup=null;this._gridID=wa;this._dragDropTarget=null;this._submitListener=null;this._fileInputInstances=[];this._uploadTimers={};this._sessionsStarted=false;this._waterfallID=null;this._resizer=null;this._numUploadsSucceeded=0;this._numUploadsFailed=0;this._uploadIDToFileUpload={};this._failedUploadIDs={};h.subscribe('multi-upload/video-removed/'+this._gridID,(function(){r.remove(this._videoIconMarkup);this._submitListener&&this._submitListener.remove();this._submitListener=null;this._fileInputInstances.forEach(function(xa){xa.clear();});}).bind(this));h.subscribe('multi-upload/image-removed/'+this._gridID,(function(){this._logComposerWaterfallEvent(k.PHOTO_REMOVE);}).bind(this));h.subscribe('PhotosMultiUploadInput/initDragDrop/'+this._gridID,(function(xa,ya){this.initDragDrop(ya.dragDropArea);}).bind(this));h.subscribe('AttachmentsPhotoEditor/logPhotoEditorLaunched'+this._gridID,(function(xa,ya){this.logStep(ba.CLIENT_PHOTO_EDIT_BEGIN);}).bind(this));h.subscribe('AttachmentsPhotoEditor/newImage'+this._gridID,this._onEditedImage.bind(this));}ta.prototype.getWaterfallID=function(){'use strict';if(!this._waterfallID)this._waterfallID=ea.generate();return this._waterfallID;};ta.prototype.getWaterfallAppName=function(){'use strict';return z.WEB_COMPOSER;};ta.prototype.getLoadingIndicator=function(wa){'use strict';var xa=this._loadingIndicators[wa];return xa;};ta.prototype.initDragDrop=function(wa){'use strict';this._dragDropTarget&&this._dragDropTarget.disable();this._dragDropTarget=new s(wa).setOnFilesDropCallback((function(xa){this.onFilesDrop(xa,aa.DRAGDROP);}).bind(this)).setFileFilter(m.filterImages).enable();};ta.prototype.setConfig=function(wa){'use strict';this._config=wa;this._isHighQuality=wa.hasOwnProperty('initWithHighQuality')?wa.initWithHighQuality:true;if(!u.isSupported()){this.logStep(ba.CLIENT_PROCESS_UNAVAILABLE);}else if(this._config.useResizer){this._resizer=new u(this._config.maxselect===1?1:u.DEFAULT_POOL_SIZE);this._resizer.setHighQuality(this._isHighQuality);}if(!this._waterfallID)this._waterfallID=wa.waterfallID;this._concurrentLimit=wa.concurrentLimit;return this;};ta.prototype.setProgressBarMarkup=function(wa){'use strict';this._progressBarMarkup=wa;return this;};ta.prototype.setVideoIconMarkup=function(wa){'use strict';this._videoIconMarkup=wa;var xa=r.find(wa,"._3ev");t.listen(xa,'click',this._onVideoRemoved.bind(this));return this;};ta.prototype.setQuality=function(wa){'use strict';this._isHighQuality=wa;this._resizer&&this._resizer.setHighQuality(wa);this.logStep(ba.CLIENT_QUALITY_SWITCH,{custom_tags:{high_quality:this._isHighQuality}});};ta.prototype.imageUploadDone=function(wa,xa,ya,za){'use strict';this._numUploadsSucceeded++;var ab=this.getLoadingIndicator(xa);if(!ab)return;if(r.contains(document.body,ab.getRoot()))r.replace(ab.getRoot(),wa);var bb={};bb[xa]=ya;this._informImagesAdded(bb,za);this._markUploadAsFinished();this._loadingIndicators[xa]=null;};ta.prototype.addCameraImage=function(wa,xa){'use strict';this.insertIntoGrid(wa);this._informImagesAdded({'0':xa},{});this.logStep(ba.CLIENT_ATTACH_PHOTO,{method:aa.CAMERA,fbid:xa});};ta.prototype._informImagesAdded=function(wa,xa){'use strict';h.inform(['multi-upload/images-added/'+this._gridID,'multi-upload/images-added'],{fbids:wa,tagInfo:{exifLocation:xa}});h.inform('composer/updateViewerLocationEstimate',xa);};ta.prototype._generateLoadingIndicatorForPhoto=function(wa){'use strict';this._generateLoadingIndicator(wa.uploadID);};ta.prototype._generateLoadingIndicator=function(wa){'use strict';this._numRemainingFiles++;var xa=this._progressBarMarkup.cloneNode(true);t.listen(xa,'click',this._clickHandler.bind(this,wa));this.insertIntoGrid(xa);this._loadingIndicators[wa]=new ca(xa);};ta.prototype._generateUploadIDsAndLoadingIndicators=function(wa){'use strict';for(var xa=0;xa<wa.length;xa++){if(!wa[xa].uploadID)wa[xa].uploadID=x.getNewID();this._generateLoadingIndicator(wa[xa].uploadID);}};ta.prototype._clickHandler=function(wa,xa){'use strict';var ya=xa.target,za="_639";if(v.byClass(ya,za))if(this._failedUploadIDs[wa]){this.removeLoadingIndicator(wa);}else this.fileUploadCanceled(wa,this._uploadIDToFileUpload[wa]);var ab="_2zo7";if(v.byClass(ya,ab)){p.hide(r.find(this.getLoadingIndicator(wa).getRoot(),"._2zo5"));this._retryFileUpload(this._uploadIDToFileUpload[wa].getFile());this._failedUploadIDs[wa]=false;}var bb="_2zo8";if(v.byClass(ya,bb))this.removeLoadingIndicator(wa);};ta.prototype.fileUploadFailure=function(wa,xa,ya){'use strict';this._numUploadsFailed++;this._failedUploadIDs[wa]=true;var za=Date.now()-this._uploadTimers[wa],ab=0;if(xa.upload)ab=xa.upload.getRetryCount?xa.upload.getRetryCount():0;var bb=xa.response.getErrorDescription(),cb=xa.response.getError();if(cb===pa)bb=JSON.stringify(ya);this.logStep(ba.CLIENT_TRANSFER_FAIL,{dt:za,error_code:cb,error_info:bb,bytes:xa.upload.getFile().size,auto_retry_count:ab,custom_tags:{high_quality:this._isHighQuality,manual_retry:!!xa.upload.getFile().manuallyRetried}});if(this._config.useNewErrorUI){var db=xa.response.isTransient()||xa.response.getError()==1004||xa.response.getError()==1006,eb=db&&this._uploadIDToFileUpload[wa];this._showNewUploadFailedMessage(wa,xa.upload.getFile().name||xa.upload.getFile().filename||'',xa.response.getErrorSummary(),xa.response.getErrorDescription(),eb,xa.upload.getFile());this._markUploadAsFinished();}else{this._showUploadFailedMessage(wa);this._fadeOutFileUpload(wa);}};ta.prototype._fadeOutFileUpload=function(wa){'use strict';new i(this.getLoadingIndicator(wa).getRoot()).duration(2000).checkpoint().from('opacity',1).to('opacity',0).duration(1000).ondone(this.removeFileUpload.bind(this,wa)).go();};ta.prototype._showUploadFailedMessage=function(wa){'use strict';p.hide(r.find(this.getLoadingIndicator(wa).getRoot(),"._5l83"));p.show(r.find(this.getLoadingIndicator(wa).getRoot(),"._5l82"));};ta.prototype._showNewUploadFailedMessage=function(wa,xa,ya,za,ab,bb){'use strict';var cb=this.getLoadingIndicator(wa).getRoot();p.hide(r.find(cb,"._5l83"));p.show(r.find(cb,"._2zo5"));var db=r.find(cb,"._2zo6");r.setContent(db,xa);var eb=r.find(cb,"._2zo5");da.set(eb,ya+': '+za);if(ab){var fb=r.find(cb,"._2zo7");p.show(fb);}else{var gb=r.find(cb,"._2zo8");p.show(gb);}};ta.prototype._finishUploadBatch=function(){'use strict';h.inform('multi-upload/images-upload-completed/'+this._gridID);if(this._numUploadsFailed>0){this.logStep(ba.CLIENT_TRANSFER_BATCH_FAIL,{volume:this._numUploadsFailed,batch_size:this._numUploadsSucceeded+this._numUploadsFailed});}else this.logStep(ba.CLIENT_TRANSFER_BATCH_SUCCESS,{volume:this._numUploadsSucceeded});this._numUploadsSucceeded=0;this._numUploadsFailed=0;};ta.prototype.fileUploadCanceled=function(wa,xa){'use strict';xa&&xa.abort();var ya={latency:Date.now()-this._uploadTimers[wa]};if(xa&&xa.getFile())ya.bytes=xa.getFile().size;this.logStep(ba.CLIENT_TRANSFER_CANCEL,ya);this.removeFileUpload(wa);};ta.prototype.removeFileUpload=function(wa){'use strict';this.removeLoadingIndicator(wa);this._markUploadAsFinished();};ta.prototype._markUploadAsFinished=function(){'use strict';this._numRemainingFiles=Math.max(0,this._numRemainingFiles-1);if(this._numRemainingFiles===0)this._finishUploadBatch();};ta.prototype.getVideoOrPhotoUploadCallback=function(wa,xa){'use strict';var ya=this;return function(za){if(za){var ab=v.byTag(ga(ya._gridID),'form'),bb=l.getComposerID(ab),cb=new o(bb);cb.handleVideoSelected(wa);}else if(xa){ya._photosSelected(wa);}else new q().setBody(la._("Sorry, you can only select video files.")).setTitle(la._("Unsupported File")).setModal(true).setButtons(q.OK).show();};};ta.prototype.doFileUpload=function(wa){'use strict';var xa=false,ya=false;switch(this._config.supportedFileTypes){case 'photos':ya=true;break;case 'videos':xa=true;break;case 'both':xa=ya=true;break;}this._submitListener&&this._submitListener.remove();var za=this.getVideoOrPhotoUploadCallback(wa,ya);if(xa){o.isVideoOrAnimatedGifAsync(wa,za);}else za(false);};ta.prototype.getConfig=function(){'use strict';return this._config;};ta.prototype._resizeUpload=function(wa,xa){'use strict';var ya=wa.getFile();if(!ya||!w(ya.type).isJpeg())return xa(wa);var za=ka();this.logStep(ba.CLIENT_PROCESS_BEGIN,{bytes:ya.size,custom_tags:{high_quality:this._isHighQuality}});this._resizer.resizeBlob(ya,(function(ab,bb,cb){bb=bb||ya;if(ab){this.logStep(ba.CLIENT_PROCESS_FAIL,{dt:ka()-za,bytes:bb.size,error_code:ab.code,error_info:ab.message,custom_tags:{high_quality:this._isHighQuality}});return xa(wa);}bb.uploadID=ya.uploadID;bb.filename=ya.name;wa.setFile(bb);this.logStep(ba.CLIENT_PROCESS_SUCCESS,{dt:ka()-za,media_data_size:ya.size,bytes:bb.size,custom_tags:{high_quality:this._isHighQuality,skipped_resizing:cb}});xa(wa);}).bind(this),this._onResizeProgress.bind(this,ya.uploadID));};ta.prototype._onResizeStart=function(wa){'use strict';this.logStep(ba.CLIENT_PROCESS_BEGIN,{bytes:wa.size,custom_tags:{high_quality:this._isHighQuality}});};ta.prototype._onResizeFail=function(wa,xa,ya,za){'use strict';this.logStep(ba.CLIENT_PROCESS_FAIL,{dt:za,bytes:xa.size,error_code:ya.code,error_info:ya.message,custom_tags:{high_quality:this._isHighQuality}});};ta.prototype._onResizeSuccess=function(wa,xa,ya,za){'use strict';this.logStep(ba.CLIENT_PROCESS_SUCCESS,{dt:za,media_data_size:wa.size,bytes:xa.size,custom_tags:{high_quality:this._isHighQuality,skipped_resizing:ya}});};ta.prototype._isExceedMaxSelect=function(wa){'use strict';return this._config.maxselect>1&&wa>this._config.maxselect;};ta.prototype._showTooManyPhotosDialog=function(){'use strict';new q().setTitle(la._("Too Many Photos")).setBody(la._({"*":"Sorry, you can only add {maxselect} photos to a message. If you'd like, you can add photos to additional messages."},[la.param('maxselect',this._config.maxselect,[0])])).setButtons(q.OK).setModal(true).show();};ta.prototype._photosSelected=function(wa){'use strict';var xa=wa.getInput(),ya=ua(xa);if(this._isExceedMaxSelect(ya)){this._showTooManyPhotosDialog();return;}this._onBeforeAddUploadedImages();this._upload(wa,ya);};ta.prototype._upload=function(wa,xa){'use strict';var ya=wa.getInput(),za=this._config.uploadData;if(this._config.waterfallID)za.qn=this._config.waterfallID;var ab=(function(){h.inform('multi-upload/images-upload-start/'+this._gridID,{imageCount:xa});}).bind(this),bb=new fa({uploadEndpoint:this._config.photoEndpoint,uploadData:za,retryLimit:this._config.retryLimit,concurrentLimit:this._config.concurrentLimit,resizer:this._resizer,onUploadEnqueued:this._generateLoadingIndicatorForPhoto.bind(this),onUploadsEnqueued:ab,onUploadSent:function(){return wa.clear();},onResizeStart:this._onResizeStart.bind(this),onResizeProgress:this._onResizeProgress.bind(this),onResizeSuccess:this._onResizeSuccess.bind(this),onResizeFailure:this._onResizeFail.bind(this),onUploadStart:this._onFileUploadStart.bind(this),onUploadProgress:this._onUploadProgress.bind(this),onUploadSuccess:this._onFileUploadSuccess.bind(this),onUploadFailure:this.fileUploadFailure.bind(this)});bb.upload(ya);this.logStep(ba.CLIENT_SELECT_SUCCESS,{times_selected:sa++,volume:xa,method:'file_selector'});};ta.prototype._onVideoRemoved=function(){'use strict';this._dragDropTarget&&this._dragDropTarget.enable();h.inform('multi-upload/video-removed/'+this._gridID);};ta.prototype.removeLoadingIndicator=function(wa){'use strict';var xa=this.getLoadingIndicator(wa);xa&&r.remove(xa.getRoot());delete this._loadingIndicators[wa];h.inform('multi-upload/loading-indicator-removed/'+this._gridID);};ta.prototype._onFileUploadStart=function(wa,xa){'use strict';this._uploadIDToFileUpload[wa]=xa.upload;var ya=r.find(this.getLoadingIndicator(wa).getRoot(),"._639");p.show(ya);this._uploadTimers[wa]=Date.now();var za={custom_tags:{high_quality:this._isHighQuality}};if(xa.upload&&xa.upload.getFile())za.size=xa.upload.getFile().size;this.logStep(ba.CLIENT_TRANSFER_BEGIN,za);this._logComposerWaterfallEvent(k.PHOTO_ADD);};ta.prototype._onUploadProgress=function(wa,xa){'use strict';var ya=this.getLoadingIndicator(wa);if(!ya||this._failedUploadIDs[wa])return;this._showProgressBar(ya);p.removeClass(ya.getRoot(),"_5v_0");ma(ya,xa.event);};ta.prototype._onResizeProgress=function(wa,event){'use strict';var xa=this.getLoadingIndicator(wa);if(!xa)return;this._showProgressBar(xa);p.addClass(xa.getRoot(),"_5v_0");xa.setPosition(100*event.written/event.total);};ta.prototype._showProgressBar=function(wa){'use strict';p.hide(r.find(wa.getRoot(),"._2om"));p.show(r.find(wa.getRoot(),"._5e4h"));};ta.prototype._onFileUploadSuccess=function(wa,xa){'use strict';var ya=Date.now()-this._uploadTimers[wa],za={dt:ya};if(xa.upload){za.bytes=xa.upload.getFile().size;za.auto_retry_count=xa.upload.getRetryCount?xa.upload.getRetryCount():0;za.custom_tags={high_quality:this._isHighQuality,manual_retry:!!xa.upload.getFile().manuallyRetried};}this.logStep(ba.CLIENT_TRANSFER_SUCCESS,za);this._logComposerWaterfallEvent(k.PHOTO_ADD_SUCCESS);};ta.prototype._logComposerWaterfallEvent=function(event){'use strict';if(!v.byClass(ga(this._gridID),"_119"))return;n.logEvent(event,this._getComposerID());};ta.prototype._getComposerID=function(){'use strict';return l.getComposerID(this._gridID);};ta.prototype._getAsyncUploadRequest=function(wa){'use strict';var xa=new fa({uploadEndpoint:this._config.photoEndpoint,uploadData:this._config.uploadData,concurrentLimit:this._config.concurrentLimit,onUploadStart:this._onFileUploadStart.bind(this),onUploadProgress:this._onUploadProgress.bind(this),onUploadSuccess:this._onFileUploadSuccess.bind(this),onUploadFail:this.fileUploadFailure.bind(this)});return xa.getAsyncUploadRequest(wa);};ta.prototype._onEditedImage=function(wa,xa){'use strict';this._onBeforeAddUploadedImages();this.logStep(ba.CLIENT_SELECT_BEGIN);this._generateUploadIDsAndLoadingIndicators([xa.blob]);var ya=this._getGridItemElementByFBID(xa.fbid);if(ya){var za=this._loadingIndicators[xa.blob.uploadID].getRoot();r.insertBefore(ya,za);}h.inform('multi-upload/images-upload-start/'+this._gridID,{imageCount:1,method:aa.EDITOR});var ab=this._getAsyncUploadRequest([xa.blob]);ab.setData(Object.assign({},this._config.uploadData,{original_fbid:xa.fbid,xy_tags:xa.xyTags,stickers:xa.stickers,text_overlays:xa.textOverlays,has_crop:xa.hasCrop,has_filter:xa.hasFilter}));ab.send();this.logStep(ba.CLIENT_SELECT_SUCCESS,{volume:1,method:aa.EDITOR});this.logStep(ba.CLIENT_PHOTO_EDIT_SUCCESS);};ta.prototype._getGridItemElementByFBID=function(wa){'use strict';var xa=r.scry(ga(this._gridID),".fbVaultGridItem");for(var ya=0;ya<xa.length;ya++)if(xa[ya].dataset.originalfbid==wa)return xa[ya];return null;};ta.prototype.onVaultImagesAdded=function(wa){'use strict';var xa=[];for(var ya=0;ya<wa.length;ya++)xa.push({imageID:wa[ya]});this._generateUploadIDsAndLoadingIndicators(xa);new j('/ajax/composerx/attachment/media/multi_upload_vault_images/').setData(Object.assign({},{vault_images:xa,grid_id:this._gridID})).setAllowCrossOrigin(true).send();};ta.prototype.onFilesDrop=function(wa,xa){'use strict';if(this._isExceedMaxSelect(wa.length)){this._showTooManyPhotosDialog();return;}this._onBeforeAddUploadedImages();this.logStep(ba.CLIENT_SELECT_BEGIN);this._generateUploadIDsAndLoadingIndicators(wa);h.inform('multi-upload/images-upload-start/'+this._gridID,{imageCount:wa.length,method:xa||aa.DRAGDROP});var ya=this._getAsyncUploadRequest(wa);if(this._resizer)ya.setPreprocessHandler(this._resizeUpload.bind(this));ya.send();this.logStep(ba.CLIENT_SELECT_SUCCESS,{volume:wa.length,method:xa||aa.DRAGDROP});};ta.prototype._retryFileUpload=function(wa){'use strict';this._numRemainingFiles++;h.inform('multi-upload/images-upload-start/'+this._gridID,{imageCount:1});this.logStep(ba.CLIENT_TRANSFER_MANUAL_RETRY);wa.manuallyRetried=true;var xa=this._getAsyncUploadRequest([wa]);xa.send();};ta.prototype._onBeforeAddUploadedImages=function(){'use strict';if(!this.sessionStarted)this.logStep(ba.CLIENT_FLOW_BEGIN);if(this._config.maxselect==1)h.inform('multi-upload/composer-reset/'+this._gridID);this.sessionStarted=true;};ta.prototype.clearSession=function(){'use strict';this.sessionStarted=false;};ta.prototype.insertIntoGrid=function(wa){'use strict';var xa=r.scry(ga(this._gridID),"._577")[0];if(xa){r.insertBefore(xa,wa);}else r.prependContent(ga(this._gridID),wa);};ta.prototype._getUploadID=function(wa,xa){'use strict';if(wa.upload){return wa.upload.getFile().uploadID;}else return xa.uploadID;};ta.getInstance=function(wa){'use strict';ra[wa]=ra[wa]||new ta(wa);return ra[wa];};function ua(wa){if(!va(wa))return 1;return wa.files.length;}function va(wa){return !!wa.files&&j.isSupported();}f.exports=qa;},null);
__d('TimelineMapScrollableArea',['Animation','ArbiterMixin','CSS','DOM','Event','Run','Scroll','SimpleDrag','Style','Vector','$','shield'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();function t(u,v){u&&this.init(r(u),v);}Object.assign(t.prototype,i,{init:function(u,v){v=v||{};this._elem=u;this._wrap=k.find(u,'div.fbScrollableAreaWrap');this._body=k.find(this._wrap,'div.fbScrollableAreaBody');this._track=k.find(u,'div.fbScrollableAreaTrack');this._gripper=k.find(this._track,'div.fbScrollableAreaGripper');this._options=v;this.adjustGripper();this._listeners=[l.listen(this._wrap,'scroll',this._handleScroll.bind(this))];if(v.fade!==false)this._listeners.push(l.listen(u,'mouseenter',s(this.adjustGripper,this)),l.listen(u,'mouseenter',s(this.showScrollbar,this)),l.listen(u,'mousemove',this._handleMousemove.bind(this)),l.listen(u,'mouseout',s(this.hideScrollbar,this)));if(v.fade!==undefined)this._listeners.push(l.listen(this._track,'click',this.clickToScroll.bind(this)));if(v.verticalscroll)this._listeners.push(l.listen(this._wrap,'mousewheel',this.mouseWheel.bind(this)),l.listen(this._wrap,'DOMMouseScroll',this.mouseWheel.bind(this)));this.initDrag();if(!v.persistent)m.onLeave(this.destroy.bind(this));},getRoot:function(){return this._elem;},initDrag:function(){var u=new o(this._gripper);u.subscribe('start',(function(v,event){if(!(event.which&&event.which===1||event.button&&event.button===1))return;this.inform('dragstart');var w=q.getEventPosition(event).x,x=this._gripper.offsetLeft,y=u.subscribe('update',(function(aa,ba){var ca=q.getEventPosition(ba).x-w,da=this._elem.clientWidth,ea=this._body.offsetWidth,fa=this._track.offsetWidth,ga=da/ea*fa,ha=ea-this._wrap.offsetWidth,ia=x+ca,ja=fa-ga;ia=Math.max(Math.min(ia,ja),0);var ka=ia/ja*ha;n.setLeft(this._wrap,ka);}).bind(this)),z=u.subscribe('end',(function(){u.unsubscribe(y);u.unsubscribe(z);this.inform('dragend');}).bind(this));}).bind(this));},adjustGripper:function(){var u=this._elem.clientWidth,v=this._body.offsetWidth,w=this._track.offsetWidth,x=u/v*w;if(x<w){p.set(this._gripper,'width',x+'px');var y=n.getLeft(this._wrap)/v*w;p.set(this._gripper,'left',y+'px');j.show(this._gripper);}else j.hide(this._gripper);this._checkContentBoundaries();return this;},_checkContentBoundaries:function(){var u=n.getLeft(this._wrap),v=this._wrap.scrollWidth-this._wrap.clientWidth;j.conditionClass(this._elem,'contentBefore',u>0);j.conditionClass(this._elem,'contentAfter',u<v);},destroy:function(){this._listeners.forEach(function(u){u.remove();});this._listeners.length=0;},_handleMousemove:function(event){var u=q.getElementPosition(this._track).y,v=q.getElementDimensions(this._track).y;if(Math.abs(u+v/2-q.getEventPosition(event).y)<25){this.showScrollbar(false);}else this.hideScrollbar();},_handleScroll:function(event){this.adjustGripper();if(this._options.fade!==false)this.showScrollbar();},hideScrollbar:function(){if(!this._scrollbarVisible)return this;this._scrollbarVisible=false;if(this._hideTimeout){clearTimeout(this._hideTimeout);this._hideTimeout=null;}this._hideTimeout=setTimeout((function(){if(this._scrollbarAnimation){this._scrollbarAnimation.stop();this._scrollbarAnimation=null;}this._scrollbarAnimation=new h(this._track).from('opacity',1).to('opacity',0).duration(250).ondone(j.addClass.bind(null,this._track,'invisible_elem')).go();}).bind(this),750);return this;},showScrollbar:function(u){if(this._scrollbarVisible)return this;this._scrollbarVisible=true;if(this._hideTimeout){clearTimeout(this._hideTimeout);this._hideTimeout=null;}if(this._scrollbarAnimation){this._scrollbarAnimation.stop();this._scrollbarAnimation=null;}this.adjustGripper();p.set(this._track,'opacity',1);j.removeClass(this._track,'invisible_elem');if(u!==false)this.hideScrollbar();return this;},clickToScroll:function(event){var u=q.getEventPosition(event).x,v=this._elem.clientWidth,w=this._body.offsetWidth,x=this._track.offsetWidth,y=v/w*x,z=q.getElementPosition(this._gripper);if(u>=z.x&&u<=z.x+y)return;var aa=u<z.x?-1:1,ba=this._wrap.offsetWidth*.8*aa;this.scrollBy(ba);},scrollBy:function(u){this.setScroll(n.getLeft(this._wrap)+u);},getMaxBodyOffset:function(){return this._body.offsetWidth-this._wrap.offsetWidth;},setScroll:function(u){var v=u;v=Math.max(Math.min(v,this.getMaxBodyOffset()),0);n.setLeft(this._wrap,v);},scrollIntoView:function(u){var v=this._wrap.clientWidth,w=u.offsetWidth,x=n.getLeft(this._wrap),y=x+v,z=u.offsetLeft,aa=z+w;if(z<x||v<w){this.setScroll(z);}else if(aa>y)this.setScroll(x+(aa-y));},mouseWheel:function(event){if(this.getMaxBodyOffset()<=0)return;var u=0;if(event.wheelDelta){var v=event.wheelDelta;if(event.wheelDeltaX&&event.wheelDeltaY)v=Math.abs(event.wheelDeltaX)>Math.abs(event.wheelDeltaY)?event.wheelDeltaX:event.wheelDeltaY;u=-v*10/40;}else if(event.detail)u=event.detail*10;this.scrollBy(u);event.prevent();}});f.exports=b.TimelineMapScrollableArea||t;},null);
__d('MessagingConst',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={APP_ID:313785040330,XD_MESSAGE:{SANDBOX_READY:'sandbox_ready',SET_CONTENT:'set_content',HTML_SIZE:'html_size',REFRESH_SIZE:'refresh_size'},SHINGLE_SCROLL_TRIGGER:5,EVENTS:{MESSAGE_SENT:'messaging/message_sent'},initConstants:function(i){Object.assign(h,i);}};f.exports=h;},null);
__d('WebMessengerDetailViewRecentMessagesControl',['Event','Animation','CSS','WebMessengerDetailViewUnreadMessagesNotice','DOM','Arbiter','GroupChatMessageBlockAlert','MercuryLastMessageIndicator.react','MercuryListUpdateRenderer','MercuryAPIArgsSource','MercuryConfig','MercuryLogMessageType','MercurySourceType','MercuryThreadlistConstants','MercuryViewer','MercuryMessageGroup','WebMessengerMessagesSelection','MessagingTag','MessengerContextBannerBootloader','ReactDOM','ReactComponentRenderer','MercuryShareAttachmentRenderLocations','WebMessengerStateConstants','WebMessengerStateManager','Style','WebMessengerTemplates','WebMessengerThreadMessagesRenderer','UserActivity','WebMessengerConstants','WebMessengerInfoBoxRenderer','WebMessengerMessageIDFinder','WebMessengerSubscriptionsHandler','cx','debounce','formatDate','ge','fbt','MercuryBlockedParticipants','MercuryMessageActions','MercuryMessageObject','MercuryMessages','MercuryThreadInformer','MercuryThreadActions','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra){if(c.__markCompiled)c.__markCompiled();var sa=c('MercuryBlockedParticipants').get(),ta=c('MercuryMessageActions').get(),ua=c('MercuryMessageObject').get(),va=c('MercuryMessages').get(),wa=c('MercuryThreadInformer').get(),xa=c('MercuryThreadActions').get(),ya=c('MercuryThreads').get();function za(tb,ub,vb,wb,xb,yb,zb,ac){'use strict';this._manager=tb;this._rootElement=ub;this._loadingSpinner=vb;this._noSelectedConversation=wb;this._newMessageLink=xb;this._showUnreadLink=yb;this.contextBanner=zb;l.empty(this._rootElement);this._pagerExponent=-1;var bc=ga[':fb:web-messenger:read-view:recent-messages'].build();l.setContent(this._rootElement,bc.getRoot());this._selectedConversationView=bc.getRoot();this._messageList=bc.getNode('messagelist');this._loadMoreButton=bc.getNode('loadMoreButton');this._loadMoreLink=bc.getNode('loadMoreLink');this._loadMoreCount=bc.getNode('loadMoreCount');this._loadingMoreCount=bc.getNode('loadingMoreCount');this._indicatorNode=bc.getNode('lastMessageIndicator');this._unseenMessagesNotice=new k(this._manager);this._unseenMessagesNotice.setNoticeContextNode(ac);this._active=false;this._state=null;this._threadID=null;this._bugReportingEnabled=false;this._currentCountMap={};this._olderMessageID={};this._loadMessagesInFlight={};ha.setupSelectionListener(this._messageList);this._manager.addScrollCallback(oa(sb.bind(null,this),500));ma.addSubscriptions(h.listen(this._loadMoreLink,'click',kb.bind(null,this)),wa.subscribe('messages-reordered',(function(cc,dc){var ec=this._threadID&&dc[this._threadID];if(ec)gb(this);}).bind(this)),wa.subscribe('messages-updated',(function(cc,dc){var ec=this._threadID&&dc[this._threadID];if(ec)var fc=Object.keys(ec),gc=fc.length&&ec[fc[0]];if(ec&&gc)gb(this,dc[this._threadID]);}).bind(this)),wa.subscribe('messages-updated',sb.bind(null,this)),wa.subscribe('messages-received',(function(cc,dc){if(this._threadID&&dc[this._threadID])jb(this,dc);}).bind(this)),wa.subscribe('thread-read-changed',(function(cc,dc){if(dc[this._threadID])pb(this,dc[this._threadID]);}).bind(this)),this._manager.subscribe('scrolledNearTop',(function(){this._active&&kb(this);}).bind(this)));}za.prototype.hideView=function(){'use strict';this._active=false;j.hide(this._rootElement);j.hide(this._loadingSpinner);j.hide(this._noSelectedConversation);j.hide(this.contextBanner);this._unseenMessagesNotice.hideView();this._manager._flexArea.setBottomAligned(false);};za.prototype.updateView=function(){'use strict';this._unseenMessagesNotice.updateView();this._active=true;this._manager._flexArea.setBottomAligned(true);j.show(this._rootElement);if(this.contextBanner)j.show(this.contextBanner);var tb=bb(this);cb(this);x.clear();if(tb){db(this);}else nb(this);};za.prototype.renderContextBanner=function(tb,ub){'use strict';if(this.contextBanner&&!this.contextBannerElem)z.bootload(tb,ca.WEB_INBOX,(function(vb){this.contextBannerElem=vb;fa.set(this._rootElement,'padding-top','80px');l.prependContent(this.contextBanner,this.contextBannerElem);j.show(this.contextBanner);}).bind(this),ub);};za.prototype.unmountContextBanner=function(){'use strict';if(this.contextBannerElem){aa.unmountComponentAtNode(this.contextBannerElem);this.contextBannerElem=null;l.empty(this.contextBanner);}};za.prototype.destroy=function(){'use strict';ab(this);this._unseenMessagesNotice.destroy();aa.unmountComponentAtNode(this._indicatorNode);this.unmountContextBanner();};function ab(tb){tb._messagesSubscription&&va.unsubscribe(tb._messagesSubscription.subscriber_id,tb._messagesSubscription.thread_id);tb._messagesSubscription=null;}function bb(tb){var ub=ea.getCurrentStateData();if(!tb._threadID||tb._threadID!=ub.thread_id)return true;return false;}function cb(tb){var ub=ea.getCurrentStateData();tb._state=ea.getCurrentDetailState();tb._threadID=ub.thread_id;tb._selectionEnabled=!!ub.message_action;tb._bugReportingEnabled=ub.bug_reporting_enabled;ha.updateSelection(tb._messageList);j.conditionClass(tb._messageList,'bugReportingEnabled',tb._bugReportingEnabled);}function db(tb){l.scry(tb._rootElement,'.stickerContainer').forEach(function(vb){return aa.unmountComponentAtNode(vb);});l.empty(tb._messageList);tb.unmountContextBanner();var ub=null;if(tb._threadID)ub=ya.getThreadMetaNow(tb._threadID);if(ub&&sa.isPresentInGroupThread(ub)){n.show(sa.inGroupThread(ub),function(){return eb(tb);},function(){ta.send(ua.constructLogMessageObject(t.TITAN_WEB,tb._threadID,s.UNSUBSCRIBE,{removed_participants:[v.getID()]}),null,q.WEBMESSENGER);eb(tb);});}else eb(tb);}function eb(tb){j.show(tb._loadingSpinner);j.hide(tb._loadMoreButton);ab(tb);tb._pagerExponent=-1;aa.unmountComponentAtNode(tb._indicatorNode);if(tb._lastMessageIndicator){tb._lastMessageIndicator.unmount();delete tb._lastMessageIndicator;}if(tb._threadID){j.show(tb._selectedConversationView);j.hide(tb._noSelectedConversation);tb._manager._flexArea.showAtTop(false);if(!tb._olderMessageID[tb._threadID]){fb(tb);}else gb(tb);tb._manager.scrollToBottom(false);}else{rb(tb);j.hide(tb._selectedConversationView);j.show(tb._noSelectedConversation);j.hide(tb._loadingSpinner);tb._manager._flexArea.showAtTop(true);}}function fb(tb){tb._loadMessagesInFlight[tb._threadID]=true;tb._currentCountMap[tb._threadID]=ja.INITIAL_MESSAGES_LIMIT;j.hide(tb._loadMoreButton);var ub=va.getThreadMessagesRange(tb._threadID,0,tb._currentCountMap[tb._threadID],hb.bind(null,tb),null,q.WEBMESSENGER);if(ub){tb._messagesSubscription={subscriber_id:ub,thread_id:tb._threadID};}else gb(tb);}function gb(tb,ub){if(!tb._threadID||!tb._olderMessageID[tb._threadID])return;var vb=va.getThreadMessagesSinceTimestamp(tb._threadID,qb(tb._olderMessageID[tb._threadID]));if(vb.length>tb._currentCountMap[tb._threadID])tb._currentCountMap[tb._threadID]=vb.length;ib(tb,vb,ub);}function hb(tb,ub){tb._loadMessagesInFlight[tb._threadID]=false;if(ub&&ub.length){var vb=ub[0].timestamp,wb=tb._olderMessageID[tb._threadID]?qb(tb._olderMessageID[tb._threadID]):null;if(!wb||vb<wb)tb._olderMessageID[tb._threadID]=ub[0].message_id;}}function ib(tb,ub,vb){j.hide(tb._loadingSpinner);j.conditionShow(tb._loadMoreButton,!va.hasLoadedAllMessages(tb._threadID));var wb=ya.getThreadMetaNow(tb._threadID);if(wb){var xb=wb.message_count-ub.length;xb=xb<0?0:xb;l.setContent(tb._loadMoreCount,xb);l.setContent(tb._loadingMoreCount,xb);}if(wb&&wb.is_canonical&&r.ShowContextBanner&&va.hasLoadedAllMessages(tb._threadID))tb.renderContextBanner(tb._threadID);var yb=function(gc){var hc,ic=qa('wm:'+gc);if(ic)hc=la.findAll(ic);return hc||[];},zb=[],ac=w.calculateMessageGroups(ub),bc={},cc=[];ac.forEach(function(gc){var hc=gc[0].message_id,ic=false;if(vb){ic=gc.some(function(kc){return kc.message_id in vb;});if(!ic){zb=yb(hc);ic=zb.some(function(kc){return kc in vb;});}}if(!ic){zb=yb(hc);if(gc.length==zb.length){for(var jc=0;jc<gc.length;jc++)if(gc[jc].message_id!=zb[jc]){ic=true;break;}}else ic=true;}if(ic)bc[hc]=1;cc.push('wm:'+hc);});var dc=function(gc){return !bc[ac[gc][0].message_id];},ec=function(gc){var hc=ac[gc],ic=ha.renderMessageGroup(hc);if(gc==cc.length-1)tb._messageGroup=ic;return ic.getRoot();},fc=function(gc){return ha.renderMessageSeparatorForIndex(ac,gc);};p.updateList(tb._messageList,cc,dc,ec,fc);tb._lastMessage=ub[ub.length-1];mb(tb);nb(tb);tb._manager.poke();}function jb(tb,ub){var vb=ub[tb._threadID],wb=tb._manager._flexArea.getScrollableArea(),xb=wb.getScrollHeight();vb.forEach(function(ac){ac.timestamp_relative=pa(new Date(ac.timestamp),'g:ia');var bc=w.canAppendMessageToLastGroup(tb._lastMessage,ac);if(!bc){tb._messageGroup=ha.renderMessageGroup([ac]);var cc=ac.timestamp,dc=tb._lastMessage?tb._lastMessage.timestamp:0,ec=ja.READ_VIEW_SEPARATOR_TIME_LIMIT;if(!dc||cc-dc>=ec){var fc=ha.renderMessageSeparator(ac);l.appendContent(tb._messageList,fc);}l.appendContent(tb._messageList,tb._messageGroup.getRoot());}else ha.appendMessageToGroup(tb._messageGroup,ac);if(ac.author!=v.getID())j.addClass(tb._messageGroup.getRoot(),'unreadHighlight');tb._lastMessage=ac;});tb._manager._flexArea.poke();var yb=wb.getScrollHeight(),zb=wb.getScrollTop();tb._unseenMessagesNotice.updateOnMessagesReceived(xb,yb,zb,ub);mb(tb);if(tb._manager.isScrolledToBottom())nb(tb);}function kb(tb){j.addClass(tb._loadMoreButton,'async_saving');if(tb._loadMessagesInFlight[tb._threadID])return;tb._loadMessagesInFlight[tb._threadID]=true;tb._pagerExponent=Math.min(tb._pagerExponent+1,ja.EXPONENTIAL_PAGER_MAX_CYCLES);var ub=Math.pow(2,tb._pagerExponent),vb=tb._currentCountMap[tb._threadID]+ub*u.WEBMESSENGER_MORE_MESSAGES_COUNT;ab(tb);var wb=va.getThreadMessagesRange(tb._threadID,0,vb,function(xb){j.removeClass(tb._loadMoreButton,'async_saving');tb._currentCountMap[tb._threadID]=vb;hb(tb,xb);tb._loadMessagesInFlight[tb._threadID]=false;},null,q.WEBMESSENGER);if(wb){tb._messagesSubscription={subscriber_id:wb,thread_id:tb._threadID};}else gb(tb);}function lb(tb){if(!tb._lastMessageIndicator){var ub;tb._lastMessageIndicator=new ba(o,tb._indicatorNode);tb._lastMessageIndicator.setProps({threadID:tb._threadID,className:"_510o",indicatorWillShow:function(){return (ub=tb._manager.isScrolledToBottom());},indicatorDidShow:function(){return (ub&&tb._manager.scrollToBottom(true));}});}return tb._lastMessageIndicator;}function mb(tb,ub){lb(tb).setProps({lastMessage:tb._lastMessage});}function nb(tb){if(ia.isActive(5000)){ob(tb);}else ia.subscribeOnce(ob.bind(null,tb));}function ob(tb){if(!tb._threadID||!tb._active)return;xa.markRead(tb._threadID);var ub=l.scry(tb._messageList,'.unreadHighlight');ub.forEach(function(vb){j.removeClass(vb,'unreadHighlight');j.addClass(vb,'unreadFading');new i(vb).from('background','#eceff5').to('background','#fff').from('borderColor','#d6d6d6').to('borderColor','#fff').ease(i.ease.both).duration(1500).ondone(function(){j.removeClass(vb,'unreadFading');fa.set(vb,'background','');fa.set(vb,'borderColor','');}).go();});}function pb(tb,ub){if(!ub.mark_as_read)return;var vb=l.scry(tb._messageList,'.unreadHighlight');for(var wb=0;wb<vb.length;wb++){var xb=vb[wb],yb=la.findAll(xb),zb=va.getMessagesFromIDs(yb);if(zb[zb.length-1].timestamp<ub.timestamp)j.removeClass(xb,'unreadHighlight');}}function qb(tb){var ub=va.getMessagesFromIDs([tb])[0];return ub?ub.timestamp:0;}function rb(tb){if(tb._builtNoSelectionBox)return;var ub=function(){var wb=ea.getCurrentStateData(),xb=babelHelpers._extends({},wb);ea.updateDetailState(da.DETAIL.COMPOSE_MAIN,Object.assign(xb,{start:true,thread_id:undefined}));},vb=function(){var wb=ea.getCurrentStateData(),xb=babelHelpers._extends({},wb);ea.updateMasterState(da.MASTER.RECENT_THREADS,Object.assign(xb,{folder:y.INBOX,filter:y.UNREAD}));};l.setContent(tb._noSelectedConversation,ka.render(ra._("No Conversation Selected"),[{text:ra._("New Message"),handler:ub},{text:ra._("Show Unread"),handler:vb}]));tb._builtNoSelectionBox=true;}function sb(tb){var ub=tb._manager._flexArea.getScrollableArea(),vb=tb._manager.getFlexAreaBoundingClientRect();m.inform('messengerScrolled/'+tb._threadID,{scrollTop:ub.getScrollTop(),top:vb.y,viewHeight:vb.height});}f.exports=za;},null);
__d('WebMessengerFlexibleScrollArea',['CSS','DOMQuery','ScrollableArea','Style','WebMessengerFlexibleArea','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n,o;n=babelHelpers.inherits(p,l);o=n&&n.prototype;function p(q,r){'use strict';o.constructor.call(this,q);this._scroll=j.fromNative(q,r);this._scrollBody=i.find(this.flexArea,'.uiScrollableAreaBody');var s=i.scry(this.flexArea,'.uiScrollableAreaShadow');this._shadow=s.length?s[0]:null;this._scrollContent=i.find(this.flexArea,'.uiScrollableAreaContent');this._scrollCallbacks=[];this._drawSubscription=this.subscribe('height_changed',this.poke.bind(this));this._scrollSub=this._scroll.subscribe('scroll',m(this._onScroll,50,this));this._nearTop=false;this._nearBottom=false;this._lastScrollHeight=0;}p.prototype.showAtTop=function(q){'use strict';if(q){k.set(this._scrollContent,'top','0');k.set(this._scrollContent,'bottom','');}else{k.set(this._scrollContent,'top','');k.set(this._scrollContent,'bottom','0');}};p.prototype.setBottomAligned=function(q){'use strict';var r=q!==false;if(this._bottomEdgeBias===r)return;h.conditionClass(this.flexArea,'uiScrollableAreaBottomAligned',r);this._bottomEdgeBias=r;if(this._bottomEdgeBias){this.scrollToBottom(false);}else this.scrollToTop(false);setTimeout(this.poke.bind(this),0);return this;};p.prototype.setInfiniteScrollHandler=function(q,r){'use strict';if(r){this._infiniteUpwardScrollHandler=q;}else this._infiniteDownScrollHandler=q;return this;};p.prototype.addScrollCallback=function(q){'use strict';this._scrollCallbacks.push(q);return this;};p.prototype.setTabbable=function(q){'use strict';this._scroll._wrap.setAttribute('tabindex',q?'0':'-1');};p.prototype.poke=function(q,r){'use strict';var s=this._scrollHeight,t=this._scroll.getScrollTop();this._scrollHeight=this._getScrollHeight();if(typeof s=='undefined'||r&&!r.old_height){this._bottomEdgeBias&&this._setShadowHeight();return;}var u=this._scrollHeight-s;if(this._bottomEdgeBias){var v=r?r.height-r.old_height:0;clearTimeout(this._pollTimer);this._pollTimer=setTimeout(this.poke.bind(this),200);var w,x=u-v;if(this._scrollHeight>this._getFlexHeight()){w=t+x;w=w<0?0:w;}else w=0;x>0&&this._setShadowHeight();if(w!==t)this._scroll.setScrollTop(w,false);x<0&&this._setShadowHeight();}else if(u)this._scroll.setScrollTop(t,false);};p.prototype.setScrollTop=function(q,r){'use strict';this._scroll.setScrollTop(q,r);};p.prototype.getScrollableArea=function(){'use strict';return this._scroll;};p.prototype.isScrolledToBottom=function(){'use strict';return this._scroll.isScrolledToBottom();};p.prototype.scrollToBottom=function(q){'use strict';this._scroll.scrollToBottom(q);if(this._bottomEdgeBias)this._scrollBottom=0;};p.prototype.isScrolledToTop=function(){'use strict';return this._scroll.getScrollTop()===0;};p.prototype.scrollToTop=function(q){'use strict';this._scroll.scrollToTop(q);};p.prototype.scrollIntoView=function(q,r){'use strict';this._scroll.scrollIntoView(q,r);};p.prototype.destroy=function(){'use strict';this._scrollSub&&this._scrollSub.unsubscribe();this.unsubscribe(this._drawSubscription);clearTimeout(this._pollTimer);o.destroy.call(this);this._scroll.destroy();};p.prototype._getScrollHeight=function(){'use strict';if(this._bottomEdgeBias){return this._scrollContent.offsetHeight;}else return this._scroll.getScrollHeight();};p.prototype._setShadowHeight=function(){'use strict';var q=this._shadowHeight;this._shadowHeight=this._scrollHeight-this._getFlexHeight();if(this._shadowHeight<0)this._shadowHeight=0;if(this._shadowHeight!==q)k.set(this._shadow,'height',this._shadowHeight+'px');};p.prototype._onScroll=function(){'use strict';var q=this._scroll.getScrollTop(),r=this._getScrollHeight(),s=this._getFlexHeight(),t=r>this._lastScrollHeight;this._lastScrollHeight=r;if(q<s){if(!this._nearTop||t&&2*s>r){this._nearTop=true;this._infiniteUpwardScrollHandler&&this._infiniteUpwardScrollHandler();}}else this._nearTop=false;if(q+2*s>r){if(!this._nearBottom||t&&2*s>r){this._nearBottom=true;this._infiniteDownScrollHandler&&this._infiniteDownScrollHandler();}}else this._nearBottom=false;this._scrollCallbacks.forEach((function(u){return u(this._scroll);}).bind(this));};f.exports=p;},null);
__d("Autosize",["CSS","cx","DOM","Style"],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=['fontFamily','fontStyle','fontVariant','fontWeight','letterSpacing','textDecoration','textIndent','textTransform','whiteSpace','wordSpacing','wordWrap'],m=/^[0-9]+$/;function n(s){var t=s.cloneNode(true);h.addClass(t,"_4g");var u=s.clientWidth-k.getFloat(s,'paddingLeft')-k.getFloat(s,'paddingRight');k.set(t,'width',u+'px');var v=s.clientHeight-k.getFloat(s,'paddingTop')-k.getFloat(s,'paddingBottom');k.set(t,'height',v+'px');j.insertAfter(s,t);return t;}function o(s,t,u,v,w){var x=s.style.fontSize,y=s.style.height;k.set(s,"height","auto");if(t!==null){var z=s.style.width;k.set(s,"width","auto");}var aa=0,ba=w.length-1;while(aa<ba){var ca=Math.ceil((aa+ba)/2);k.set(s,"font-size",w[ca]+v);if(u!==null&&s.scrollHeight>u||t!==null&&s.scrollWidth>t){ba=ca-1;}else aa=ca;}s.style.fontSize=x;s.style.height=y;if(t!==null)s.style.width=z;return w[aa]+v;}function p(s,t,u,v,w,x){var y=s.style.fontSize,z=s.style.height;k.set(s,"height","auto");if(t!==null){var aa=s.style.width;k.set(s,"width","auto");}k.set(s,"font-size",x+v);if((u===null||s.scrollHeight<=u)&&(t===null||s.scrollWidth<=t)){s.style.fontSize=y;s.style.height=z;if(t!==null)s.style.width=aa;return x+v;}k.set(s,"font-size",w+v);if(u!==null&&s.scrollHeight>u||t!==null&&s.scrollWidth>t){s.style.fontSize=y;s.style.height=z;if(t!==null)s.style.width=aa;return w+v;}while(w+1<x){var ba=Math.ceil((w+x)/2);k.set(s,"font-size",ba+v);if(u!==null&&s.scrollHeight>u||t!==null&&s.scrollWidth>t){x=ba;}else w=ba;}s.style.fontSize=y;s.style.height=z;if(t!==null)s.style.width=aa;return w+v;}function q(s,t){this._wrap=s;this._attr=t;if(this._attr.sizes){var u=this._attr.sizes;for(var v=1,w=u.length;v<w;v++){if(u[v-1]<=u[v])continue;u.sort(function(y,z){return y-z;});break;}}else if(t.min>t.max){var x=t.min;t.min=t.max;t.max=x;}this.fit();}q.prototype.fit=function(s,t){var u=this._wrap;if(!u.clientWidth){r.push(this);return;}var v=n(u);if(typeof s==="undefined")s=this._attr.width;if(m.test(s)){v.style.width=s+"px";}else if(s!==null&&s!=="auto")v.style.width=s;if(typeof t==="undefined")t=this._attr.height;if(m.test(t)){v.style.height=t+"px";}else if(t!==null&&t!=="auto")v.style.height=t;var w=null;if(!this._attr.wrap)w=v.clientWidth;var x=null;if(this._attr.wrap||t!==null)x=v.clientHeight;var y;if(this._attr.sizes){y=o(v,w,x,"px",this._attr.sizes);}else y=p(v,w,x,"px",this._attr.min,this._attr.max);j.remove(v);k.set(u,"font-size",y);h.removeClass(u,"invisible_elem");};var r=[];q.onNodeInserted=function(){var s=r;r=[];s.forEach(function(t){t.fit();});};f.exports=q;},null);
__d('FileFormResetOnSubmit',['DOMQuery','Event','emptyFunction'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();function k(m,n){var o=i.listen(m,'change',j.thatReturnsFalse,i.Priority.URGENT);try{n();}catch(p){throw p;}finally{o.remove();}}function l(m){'use strict';this._form=m;}l.prototype.enable=function(){'use strict';var m=this._reset.bind(this);this._subscription=this._form.subscribe('submit',function(){setTimeout(m,0);});};l.prototype.disable=function(){'use strict';this._subscription.unsubscribe();this._subscription=null;};l.prototype._reset=function(){'use strict';var m=this._form.getRoot();k(m,function(){var n=h.scry(m,'input[type="file"]');n.forEach(function(o){o.value='';});});};f.exports=l;},null);
__d('StickerSearch',['StickerServerRequests'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i,j={},k={requestStickersForQuery:function(l,m){i=l;h.getStickersForQuery(l,function(n){return i===l&&m(n.payload);});},getTagByName:function(l){return j[l];},getTagsIndex:function(){return j;}};f.exports=k;},null);
__d('FormSubmitOnChange',['Event','submitForm'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k){'use strict';this._form=k;}j.prototype.enable=function(){'use strict';this._listener=h.listen(this._form.getRoot(),'change',this._submit.bind(this));};j.prototype.disable=function(){'use strict';this._listener.remove();this._listener=null;};j.prototype._submit=function(){'use strict';i(this._form.getRoot());};Object.assign(j.prototype,{_listener:null});f.exports=j;},null);