/*!CK:3235143459!*//*1442764796,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["RtENj"]); }

__d('CalendarUI',['Event','Arbiter','AsyncRequest','CSS','DOM','DOMQuery','DOMScroll','Hovercard','Parent','Run','ScrollAwareDOM','Style','UIPagelet','Vector','ViewportBounds','$','ge','goURI'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){if(c.__markCompiled)c.__markCompiled();function z(){}Object.assign(z,{EVENT_ACTION:'EVENT_ACTION',_todayButton:null,_todayElement:null,_upPager:null,_months:[],_timestamp:null,_registeredReminders:false,init:function(){i.subscribe(this.EVENT_ACTION,function(ba,ca){t.loadFromEndpoint('CalendarHeaderPagelet','pagelet_calendar_header',JSON.parse(ca.actioncontext));});var aa=v.addTop(function(){var ba=x('pagelet_calendar_header');if(ba&&s.isFixed(ba.firstChild)){var ca=ba.firstChild.getBoundingClientRect();return ca.bottom;}return 0;});q.onLeave(function(){aa.remove();});},initGridItem:function(aa,ba){h.listen(aa,'click',function(event){if(p.byTag(event.getTarget(),'a'))return;j.bootstrap(ba,aa);return;});},pageUp:function(){k.removeClass(this._upPager.parentNode,'fbCalendarNoPadding');k.addClass(this._upPager.parentNode,'pvl');if(this._upPager)this._upPager.click();},getScrollFunction:function(aa){var ba=this;return function(event){var ca=p.byClass(event.getTarget(),'fbCalendarBox'),da=ba._months.indexOf(ca);if(aa&&da===0){ba.pageUp();}else ba.scrollTo(ba._months[da+(aa?-1:1)],true);};},registerArrowHandlers:function(aa,ba){h.listen(aa,'click',this.getScrollFunction(true));h.listen(ba,'click',this.getScrollFunction(false));},initScrollItem:function(aa,ba){h.listen(aa,'click',this.scrollTo.bind(this,ba));},scrollTo:function(aa,ba){aa=m.isNode(aa)?aa:x(aa);var ca=0,da=40;if(aa){var ea=u.getElementPosition(w('fbCalendarWrapper')).y,fa;if(document.getElementById('headerArea')){fa=u.getElementDimensions(w('headerArea')).y;}else{fa=0;da=12;}var ga=u.getElementPosition(aa).y;ca=ga-ea-fa+da;}else ca=u.getElementPosition(w('bottomContent')).y;n.scrollTo(new u(0,ca,'document'),ba!==false);},clickItem:function(aa){aa.click();},initUnhide:function(aa,ba){h.listen(aa,'click',function(event){var ca=p.byClass(ba,'fbCalendarItem');l.remove(ba);k.removeClass(l.find(ca,'.fbHiddenCalendarItem'),'fbHiddenCalendarItem');});},registerMonth:function(aa,ba){if(!this._timestamp||ba>this._timestamp){this._months.push(aa);}else this._months.unshift(aa);this._timestamp=ba;},registerHomepageReminders:function(){if(!this._registeredReminders){i.subscribe(this.EVENT_ACTION,function(aa,ba){if(x('pagelet_reminders'))t.loadFromEndpoint('RemindersPagelet','pagelet_reminders');});this._registeredReminders=true;}},registerTodayClickHandler:function(){this._todayButton.onclick=null;h.listen(this._todayButton,'click',this.scrollTo.bind(this,this._todayElement));},registerUpPagerButton:function(aa){var ba=m.isNode(aa)?aa:x(aa);k.removeClass(ba,'pvl');k.removeClass(ba,'hidden_elem');k.addClass(ba,'fbCalendarNoPadding');if(ba){this._upPager=w(ba.getElementsByTagName('a')[0]);}else this._upPager=null;},registerTodayElement:function(aa){this._todayElement=m.isNode(aa)?aa:x(aa);this._todayButton&&this.registerTodayClickHandler();},registerTodayButton:function(aa){this._todayButton=aa;this._todayElement&&this.registerTodayClickHandler();},registerEventLink:function(aa,ba){i.subscribe(this.EVENT_ACTION,function(ca,da){if(da.eid===ba)switch(da.action){case 'GOING':k.removeClass(aa.parentNode,"hidden_elem");k.addClass(aa,"fbCalendarEventGoing");break;case 'MAYBE':k.removeClass(aa.parentNode,"hidden_elem");k.removeClass(aa,"fbCalendarEventGoing");break;case 'DECLINED':case 'HIDDEN':o.hide(true);k.addClass(aa.parentNode,"hidden_elem");break;case 'EDITED':if(da.name)l.setContent(aa,da.name);if(da.day){var ea=x("pagelet_calendar_day_"+da.day);if(ea){var fa=m.find(ea,".fbCalendarGridEventList");if(m.scry(fa,"li").length>=4){k.addClass(aa.parentNode,"hidden_elem");t.loadFromEndpoint("CalendarDayPagelet","pagelet_calendar_day_"+da.day,{day:da.timestamp});}else l.prependContent(fa,aa.parentNode);}else k.addClass(aa.parentNode,"hidden_elem");}break;}});},informEventGoing:function(aa,ba){i.inform(this.EVENT_ACTION,{eid:aa,action:'GOING',actioncontext:ba});},informEventMaybe:function(aa,ba){i.inform(this.EVENT_ACTION,{eid:aa,action:'MAYBE',actioncontext:ba});},informEventDeclined:function(aa,ba){i.inform(this.EVENT_ACTION,{eid:aa,action:'DECLINED',actioncontext:ba});},informEventHidden:function(aa,ba){i.inform(this.EVENT_ACTION,{eid:aa,action:'HIDDEN',actioncontext:ba});},informEventEdited:function(aa,ba,ca,da){i.inform(this.EVENT_ACTION,{eid:aa,action:'EDITED',name:ba,day:ca,timestamp:da});},removeCalendarListHeader:function(aa){var ba=l.scry(aa,"^.fbCalendarOverlay .fbCalendarItem"),ca=l.find(aa,"^.fbCalendarItem");if(ba.length==1)ca=l.find(aa,"^.fbCalendarOverlay");l.remove(ca);},reloadPage:function(){y(window.location);},unhide:function(aa){setTimeout(function(){r.monitor(aa.nextSibling,k.show.bind(null,aa));},0);}});f.exports=z;},null);
__d("XEventReminderImpressionLoggerAsyncController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/events\/ajax\/reminder\/impression\/",{acontext:{type:"StringToStringMap",required:true},data:{type:"StringToStringMap"}});},null,{});
__d('EventReminderController',['Arbiter','AsyncRequest','DOM','DOMQuery','Event','Scroll','ScrollableArea','XEventReminderImpressionLoggerAsyncController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p={registerReminder:function(q,r){this._firstOpen=true;var s=q.getDialog(),t=n.getInstance(k.scry(s.getRoot(),'.uiScrollableArea')[0]),u=null;if(t){u=j.find(t.getElement(),'div.uiScrollableAreaWrap');t.subscribe('scroll',function(){return (h.inform('EventReminderDialog/scroll',{rect:u.getBoundingClientRect(),scrollTop:m.getTop(u)}));});}l.listen(q.getRoot(),'click',function(event){event.preventDefault();});s.subscribe('show',(function(){var v=o.getURIBuilder().setStringToStringMap('acontext',r).setStringToStringMap('data',{first_open:this._firstOpen}).getURI();new i(v).send();this._firstOpen=false;var w={};if(u)w={rect:u.getBoundingClientRect()};h.inform('EventReminderDialog/show',w);}).bind(this));s.subscribe('hide',function(){return h.inform('EventReminderDialog/hide');});}};f.exports=p;},null);
__d('FlexibleScrollableArea',['DataStore','DOM','DOMDimensions','Event','Parent','Run','Style','Vector','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q=30,r=100;function s(t,u,v,w,x){'use strict';this._element=t;this._tight=u;this._measureFrom=v;this._minHeight=w;this._margin=x;h.set(this._element,'FlexibleScrollableArea',this);m.onLeave(this.cleanup.bind(this));this._listener=k.listen(window,'resize',p(this.poke,r,this));this.poke();}s.prototype.poke=function(){'use strict';var t=i.find(this._element,'.uiScrollableAreaBody'),u=o.getElementDimensions(t).y+j.measureElementBox(t,'height',true,true,true),v;if(this._tight){var w=this.getMaxHeight();if(u<w+q)w+=q;v=Math.max(Math.min(u,w),this._minHeight);}else v=Math.max(this.getMaxHeight(),this._minHeight);n.set(this._element,'height',v+'px');};s.prototype.getMaxHeight=function(){'use strict';if(this._measureFrom==='bottom'){var t=o.getViewportDimensions().y,u=o.getElementPosition(this._element,'viewport').y,v=t-u;return v-this._margin;}var w=o.getElementPosition(this._element,'viewport').y+o.getElementDimensions(this._element).y;return w-this._margin;};s.prototype.cleanup=function(){'use strict';this._listener&&this._listener.remove();};s.getInstance=function(t){'use strict';var u=l.byClass(t,'flexibleScrollableArea');return u?h.get(u,'FlexibleScrollableArea'):null;};f.exports=s;},null);
__d('LoadRecommendations',['Event','AsyncRequest'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={loadOnClick:function(k){h.listen(k,'click',function(){new i().setURI('/ajax/pages/reminder/recommendations').send();});}};f.exports=j;},null);
__d('ReminderStory',['AsyncRequest','Arbiter','DOMQuery','Event','FlexibleScrollableArea','LayerAutoFocus','ScrollableArea','SubscriptionsHandler','UIPagelet','getActiveElement'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();function r(s,t,u,v,w,x){'use strict';this.$ReminderStory1=false;this.$ReminderStory2=t;this.$ReminderStory3=s;k.listen(s,'click',(function(event){if(u&&j.contains(u,event.target))return;t.show();if(v)new h('/growth/reminder/logging.php').setData({context_data:v,first_click:!this.$ReminderStory1}).send();this.$ReminderStory1=true;}).bind(this));if(w)t.subscribeOnce('show',function(){p.loadFromEndpoint(w,t.getContent(),x);});t.disableBehavior(m);t.subscribe('aftershow',(function(){var y=t.getRoot(),z=j.scry(y,'#SuggestBelowInvite')[0];if(z)new h('/ajax/pages/reminder/recommendations').send();var aa=t.hide.bind(t);this.$ReminderStory4=new o();this.$ReminderStory4.addSubscriptions(k.listen(window,'resize',aa),k.listen(window,'scroll',aa));var ba=j.scry(y,'.inlineReplyTextArea');ba[0]&&ba[0].focus();var ca=j.scry(y,'.jewelItemNew'),da=[];ca.forEach(function(ha){var ia=ca[ha].getAttribute('id');if(ia&&ia.endsWith('_1_req'))da=da.concat(ia.replace('_1_req',''));});if(da.length>0)new h('/friends/requests/log_impressions').setData({ids:da.join(','),ref:'reminder_box'}).send();var ea=n.getInstance(j.scry(t.getRoot(),'.uiScrollableArea')[0]),fa=l.getInstance(j.scry(t.getRoot(),'.flexibleScrollableArea')[0]),ga=function(){if(fa)fa.poke();if(ea){ea.poke();k.fire(j.scry(t.getRoot(),'.scrollable')[0],'scroll');}};ga();i.subscribe('reflow',function(){var ha=j.scry(y,'.fbRemindersBirthdayList');if(ba&&ha)for(var ia=0;ia<ba.length;++ia)if(ba[ia]==q()&&j.contains(ha[0],ba[ia]))ga();});}).bind(this));t.subscribe('beforehide',(function(){if(this.$ReminderStory4){this.$ReminderStory4.release();this.$ReminderStory4=null;}}).bind(this));}r.prototype.getDialog=function(){'use strict';return this.$ReminderStory2;};r.prototype.getRoot=function(){'use strict';return this.$ReminderStory3;};f.exports=r;},null);