/*!CK:2055154431!*//*1444269575,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["FejnX"]); }

__d("TimelineFilterOptions",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={ALL:"all",REVIEW:"review",TAG_REVIEW:"tagreview",FACE_ALERTS:"facealertsreview",POSTSANDAPPS:"postsandapps",LOCATION:"location",PHOTOS:"photos",TAGGED_PHOTOS:"taggedphotos",OWN_PHOTOS:"ownphotos",LIKES:"likes",LIKED_INTERESTS:"likedinterests",LIKED_POSTS:"likedposts",GROUPS:"groups",GROUP_MEMBERSHIP:"groupmembership",GROUP_POSTS:"groupposts",HIDDEN:"hidden",SPAM:"spam",ALL_APPS:"apps",SEARCH:"search",ADS:"ads",CLUSTER:"cluster",APP:"app",STORIES:"stories",COLLECTION_ITEM:"citem",FITNESS:"fitness",OG_VIDEO:"ogvideo",SAVED_FOR_LATER:"saved",PRIVATE_NOTES:"private_notes",NOW:"now"};},null,{});
__d('BrowseFacebarHighlighter',['CSS','csx','NodeHighlighter'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k={};Object.assign(k,j,{getHighlightCandidates:function(){return ["._53ad"];},isDiscardNode:function(l){return h.hasClass(l,'DefaultText');},createSegmentedRegex:function(l){l=this.escapeAndAddBidirectionalCharsToTokens(l);return '(^|\\s|\\b)('+l.join('|')+')';}});f.exports=k;},null);
__d('getElementChildren',['toArray','isElementNode'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k){return h(k.children||k.childNodes).filter(i);}f.exports=j;},null);
__d('FacebarSemanticQuery',['CurrentUser','URI'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j='str',k=/\*[\w\-]+\(/g;function l(v){var w={me:h.getID()};return Object.assign(w,Array.isArray(v.semantic_map)?{}:v.semantic_map);}function m(v,w){var x=l(v);if(typeof x[w]!=='undefined')return String(x[w]);return w;}function n(v){return new i("/profile.php").addQueryData({id:v});}function o(v,w){var x=[w],y=[],z=v.browse_functions,aa=v.search_path;while(x.length>0){var ba=x.pop();if(!r(ba)){y.push(ba);continue;}var ca=ba.substring(0,ba.indexOf('(')),da=ca,ea=s(ba);if(!z[ca]){y=[];break;}var fa=z[ca].minNumParams,ga=z[ca].maxNumParams;if(x.length>0)if(z[ca].numParamsUnbounded){if(y.length>0)ca+='-'+ea.length;}else if(ea.length!=1&&ea.length>fa||ea.length===0&&fa!=ga)ca+='-'+ea.length;x.push(ca);for(var ha=0;ha<ea.length;ha++){if(ea[ha].length===0)continue;if(z[da].allowsFreeText){x.push(j+'/'+encodeURIComponent(encodeURIComponent(ea[ha])));}else x.push(ea[ha]);}}return new i(aa+y.join('/'));}function p(v){return v.replace(/['"\[\]]/g,'');}function q(v,w){var x=JSON.parse(w),y=[];if(x.length>0)y=[x[0]];var z=[],aa=v.browse_functions,ba=v.search_path;while(y.length>0){var ca=y.pop();if(typeof ca!=='object'){z.push(p(ca));continue;}var da=Object.keys(ca)[0],ea=da,fa=ca[da];if(!aa[da]){z=[];break;}var ga=aa[da].minNumParams,ha=aa[da].maxNumParams;if(y.length>0)if(aa[da].numParamsUnbounded){if(z.length>0)da+='-'+fa.length;}else if(fa.length!=1&&fa.length>ga||fa.length===0&&ga!=ha)da+='-'+fa.length;y.push(da);for(var ia=0;ia<fa.length;ia++){if(fa[ia].length===0)continue;if(aa[ea].allowsFreeText){y.push(j+'/'+encodeURIComponent(fa[ia]));}else y.push(fa[ia]);}}return new i(ba+z.join('/'));}function r(v){return (/^[a-z\-]+\(.*\)$/.test(v));}function s(v){if(!r(v)&&v.indexOf('param_')!==0)return [v];var w=v.substring(v.indexOf('(')+1,v.length-1);if(w.length===0)return [];return t(w);}function t(v){var w=[],x=0,y=0;for(var z=0;z<v.length;++z)if(v[z]==','&&y===0){w.push(v.substring(x,z));x=z+1;}else if(v[z]=='('){y++;}else if(v[z]==')')y--;w.push(v.substring(x,v.length));return w;}function u(v,w,x){'use strict';this.facebarConfig=v;this.unmapped=(w||"").trim();this.mapped=m(v,this.unmapped);this.position=null;this.$FacebarSemanticQuery1=typeof x!=='undefined'?x:false;}u.prototype.isEntity=function(){'use strict';return (/^\d+$/.test(this.mapped));};u.prototype.isShortcut=function(){'use strict';return this.mapped.indexOf('shortcut(')===0;};u.prototype.isImplemented=function(){'use strict';return this.mapped&&!this.mapped.match(k);};u.prototype.isSemanticForest=function(){'use strict';return this.$FacebarSemanticQuery1;};u.prototype.getUnimplemented=function(){'use strict';return (this.mapped.match(k)||[]).map(function(v){return v.substr(1,v.length-2);});};u.prototype.getURI=function(){'use strict';if(this.isEntity()){return n(this.mapped);}else if(this.isShortcut()){return new i(this.mapped.substr(9,this.mapped.length-10));}else if(this.isSemanticForest()){return q(this.facebarConfig,this.unmapped);}else return o(this.facebarConfig,this.unmapped);};f.exports=u;},null);
__d('FacebarURI',['FacebarJSConstants','FacebarSemanticQuery','KeywordsSearchResultConfig','URI','WWWBase'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m={event:{ref:h.eventLinkRef},user:{fref:'ts'},page:{fref:'ts'}},n={getSearchRawPrefix:function(){return 'search';},getSearchPath:function(){return '/'+this.getSearchRawPrefix()+'/';},getURI:function(o,p){var q=null,r=!p.song&&!p.isExtendedResult&&p.path;if(r){q=new k(r);if(p.type in m)q.addQueryData(m[p.type]);}else if(j.use_seo_urls&&p.type===j.result_type&&p.semantic.startsWith('str/')){q=new k(j.seo_top_url).addQueryData('q',p.text);}else{var s=new i(o,p.semantic);if(s&&s.isImplemented())q=s.getURI();}return q&&n.getQualifiedURI(q);},getQualifiedURI:function(o){var p=new k(o);if(!p.getDomain()){var q=new k(l.uri);p.setProtocol(q.getProtocol()).setDomain(q.getDomain()).setPort(q.getPort());}return p;}};f.exports=n;},null);
__d('FacebarFindPeopleAndPages',['FacebarGlobalOptions','FacebarJSConstants','FacebarStructuredText','FacebarURI','URI','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o={insertInto:function(p,q,r){p=this._cleanQuery(p);var s=this._getInsertionIndex(p,q);if(s>-1){var t=this._createFindPeopleAndPagesResult(p,r);q.splice(s,0,t);}},_getInsertionIndex:function(p,q){if(!p||!h.findPeopleAndPages)return -1;var r=q.some(this._isUserOrPageSuggestion);if(!r)return -1;var s=-1;for(var t=0;t<q.length;t++)if(this._isEntitySuggestion(q[t]))s=t+1;return s;},_isUserOrPageSuggestion:function(p){return p.type==='user'||p.type==='page';},_isEntitySuggestion:function(p){return p.type!==i.keywordType&&p.type!==i.grammarType;},_cleanQuery:function(p){return String(p).trim().replace(/\s+/g,' ').replace(/[\u200E|\u200F|\u202a|\u202b|\u202c]/g,'');},_createFindPeopleAndPagesResult:function(p,q){var r='str/'+p+'/keywords_entities',s=n._("Find all people and pages named \"{query}\"",[n.param('query',p)]);return {type:'grammar',results_set_type:'browse_type_blended',text:p,id:p,uid:p,query_string:p,icon_class:"_207",isSeeMore:true,isPeopleAndPagesSuggestion:true,structure:j.fromString(s),semantic:r,uri:k.getQualifiedURI(new l('/search/'+r)),fromCache:q,tags:{displayedSeeMore:true}};}};f.exports=o;},null);
__d('FacebarKeywordSearchUtils',['FacebarURI','FacebarStructuredText','KeywordsSearchResultConfig','URI'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=function(n){var o=0;while(o<n.length)if(n[o].exactMatchKeyword){n.splice(o,1);}else ++o;},m={addExactMatch:function(n,o,p){if(!o.length)return;var q,r;for(var s=0,t=o.length;s<t;s++){r=o[s];if(r.type==='grammar')continue;q=true;break;}if(!q)return;var u=this.getExactMatchKeywordResult(n);if(!u)return;var v=Math.min(o.length,p),w=v;for(s=0;s<v;s++){r=o[s];if(r.exactMatchKeyword)return;if(r.cost>j.default_cost)--w;if(r.type!==j.result_type)continue;u.backendCost=r.cost+j.exact_match_cost_delta_from_best;u.cost=r.backendCost;l(o);o.splice(s,0,u);return;}l(o);o.splice(Math.min(Math.min(v,p-1),w),0,u);},getExactMatchKeywordResult:function(n){if(!n||n.is_empty||!n.raw_text)return;var o=n.raw_text.toLowerCase().replace(/\s{2,}/g,' ').trim(),p=j.query_prefix_blacklist;for(var q=0;q<p.length;q++)if(o.startsWith(p[q]))return;var r=this.makeFacebarEntry(o);return this._makeFacebarResult(r,n.cache_id.length);},makeFacebarEntry:function(n){var o=null,p=null;if(j.gsv2_results_page){p='str/'+encodeURIComponent(n)+'/'+j.gsv2_browse_edge;o=h.getQualifiedURI(new k('/search/'+p));}else{o=h.getQualifiedURI(new k(j.results_page_url).addQueryData('q',n));p=j.shortcut+'('+o.toString()+')';}if(j.use_seo_urls)o=h.getQualifiedURI(new k(j.seo_top_url).addQueryData('q',n));return {semantic:p,text:n,type:j.result_type,resultsSetType:j.result_set_type,uid:j.uid_prefix+n,iconClass:j.icon_class,uri:o,structure:i.fromString(n)};},_makeFacebarResult:function(n,o){var p={semantic:n.semantic,structure:[{type:'grammar',text:n.text,uid:n.semantic}],type:n.type,resultsSetType:n.resultsSetType,cost:j.default_cost,cache_id_length:o,parse:{display:[{type:'grammar',uid:j.uid_prefix+n.text}],remTokens:[],suffix:''},iconClass:n.iconClass,exactMatchKeyword:true};p.tuid=JSON.stringify({semantic:p.semantic,structure:p.structure});return p;}};f.exports=m;},null);
__d('FacebarGSv2Echo',['FacebarGlobalOptions','FacebarJSConstants','FacebarKeywordSearchUtils','FacebarStructuredText','FacebarURI','URI','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p={insertInto:function(q,r,s,t){if(this._shouldInsert(q,r)){var u=r.findIndex(this._isKeywordSuggestion,this);if(u<0)u=r.length;var v=r.findIndex((function(y){return y.isSpecialIntent&&this._isKeywordSuggestion(y)&&this._normalizeValue(q)===this._normalizeValue(y.text);}).bind(this),this),w=h.showEcho&&(!h.renderKeywordSnippets||v<0);if(w){var x=this._removeExactMatchAndReturnSubtext(q,r);r.splice(u,0,this._createEchoResult(q,s,x,t));}if(h.findPostsSemantic)r.splice(u,0,this._createFindPostsResult(q,s,t));}},_shouldInsert:function(q,r){q=this._normalizeValue(q);if(!q||!h.graphSearchV2)return false;for(var s=0;s<r.length;s++){var t=r[s];if(t.isRecentSearchSuggestion&&q===this._normalizeValue(t.text))return false;}return true;},_isKeywordSuggestion:function(q){return q.type===i.keywordType||q.type===i.grammarType;},_removeExactMatchAndReturnSubtext:function(q,r){var s="";q=this._normalizeValue(q);for(var t=0;t<r.length;t++){var u=r[t];if(this._isKeywordSuggestion(u)&&q===this._normalizeValue(u.text)){if(u.subtext)s=u.subtext;r.splice(t,1);return s;}}return s;},_normalizeValue:function(q){return String(q).trim().replace(/\s+/g,' ').replace(/[\u200E|\u200F|\u202a|\u202b|\u202c]/g,'').toLowerCase();},_createEchoResult:function(q,r,s,t){q=this._normalizeValue(q);var u=j.makeFacebarEntry(q);if(h.renderKeywordSnippets)s=s||o._("Search Facebook");return {type:i.keywordType,results_set_type:i.browseTypes.keyword,text:q,id:q,uid:q,query_string:q,icon_class:"_5b1w",isSingleState:t,exactMatchKeyword:true,structure:k.fromString(q),semantic:u.semantic,uri:u.uri,fromCache:r,subtext:s};},_createFindPostsResult:function(q,r,s){q=this._normalizeValue(q);var t=h.findPostsSemantic.replace('{QUERY}',q),u=h.findPostsSemantic.replace('{QUERY}',encodeURIComponent(q)),v=o._("Find all posts for \"{query}\"",[o.param('query',q)]);return {type:i.keywordType,results_set_type:i.browseTypes.keyword,text:q,id:q,uid:q,query_string:q,icon_class:"_4-vy",isSeeMore:true,isSingleState:s,structure:k.fromString(v),semantic:t,uri:l.getQualifiedURI(new m('/search/'+u)),fromCache:r,tags:{displayedSeeMore:true}};}};f.exports=p;},null);
__d("XAtWorkInvitesSearchDialogController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/work\/invite\/search_typeahead_dialog\/",{source:{type:"String",required:true},__asyncDialog:{type:"Int"}});},null,{});
__d('FacebarInviteCoworkers',['AtWorkInviteCoworkerSource','FacebarGlobalOptions','FacebarStructuredText','XAtWorkInvitesSearchDialogController','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n={insertInto:function(o,p,q){o=this._cleanQuery(o);var r=this._getInsertionIndex(o,p);if(r>-1){var s=this._createInviteCoworkersResult(o,q);p.splice(r,0,s);}},_getInsertionIndex:function(o,p){if(!o||!i.inviteCoworkers)return -1;return p.length;},_cleanQuery:function(o){return String(o).trim().replace(/\s+/g,' ').replace(/[\u200E|\u200F|\u202a|\u202b|\u202c]/g,'');},_createInviteCoworkersResult:function(o,p){var q=m._("Invite \"{query}\" to Facebook at work",[m.param('query',o)]),r=k.getURIBuilder().setString('source',h.SEARCH_TYPEAHEAD).getURI();return {uid:o,icon_class:"_5yiv",isSeeMore:true,isAsync:true,structure:j.fromString(q),asyncURI:r,fromCache:p};}};f.exports=n;},null);
__d('FacebarResultStore',['FacebarGlobalOptions','FacebarJSConstants','FacebarKeywordSearchUtils','FacebarResultStoreUtils','FacebarStructuredText','KeywordsSearchResultConfig','TokenizeUtil','UnicodeMatch','concatMap','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();function r(s,t,u,v){'use strict';this.facebarConfig=s;this.facebarConfig.grammar_stop_words_penalty=this.facebarConfig.grammar_stop_words_penalty||2;this.facebarConfig.grammar_stop_words=this.facebarConfig.grammar_stop_words||{};this.facebarConfig.options=v;this.tokenize=t;this.getEntry=u;this.typeaheadTypeMap=this.facebarConfig.mapped_types;this.facebarConfig.typeahead_types.forEach(function(w){this.typeaheadTypeMap[w]=w;},this);this.unicodeMatch=new o({prefix_hangul_conjoining_jamo:true});this.resetCaches();}r.prototype.transformStructured=function(s){'use strict';var t=[],u=[],v='',w='';s.forEach(function(z,aa){if(z.isType('text')){v+=z.getText();w=w==null?null:w+z.getText();}else{var ba=v.match(/\"/g);if(ba&&ba.length%2)v=v.replace(/\s+$/,'')+'"';if(v.length){Array.prototype.push.apply(t,this.tokenize(v));u.push(v);v='';}t.push(z.toStruct());u.push({uid:String(z.getUID()),type:this._getFBObjectType(z.getTypePart(1)),text:z.getText()});w=null;}},this);if(v.length){if(v[v.length-1]=='\'')v=v.substr(0,v.length-1);Array.prototype.push.apply(t,this.tokenize(v));u.push(v);if(v[v.length-1]==' ')t.push('');}var x=JSON.stringify(u),y=x.replace(/\]$/,'').replace(/\"$/,'');y=y.replace(/\s{2,}/g,' ');return {tokens:t,text_form:x,is_empty:!!x.match(/^\[(\"\s*\")?\]$/),raw_text:w,cache_id:y};};r.prototype.resetCaches=function(){'use strict';this.resetBootstrapCache();this.resetQueryCache();};r.prototype.resetBootstrapCache=function(){'use strict';this.bootstrapCache={};};r.prototype.resetQueryCache=function(){'use strict';this.queryCache={'':{tokens:[],results:[]}};};r.prototype.setNullState=function(s){'use strict';this.facebarConfig.null_state=s.map(this._extractStructure,this);};r.prototype.addEntryToNullState=function(s){'use strict';if(this.facebarConfig.null_state){var t=this.facebarConfig.entity_cost+s.grammar_costs['{'+s.type+'}'],u=k.processEntityResult(s.type,s.uid,s.text,t);this.facebarConfig.null_state.unshift(u);}};r.prototype.addRecentEntryToNullState=function(s){'use strict';if(!this.facebarConfig.null_state)return;var t=decodeURIComponent(s.semantic);for(var u=0;u<this.facebarConfig.null_state.length;u++){var v=this.facebarConfig.null_state[u];if(v.semantic===t){this.facebarConfig.null_state.splice(u,1);break;}}var w=babelHelpers._extends({},s,{isRecent:true,isNullState:true,type:i.keywordType,structure:l.fromString(s.text),tuid:JSON.stringify({semantic:s.semantic,structure:s.structure})});if(s.icon_class)w.iconClass=s.icon_class;if(s.isRecentSearchSuggestion){w.iconClass="_5b1w";delete w.isRecentSearchSuggestion;}if(s.results_set_type)w.resultsSetType=s.results_set_type;this.facebarConfig.null_state.unshift(w);};r.prototype.clearRecentSearches=function(){'use strict';if(!this.facebarConfig.null_state)return;this.facebarConfig.null_state=this.facebarConfig.null_state.filter(function(s){return !s.isRecent;});};r.prototype.setSortFunction=function(s){'use strict';this._sortFunction=s;};r.prototype.addBootstrap=function(s){'use strict';var t=this.bootstrapCache;s.forEach(function(u){var v=this.getEntry(u);v.bootstrapped=true;var w=this.tokenize(v.textToIndex,true);if(v.tokens)Array.prototype.push.apply(w,v.tokens.split(' '));Array.prototype.push.apply(w,this.getExtraTokensToIndex(v));w.forEach(function(x){if(!t.hasOwnProperty(x))t[x]={};t[x][u]=true;});},this);};r.prototype.getExtraTokensToIndex=function(s){'use strict';var t=[];if(s.alias!=null)t.push(s.alias.toLowerCase());return t;};r.prototype.addNullStateToQueryCache=function(s,t){'use strict';this.saveResults(this.facebarConfig.null_state,s,true);if(h.includeInitialTypeNamedX)this.saveResults(t,s,true);};r.prototype.extendResult=function(s,t){'use strict';var u=s.cache_id.substr(t.cache_id_length);if((u.indexOf("\"")>=0||t.tokens.length===0)&&!t.isTypeNamedXBootstrap)return null;var v;if(!!t.isTypeNamedXBootstrap){if(s.raw_text!==null){v=t.ext_text+u;}else if(s.tokens.length!==0&&s.tokens[0].text){v=s.tokens[0].text;}else return null;}else if(t.tokens[t.tokens.length-1].length!==0){v=t.ext_text+u;}else v=t.ext_text+" "+u;if(v.length===0)return null;t.ext_node.text=v;t.parse.entTokens=[v];t.parse.suffix="";this._extractStructure(t);if(!this._punctRegexp)this._punctRegexp=new RegExp(n.getPunctuation(),'g');t.semantic=t.ext_semantic.replace('(ext_string)','('+v.replace(this._punctRegexp,"")+')');t.isExtendedResult=true;return t;};r.prototype.getResults=function(s,t){'use strict';if(s.tokens.length===0||s.tokens.length==1&&s.tokens[0]==='')return {results:this.facebarConfig.null_state||[],null_state:true};var u=this._getBestQueryCache(s.cache_id),v=u.results.filter(function(ga){return !ga.isRecent;}),w={},x=this._getBootstrapMatchByType(s.tokens,w),y=this._addMatchingBootstrapResults(s,x[0]||{},w);if(h.limitBootstrapResult)y=y.slice(0,h.limitBootstrapResultNum);var z=[],aa=[];if(h.hasKeywordBootstrap){z=y.filter(function(ga){if(ga.type!==i.keywordType)return false;return ga.isRecentSearchSuggestion||this.unicodeMatch.prefixMatch(ga.structure[0].text,s.tokens[0]);},this);aa=y.filter(function(ga){return ga.type!==i.keywordType;});if(h.onlyPrefixMatching)z=z.filter(function(ga){return this.unicodeMatch.prefixMatch(ga.structure[0].text,s.tokens[0]);},this);z.sort(function(ga,ha){if(ga.isRecentSearchSuggestion){if(!ha.isRecentSearchSuggestion)return -1;return ga.structure[0].text.length-ha.structure[0].text.length;}if(ha.isRecentSearchSuggestion)return 1;return ha.popularSearchScore-ga.popularSearchScore;});aa.sort(this._sortFunction);if(y.length>t){var ba=Math.min(h.maxKeywordsToShow,z.length);if(aa.length<t-ba)ba=t-aa.length;z=z.slice(0,ba);aa=aa.slice(0,t-z.length);}y=aa.concat(z);}Array.prototype.push.apply(y,p(this._getResultsFromCache.bind(this,x,s),v));if(!h.hasKeywordBootstrap){y.sort(this._sortFunction);if(!h.graphSearchV2&&h.keywordSearchEnabled)j.addExactMatch(s,y,t);}var ca={},da=[],ea=false,fa=0;y.forEach(function(ga){var ha=l.fromStruct(ga.structure);if(ha.hasType('blank')){da.push(ga);return;}ga.semantic=ga.semantic.toLowerCase();if(!ga.termMatches)ga.termMatches=w[ga.semantic];var ia=r.getUniqueSemantic(ga.semantic),ja=r.getUniqueSemantic(ga.alternateSemantic);if(!ia)return;var ka=ca[ia]||ja&&ca[ja];if(ka){if(ga.isJSBootstrapMatch){ka.isJSBootstrapMatch=true;ka.bootstrapCost=ga.bootstrapCost;}else if(ka.isJSBootstrapMatch&&ga.backendCost!==undefined&&ka.backendCost===undefined)ka.backendCost=ga.backendCost;if(!!ga.tags)Object.assign(ka.tags||{},ga.tags);return;}if(ea&&ga.blankFilled)return;if(ga.type.indexOf('browse_type')>=0){fa+=1;if(this.facebarConfig.maxGrammarResults!==undefined&&fa>this.facebarConfig.maxGrammarResults)return;}ea=ea||!!ga.blankFilled;ca[ia]=ga;if(ja)ca[ja]=ga;da.push(ga);},this);return {results:da};};r.prototype.saveResults=function(s,t,u,v,w){'use strict';s=s.map(this._processBackendResult,this);var x=[],y={},z={};s.forEach(function(ba){z[ba.semantic]=true;});var aa=this._getBestQueryCache(t.cache_id);aa.results.forEach(function(ba){if(ba.type==='websuggestion')return;if(ba.exactMatchKeyword)return;if(ba.isExtendedResult)return;if(ba.semantic in y)return;var ca=this._getDifferenceArrayTokens(ba.tokens,t.tokens),da=this._getNumTokensMatching(ca,ba);da=this._tryMatchingFinalInsertedEntity(ca,da,ba);if(da>0&&da==ca.length||(ba.type==="shortcut"&&ba.termMatches.indexOf(t.tokens[t.tokens.length-1]))>=0){ba.cacheOnlyResult=!z[ba.semantic];x.push(ba);}},this);if(h.limitCacheResult)x=x.slice(0,h.limitCacheResultNum);s.forEach(function(ba){ba.tokens=t.tokens;ba.cache_id_length=t.cache_id.length;if(!!ba.isTypeNamedXBootstrap)++ba.cache_id_length;x.push(ba);},this);if(w)Array.prototype.push.apply(x,w);if(this.queryCache[t.cache_id]===undefined)this.queryCache[t.cache_id]={};Object.assign(this.queryCache[t.cache_id],{tokens:t.tokens,results:x,incomplete:u},v);};r.prototype.alreadyKnown=function(s){'use strict';return !!this.queryCache[s]&&!this.queryCache[s].incomplete;};r.prototype.stripBrackets=function(s){'use strict';return s.replace(/^[\[\{]/,'').replace(/[\]\}]$/,'');};r.prototype._extractStructure=function(s){'use strict';function t(w,x,y){return {type:w==='ent:extend_string'?'text':w,text:x,uid:y||null};}function u(w,x){w.split(' ').forEach(function(y){if(y!==''){if(x)s.chunks.push(s.structure.length);s.structure.push(t('text',y));}s.structure.push(t('text',' '));});s.structure.pop();}function v(w){if(s.structure.length!==0||i.nonGrammarTypes[s.type])return w;return w.charAt(0).toUpperCase()+w.substr(1);}s.structure=[];s.chunks=[];s.parse.display.forEach(function(w){if(typeof w==='string'){u(v(w),true);}else if(w.type==='ent:extend_string'){u(w.text,true);}else if(w.uid){var x=this.getEntry(w.uid,w.fetchType);s.chunks.push(s.structure.length);if(x==null)throw new Error('No entry found for uid \"'+w.uid+'\", type \"'+w.fetchType+'\" and piece text \"'+w.text+'\"');if(x.grammar_like){u(v(x.text),false);}else{var y=w.type;if(w.fetchType)y+=':'+w.fetchType;s.structure.push(t(y,x.text,w.uid));}}else if(w.type=='blank'){s.chunks.push(s.structure.length);s.structure.push(t(w.type,'...'));}},this);return s;};r.prototype._getDifferenceArrayTokens=function(s,t){'use strict';if(!s.length)return [''].concat(t);var u=s.length-1,v=s[u];if(v==='')v=s[--u];var w='';if(typeof v=='string'&&u<t.length)w=t[u].substr(v.length);if(w===''&&u+1<t.length&&t[u+1]==='')return [''];return [w].concat(t.slice(u+1));};r.prototype._processBackendResult=function(s){'use strict';if(s.isTypeNamedXBootstrap&&s.cache_id_length)return s;s.semantic=s.semantic.toString();s.backendCost=s.cost;this._extractStructure(s);if(s.type.match(/^\{.*\}$/))s.useExtendedIndex=true;if(s.alternateSemantic)s.alternateSemantic=s.alternateSemantic.toLowerCase().replace(/\[(\d*)\]/g,'$1');if(s.parse.extendable){var t=null;s.parse.display.forEach(function(z){if(z.type!=="ent:extend_string")return;t=z;},this);if(!t||s.semantic.match(/\[.*\]/).length!==1){s.parse.extendable=false;}else{s.ext_node=t;s.ext_semantic=s.semantic.replace(/\[(.*)\]/g,'ext_string');s.ext_text=t.text;}}if(s.semantic.match(/\[\d*\]/)){var u=s.parse,v=u.pos;if(v===undefined){s.semantic=s.semantic.replace(/\[(\d*)\]/g,'$1');}else{var w=u.remTokens[u.remTokens.length-1];if(u.remTokens.length&&s.structure[s.chunks[w]]&&s.structure[s.chunks[w]].uid){v=u.remTokens[u.remTokens.length-1];s.completed=true;}var x=s.structure[s.chunks[v]].uid;if(x===null){s.semantic=s.semantic.replace(/\[(\d*)\]/g,'$1');}else{var y=new RegExp('\\['+x+'\\]','g');s.unsubstituted_semantic=s.semantic;s.semantic=s.semantic.replace(y,x);if(u&&u.disambiguation&&u.disambiguation.length>0){u.disambiguation=u.disambiguation.filter(function(z){return z.indexOf('['+x+']')!==-1;});u.unsubstituted_disambiguation=u.disambiguation.splice(0);u.disambiguation=u.disambiguation.map(function(z){return z.replace(y,x);});}}}}s.semantic=s.semantic.replace(/\[(.*)\]/g,'$1');s.tuid=JSON.stringify({semantic:s.semantic,structure:s.structure});return s;};r.prototype._sortFunction=function(s,t){'use strict';return (s.cost||0)-(t.cost||0);};r.prototype._getResultsFromCache=function(s,t,u){'use strict';var v=t.tokens,w=this._getDifferenceArrayTokens(u.tokens,v),x=[],y=this._getNumTokensMatching(w,u),z=this._tryMatchingFinalInsertedEntity(w,y,u);if(u.parse.extendable||u.isExtendedResult){var aa=this.extendResult(t,u);if(aa)x.push(aa);if(u.isExtendedResult)return x;}if(z>0&&z==w.length&&!(u.type===m.result_type&&w.length===1&&w[0]==='"'))x.push(u);if(u.type==="shortcut"&&u.termMatches.indexOf(t.tokens[v-1])>=0)x.push(u);return x;};r.prototype._addMatchingBootstrapResults=function(s,t,u){'use strict';var v=s.tokens;return p((function(w){var x=t[w];if(x===undefined)return [];var y=[],z=k.getQueryFeatures(s);x.forEach(function(aa){var ba=this.getEntry(aa,w);if(!this._isTitleTermMatch(v,ba)&&!this._isAliasMatch(s.raw_text,ba))return;var ca=this._isExactNameMatch(v,ba)||this._isAliasMatch(s.raw_text,ba),da=ca?0:this.facebarConfig.non_title_term_match_penalty,ea=this._isNonGrammarTermMatch(v,ba),fa=ba.grammar_costs?ba.grammar_costs['{'+w+'}']:0,ga=fa+da+this.facebarConfig.entity_cost+this.facebarConfig.grammar_stop_words_penalty*!ea,ha=k.processEntityResult(w,aa,ba.text,ga,s,z,u,ca,!ea);ha.bootstrapCost=ga;ha.isJSBootstrapMatch=true;if(w===i.keywordType){ha.iconClass=ba.iconClass;ha.isRecentSearchSuggestion=ba.isRecentSearchSuggestion;ha.isPopularSearchSuggestion=ba.isPopularSearchSuggestion;ha.parse=ba.parse;ha.subtext=ba.subtext;ha.semantic=ba.semantic;ha.popularSearchScore=ba.popularSearchScore;}y.push(ha);},this);return y;}).bind(this),this.facebarConfig.bootstrap_types);};r.prototype._isTitleTermMatch=function(s,t){'use strict';var u=s[0]||{};if(typeof u=='object')return false;var v=t.titleToIndex;return s.length===1?this._isTokenizePrefixMatch(u,v):n.isExactMatch(u,v);};r.prototype._isExactNameMatch=function(s,t){'use strict';var u=s[0]||{};if(typeof u=='object')return false;var v=t.text;for(var w=0;w<s.length-1;++w)if(s[w]!==''&&!n.isExactMatch(s[w],v))return false;return s.length>0&&this._isTokenizePrefixMatch(s[s.length-1],v);};r.prototype._isAliasMatch=function(s,t){'use strict';return t.alias!=null&&s!=null&&n.isExactMatch(t.alias,s);};r.prototype._isNonGrammarTermMatch=function(s,t){'use strict';var u=n.parse(t.titleToIndex.toLowerCase()),v=u.tokens.filter(function(y){return y!==''&&!this.facebarConfig.grammar_stop_words[y];},this);v=v.join(' ');for(var w=0;w<s.length;++w){if(typeof s[w]=='object')return true;var x=w===s.length-1?this._isTokenizePrefixMatch(s[w],v):n.isQueryMatch(s[w],v);if(x)return true;}return false;};r.prototype._getBootstrapMatchByType=function(s,t){'use strict';if(s.length===0)return [];var u=s.map(function(){return {};}),v=s[s.length-1]==='',w={},x,y=v?s.length-1:s.length,z=s[y-1];if(y&&z.uid){this._pushBootstrapEntryAtPosition(u,y-1,z.uid);return u;}for(var aa in this.bootstrapCache)if(y&&this.unicodeMatch.prefixMatch(aa,z)&&(!v||aa===z))for(x in this.bootstrapCache[aa])if(!w[x]){w[x]=1;this._addMatchedTerm(x,aa,t);this._pushBootstrapEntryAtPosition(u,y-1,x);}for(var ba=y-2;ba>=0;ba--){if(typeof s[ba]=='object')break;if(s[ba].length&&s[ba][0]=='"')break;for(x in this.bootstrapCache[s[ba]]){if(!w[x])w[x]=0;if(w[x]+ba==y-1){++w[x];this._addMatchedTerm(x,s[ba],t);this._pushBootstrapEntryAtPosition(u,ba,x);}}}return u;};r.prototype._addMatchedTerm=function(s,t,u){'use strict';(u[s]=u[s]||[]).push(t);return u;};r.prototype._pushBootstrapEntryAtPosition=function(s,t,u){'use strict';var v=this.getEntry(u);if(!v)return;var w=[];if(v.grammar_costs){w=Object.keys(v.grammar_costs).map(function(z){return this.stripBrackets(z);},this);}else w=[v.type];for(var x=0;x<w.length;x++){var y=w[x];if(s[t][y]===undefined)s[t][y]=[];s[t][y].push(u);}};r.prototype._getNumTokensMatching=function(s,t){'use strict';var u=0,v=t.parse,w=s.length,x=null,y=null;if(v.pos!==undefined){var z=t.structure[t.chunks[v.pos]];if(z){x=z.uid;y=z.type.split(':')[2];}}t.outputTokensUsed=[];t.termMatches=[];if(x){u=this._prefixMatchEntity(s,v,x,t.outputTokensUsed,y,!!t.useExtendedIndex,t.termMatches);if(u===0||u===w)return u;}else if(v.suffix&&w==1&&v.suffix.indexOf(s[0])===0){return w;}else if(v.suffix==s[0]){++u;}else return 0;var aa=[];v.remTokens=v.remTokens||[];for(var ba=0;ba<v.remTokens.length;ba++){if(typeof s[u]!='string'||t.chunks.length<=v.remTokens[ba]||t.structure.length<=t.chunks[v.remTokens[ba]]||t.structure[t.chunks[v.remTokens[ba]]].uid)break;var ca=t.structure[t.chunks[v.remTokens[ba]]].text;aa.push(ca.toLowerCase());}u=this._greedyMatchText(aa,s,u,v.remTokens,t.outputTokensUsed,t.isNullState);if(u==w-1&&s[u]==='')return w;return u;};r.prototype._prefixMatchEntity=function(s,t,u,v,w,x,y){'use strict';t.entTokens=t.entTokens||[];if(t.entTokens.length===0){if(s[0]!=='')return 0;if(t.possessive&&s.length>1&&s[1]=='\'s'){v.push([t.pos+1]);return 2;}else return 1;}var z=false,aa=this.getEntry(u,w);if(typeof w!=='undefined'&&w!==aa.fetchType)return 0;var ba=this.tokenize(x?aa.textToIndex:aa.text,true),ca=[];for(var da=0;da<s.length+t.entTokens.length-1;da++)if(da<t.entTokens.length-1){ca.push(t.entTokens[da]);}else if(da==t.entTokens.length-1){ca.push(t.entTokens[da]+s[0]);}else ca.push(s[da-t.entTokens.length+1]);var ea=-t.entTokens.length+1;for(var fa=0;fa<ca.length;++fa){var ga=ca[fa];if(typeof ga!='string')break;if(ga===''){ea++;continue;}var ha=false;for(var ia=0;ia<ba.length;ia++)if(ba[ia]==ga||fa===ca.length-1&&ba[ia].indexOf(ga)===0){if(y)y.push(ba[ia]);ba[ia]='';ha=true;++ea;break;}if(ha)continue;if(!t.possessive||ga.length<=2||ga.substr(ga.length-2)!='\'s')break;var ja=ga.substr(0,ga.length-2);for(ia=0;ia<ba.length;ia++)if(ba[ia]==ja){++ea;if(v)z=true;break;}break;}if(ea>0){if(z)v.push([t.pos+1]);return ea;}if(v===undefined)return 0;var ka=s[0],la=ka;if(t.possessive&&ka.length>=2&&ka.substr(ka.length-2)=='\'s')la=ka.substr(0,ka.length-2);t.suffix=t.suffix||'';if(s.length==1&&t.suffix.indexOf(ka)===0||t.suffix==la||t.suffix==ka){if(la!=ka&&t.suffix==la)v.push([t.pos+1]);return 1;}return 0;};r.prototype._tryMatchingFinalInsertedEntity=function(s,t,u){'use strict';if(!u.completed||t<0)return t;var v=u.parse,w=v.remTokens[v.remTokens.length-1],x=u.structure[u.chunks[w]],y=this.getEntry(x.uid,x.type),z=this.tokenize(y.text,true);t=this._greedyMatchText(z,s,t);if(t==s.length-1&&s[t]==='')return s.length;return t;};r.prototype._greedyMatchText=function(s,t,u,v,w,x){'use strict';for(var y=0;y<s.length;y++){var z=s[y];if(z==t[u]){if(w!==undefined)w.push(v[y]);++u;continue;}if(u===t.length-1&&z.indexOf(t[u])===0){if(w!==undefined)if(z==t[u]){w.push([v[y]]);}else w.push([v[y],t[u].length]);return t.length;}if(x)break;}return u;};r.prototype._getBestQueryCache=function(s){'use strict';for(var t=s.length;t>=0;t--){var u=this.queryCache[s.slice(0,t)];if(u)return u;}};r.prototype._getFBObjectType=function(s){'use strict';if(this.typeaheadTypeMap[s]){return this.typeaheadTypeMap[s];}else return 'page';};r.prototype._isTokenizePrefixMatch=function(s,t){'use strict';return n.isPrefixMatch(this.unicodeMatch.prefixMatchPrepare(s),this.unicodeMatch.prefixMatchPrepare(t));};r.EPSILON=1e-05;r.getUniqueSemantic=function(s){if(!s)return;var t=[],u=[],v=[];s='('+s+')';var w=s,x=false;s.replace(/[\(\),]/g,function(y,z){var aa;switch(y){case ',':var ba=v.length-1;aa=w.substr(v[ba],z-v[ba]);t[ba].push(aa);v[ba]=z+1;break;case '(':v.push(z+1);t.push([]);u.push(z+1);break;case ')':if(v.length===0)throw s+' is not a valid semantic string';var ca=v.pop();aa=w.substr(ca,z-ca);aa=decodeURI(aa.replace(/%/g,'%25').replace(/\s/g,'+').trim());var da=t.pop();da.push(aa);var ea=da.sort();for(var fa=1;fa<ea.length;fa++)if(ea[fa]==ea[fa-1])x=true;var ga=ea.join(',');w=w.substr(0,u.pop())+ga+w.substr(z);break;}return y;});if(x)return '';return w.replace(/\((.*)\)/,'$1');};f.exports=r;},null);
__d("FacebarTokenizer",["TokenizeUtil"],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i="[^\"]",j=["\\s's","'s","\""+i+"*\"?"],k=[[/\s+$/,''],[/\"\s+/,'"'],[/\s+\"/,'"'],[/\"\"/,''],[/^\"$/,''],[/\s+/,' ']],l={tokenize:function(m,n){var o=[],p=0;m=m.replace(/\s/g,' ').toLowerCase();m.replace(new RegExp(j.join('|'),'g'),function(r,s){if(s>p){var t=m.substr(p,s-p);Array.prototype.push.apply(o,h.parse(t).tokens.slice(0));}var u=r;for(var v=0;v<k.length;v++){var w=k[v];u=u.replace(w[0],w[1]);}if(o.length&&u=='\'s'){o[o.length-1]+=u;}else if(u!=='')o.push(u);if(n)Array.prototype.push.apply(o,h.parse(r).tokens);p=s+r.length;});if(p<m.length){var q=m.substr(p,m.length-p);Array.prototype.push.apply(o,h.parse(q).tokens.slice(0));}return o;}};f.exports=l;},null);
__d('FacebarTypeaheadTypeNamedX',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={browse_type_user:'user',browse_type_page:'page',browse_type_place:'place',browse_type_group:'group',browse_type_application:'app'},i=1,j=2;k.addTypeNamedX=function(l,m,n,o){'use strict';var p=new k(),q=[],r=[];l.forEach(function(w){delete w.tags.hiddenSeeMore;if(w.isSeeMore){q.push(w);}else r.push(w);});if(!o.showTypeNamedX){q.forEach(function(w){w.tags.hiddenSeeMore=true;});return r;}var s=p.buildTypeNamedXBuckets(r,q,n,o),t=s[0],u=s[1];t.forEach(function(w){w.tags.displayedSeeMore=true;});var v=p.replaceResults(r,m,t);Array.prototype.push.apply(v,u);v.forEach(function(w){w.tags.hiddenSeeMore=true;});return r;};k.prototype.buildTypeNamedXBuckets=function(l,m,n,o){'use strict';var p={};o=o||{};l.forEach(function(t,u){var v=t.render_type||t.type;if(p[v]===undefined)p[v]={index:u,matchCount:0};if(!o.alwaysDisplayTypeNamedX&&t.text.toLowerCase().indexOf(n.toLowerCase())<0)return;p[v].matchCount++;});var q=[],r=[];m.forEach(function(t){var u=h[t.results_set_type];if(p[u]!==undefined&&p[u].matchCount>=i){q.push([t,p[u].index]);}else r.push(t);});q.sort(function(t,u){return t[1]-u[1];});var s=q.map(function(t){return t[0];});Array.prototype.push.apply(r,s.slice(j));s.length=Math.min(s.length,j);return [s,r];};k.prototype.replaceResults=function(l,m,n){'use strict';var o=[],p=Math.min(0,l.length-m)+n.length;for(var q=0;q<p;++q){var r=-1;for(var s=0;s<Math.min(m-q,l.length);++s){var t=l[s];if(!t.exactMatchKeyword&&t.type!=='websuggestion')r=s;}if(r>=0){o.push(l[r]);l.splice(r,1);}}Array.prototype.unshift.apply(l,n);return o;};function k(){'use strict';}f.exports=k;},null);
__d('FacebarTypeaheadL2Terms',['FacebarJSConstants'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=3,j={addL2Terms:function(k,l,m,n){if(!n.suggestBackendL2Terms)return k;var o=[],p=[];k.forEach(function(r){if(r.exactMatchKeyword){r.tags.l2_suggestion=true;o.push(r);}else if(r.isKeywordL2){r.tags.l2_suggestion=true;r.type='l2suggestion';o.push(r);}else if(r.type!=='keywords')p.push(r);});var q=0;return p.map(function(r){if(h.entityTypes[r.type])if(q<i){q++;}else if(o.length)return o.pop();return r;});}};f.exports=j;},null);
__d('ResultsBucketizer',['FacebarJSConstants'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j,k){'use strict';this.$ResultsBucketizer1=j;this.$ResultsBucketizer2=k;}i.trimResults=function(j,k,l){'use strict';var m=[];j.forEach(function(n,o){if(n.indexBeforeBuckets>k)m.push({index:o,originalIndex:n.indexBeforeBuckets});});m.sort(function(n,o){return n.originalIndex-o.originalIndex;}).slice(l).sort(function(n,o){return o.index-n.index;}).forEach(function(n){j.splice(n.index,1);});};i.mergeBuckets=function(j,k){'use strict';var l=[];for(var m in k)if(!k[m].rule.hidden&&(!k[m].rule.xor||!k[k[m].rule.xor]))l.push(k[m]);l.sort(function(n,o){var p=(n.rule.position||0)-(o.rule.position||0);if(p!==0)return p;return n.results[0].indexBeforeBuckets-o.results[0].indexBeforeBuckets;});j.length=0;l.forEach((function(n,o){if(n.rule.maxPromotions!=null&&o<l.length-1)i.trimResults(n.results,l[o+1].results[0].indexBeforeBuckets,n.rule.maxPromotions);Array.prototype.push.apply(j,n.results);}).bind(this));};i.prototype.$ResultsBucketizer3=function(j,k){'use strict';if(k.propertyName==null)return k.bucketName||'default';var l=this.$ResultsBucketizer2(j,k.propertyName);if(l==null||k.propertyValue!=null&&''+l!==k.propertyValue)return false;return k.bucketName||k.propertyName+'.'+l;};i.prototype.$ResultsBucketizer4=function(j,k,l){'use strict';var m={};j.forEach((function(n,o){k.some((function(p){var q=this.$ResultsBucketizer3(n,p);if(q===false)return false;if(m[q]==null)m[q]={results:[],rule:p};if(q==h.keywordType&&l&&m[q].results.length>=l)return true;if(!!p.maxResults&&m[q].results.length>=p.maxResults)return true;n.bucketLineage.push({bucketName:q,bucketIndex:m[q].results.length});m[q].results.push(n);return true;}).bind(this));}).bind(this));return m;};i.prototype.$ResultsBucketizer5=function(j,k,l){'use strict';var m=this.$ResultsBucketizer1[k];if(!m)return {};var n=this.$ResultsBucketizer4(j,m,l);for(var o in n){var p=n[o].rule.subBucketRules;if(!!p)this.$ResultsBucketizer5(n[o].results,p,l);}i.mergeBuckets(j,n);return n;};i.prototype.$ResultsBucketizer6=function(j,k,l){'use strict';if(k.length<=l)return k.slice();var m=k.map(function(o){return o.indexBeforeBuckets;}),n=m.sort(function(o,p){return o-p;})[l];return k.filter(function(o){return o.indexBeforeBuckets<n;});};i.prototype.bucketize=function(j,k,l,m){'use strict';j.forEach(function(n,o){n.bucketLineage=[];n.indexBeforeBuckets=o;});l=l||{};Object.assign(l,this.$ResultsBucketizer5(j,'main',m));return this.$ResultsBucketizer6(l,j,k);};f.exports=i;},null);
__d('FacebarDataSource',['Arbiter','AsyncRequest','FacebarFindPeopleAndPages','FacebarGlobalOptions','FacebarGSv2Echo','FacebarInviteCoworkers','FacebarJSConstants','FacebarResultStore','FacebarResultStoreUtils','FacebarStructuredText','FacebarTimerUtils','FacebarTokenizer','FacebarTypeaheadTypeNamedX','FacebarTypeNamedXBootstrap','FacebarTypeaheadL2Terms','FacebarTypeNamedXTokenOptions','FacebarURI','ResultsBucketizer','ResultsBucketizerConfig','SearchDataSource','Vector','ViewportBounds','throttle','invariant','queryThenMutateDOM','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){if(c.__markCompiled)c.__markCompiled();var ha,ia;ha=babelHelpers.inherits(ja,aa);ia=ha&&ha.prototype;function ja(ka){'use strict';ia.constructor.call(this,ka);this._fetched_null_state=null;this._initialQueryData=null;this._curQueryId=-1;this._maxRemoteQueryId=-1;this._single_state=true;this._waitingQueries=0;this.mixGrammarAndEntity=ka.mixGrammarAndEntity!==undefined?ka.mixGrammarAndEntity:true;this.grammarVersion=ka.grammarVersion||'';if(!ka.grammarOptions)ka.grammarOptions={};this.recordingRoute='banzai_vital';this._maxGrammarResults=ka.grammarOptions.maxGrammarResults;this.nullStateEndpoint=ka.nullStateEndpoint||'/ajax/browse/null_state.php';this.setNullStateData(ka.nullStateData||{},true);this._minQueryLength=ka.minQueryLength||-1;this._performShortQuery=ka.performShortQuery||false;this._fixProcessLean=ka.grammarOptions.fixProcessLean||false;this.hasGSPreload=k.hasGSPreload;this.gsPreloadOptions=k.gsPreloadParams;this.throttleExecuteQuery();this.throttleSendRemoteQuery();this.throttleRenderResults();this.resultStoreOptions=ka.grammarOptions||{};this.resultStoreOptions.useNewExactNameMatch=ka.grammarOptions.useNewExactNameMatch==="true";this.defaultQuery=null;this._bypassBucketizer=false;this._resultsBucketizer=new y(z.rules,function(la,ma){switch(ma){case 'isSeeMore':return la.isSeeMore;case 'objectType':return la.type;case 'resultSetType':return la.results_set_type;case 'renderType':return la.render_type||la.type;case 'cacheOnlyResult':return la.cacheOnlyResult;case 'closeEntity':return la.bootstrapped||(!!la.tags?la.tags[ma]:undefined);default:return !!la.tags?la.tags[ma]:undefined;}});this.fetchNullState();this.initWithConfig(k.grammarConfig);}ja.prototype.initWithConfig=function(ka){'use strict';this.facebarConfig=ka;this.createResultStore();this.blockees={};if(this._fetched_null_state){this.setNullState(this._fetched_null_state);this._fetched_null_state=null;}};ja.prototype.throttleExecuteQuery=function(){'use strict';var ka=k.executeQueryThrottleTime;this.executeQueryThrottled=da.withBlocking(this.executeQuery,ka,this);};ja.prototype.throttleSendRemoteQuery=function(){'use strict';var ka=k.sendRemoteQueryThrottleTime;if(ka===0){this.sendRemoteQueryThrottled=this.sendRemoteQuery;}else if(k.lazyThrottleRemoteQuery){var la=Date.now(),ma=k.enableSendRemoteQueryDelay,na=k.sendRemoteQueryDelayTime;this.sendRemoteQueryThrottled=(function(){for(var oa=arguments.length,pa=Array(oa),qa=0;qa<oa;qa++)pa[qa]=arguments[qa];var ra=Date.now();if(la+ka<ra){la=ra;if(ma){ga((function(){this.sendRemoteQuery.apply(this,pa);}).bind(this),na);}else this.sendRemoteQuery.apply(this,pa);}}).bind(this);}else this.sendRemoteQueryThrottled=da.withBlocking(this.sendRemoteQuery,ka,this);};ja.prototype.throttleRenderResults=function(){'use strict';var ka=k.renderThrottleTime;if(ka===0){this.renderResultsThrottled=this.renderResults;return;}var la=Date.now();this.renderResultsThrottled=(function(ma,na,oa,pa,qa){var ra=Date.now();if(oa||la+ka<ra){la=ra;this.renderResults(ma,na,oa,pa,qa);}}).bind(this);};ja.prototype.createResultStore=function(){'use strict';this.facebarConfig.maxGrammarResults=this._maxGrammarResults;this.resultStore=new o(this.facebarConfig,s.tokenize,this.getEntry.bind(this),this.resultStoreOptions);if(this._fixProcessLean)this._processLean();this.subscribe('setSortFunction',(function(ka,la){this.resultStore.setSortFunction(la);}).bind(this));};ja.prototype.dirty=function(){'use strict';this._nullStateFetched=false;this.resultStore.resetCaches();ia.dirty.call(this);};ja.prototype.addEntries=function(ka){'use strict';this.resultStore.addBootstrap(this.processEntries(ka));};ja.prototype._processLean=function(){'use strict';if(this._fixProcessLean){if(this._leanPayload&&this.resultStore){var ka,la=this._leanPayload.entries;for(var ma in la){ka=this.getEntry(ma);if(!ka)continue;for(var na in la[ma]){if(!ka.grammar_costs)ka.grammar_costs={};ka.grammar_costs['{'+na+'}']=la[ma][na];}}this.setExclusions(this._leanPayload.blocked);this._leanPayload=null;}}else ia._processLean.call(this);};ja.prototype.setNullStateData=function(ka,la){'use strict';if(la)this.nullStateData={grammar_version:this.grammarVersion};Object.assign(this.nullStateData,ka);return this;};ja.prototype.setNullState=function(ka){'use strict';this._null_state=ka;this.processEntries(this._null_state.entities);this.resultStore.setNullState(this._null_state.queries);var la=u.typeNamedX;la.forEach(function(ma){ma.parse.extendable=true;ma.qid=this._curQueryId;ma.isTypeNamedXBootstrap=true;},this);this.resultStore.addNullStateToQueryCache(this.getRawStructure(q.fromString('')),la);this._typeNamedXResults={};la.forEach(function(ma){this._typeNamedXResults[n.grammarToEntityTypes[ma.resultsSetType]]=ma;},this);};ja.prototype.getNullStateTrending=function(){'use strict';return this._null_state.trending;};ja.prototype.setSingleState=function(ka){'use strict';this._single_state=ka;};ja.prototype.overrideNullState=function(ka){'use strict';!(this._null_state!=null)?ea(0):undefined;this._original_null_state=this._original_null_state||this._null_state;this.setNullState(ka);};ja.prototype.restoreNullState=function(){'use strict';if(this._original_null_state)this.setNullState(this._original_null_state);};ja.prototype.fetchNullState=function(){'use strict';if(this._nullStateFetched){this.activityStart();setTimeout(this.activityEnd.bind(this),0);return;}var ka=new i().setURI(this.nullStateEndpoint).setData(this.nullStateData).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler((function(la){if(this.resultStore){this.setNullState(la.payload);this.inform('nullstateReady',true);}else this._fetched_null_state=la.payload;this._nullStateFetched=true;}).bind(this)).setFinallyHandler(this.activityEnd.bind(this));this.activityStart();ka.send();};ja.prototype.fetchNUXResults=function(ka){'use strict';if(!k.allowGrammar)return;ka=ka||{};var la=new i().setURI(ka.URI).setData(this.nullStateData).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler((function(ma){if(this.resultStore){this.overrideNullState(ma.payload);ka.success&&ka.success();}}).bind(this)).setFinallyHandler(this.activityEnd.bind(this));this.activityStart();la.send();};ja.prototype.toTypeaheadEntryUid=function(ka){'use strict';var la,ma=q.fromStruct(ka.structure),na=ma.getFragment(0);if(ma.getCount()==1&&na.isType('ent')){var oa=na.getType().split(':')[2];la=this.getEntry(na.getUID(),oa);la.type=this.resultStore.stripBrackets(ka.type);}else{la=this.getEntry(ka.tuid);if(!la){la={dynamic_cost:ka.dynamic_cost,extra_uri_params:ka.extra_uri_params,memcache:ka.fromMemcache,photo:ka.photo,results_set_type:ka.resultsSetType,tuid:ka.tuid,type:ka.type,uid:ka.tuid,tags:ka.tags,is_redirect:ka.isRedirect};this.processEntries([la]);la=this.getEntry(ka.tuid);}la.icon_class=ka.iconClass;if(k.renderKeywordSnippets){la.category=ka.category;la.subtext=ka.subtext;la.boldedSubtext=ka.boldedSubtext;}}if(la.is_redirect)la.path=ka.path;la.error_info=ka.errorInfo;la.logInfo=ka.logInfo;la.structure=ma;la.text=la.structure.toString();la.queryTypeText=ka.queryTypeText;la.semantic=!!ka.isSingleState&&ka.singleStateSemantic?ka.singleStateSemantic:ka.semantic;la.alternateSemantic=ka.alternateSemantic;la.tree=ka.tree;la.cost=ka.cost;la.isSeeMore=!!ka.isSeeMore;la.isNullState=!!ka.isNullState;la.isSingleState=!!ka.isSingleState;la.keywordSource=ka.keywordSource;var pa=ka.keyword_type;la.isTrending=!!ka.isTrending||pa===n.keywordTypes.trending;la.isCelebrity=pa===n.keywordTypes.celebrity;la.isFootball=pa===n.keywordTypes.football;la.isPhotos=pa===n.keywordTypes.photos;la.isVideos=pa===n.keywordTypes.videos;la.isHashtag=pa===n.keywordTypes.hashtag;la.isLocal=pa===n.keywordTypes.local;la.isCompany=pa===n.keywordTypes.company;la.isMovie=pa===n.keywordTypes.movie;la.isHappeningNow=pa===n.keywordTypes.happeningNow;la.isSpecialIntentGeneric=pa===n.keywordTypes.specialIntentGeneric;la.isLink=pa===n.keywordTypes.link;n.intentKeys.map(function(qa){la.isSpecialIntent=la.isSpecialIntent||la[qa];});la.isRecent=!!ka.isRecent;la.isAdminedPage=!!ka.isAdminedPage;la.isPrefetched=!!ka.isPrefetched;la.isSuggestion=!!ka.isSuggestion;la.isFromGSEF=!!ka.isFromGSEF;la.isRecentSearchSuggestion=!!ka.isRecentSearchSuggestion;la.isPopularSearchSuggestion=!!ka.isPopularSearchSuggestion;la.entityInfo=ka.entityInfo;la.cacheOnlyResult=ka.cacheOnlyResult||false;la.isExtendedResult=ka.isExtendedResult||false;if(ka.isExtendedResult){la.uri=x.getURI(this.facebarConfig,la);}else la.uri=la.uri||x.getURI(this.facebarConfig,la);la.parse=ka.parse;la.tags=ka.tags||{};la.isKeywordL2=ka.isKeywordL2||false;la.exactMatchKeyword=ka.exactMatchKeyword||false;la.qid=ka.qid;la.templateID=ka.templateID;if(ka.isJSBootstrapMatch){la.isJSBootstrapMatch=ka.isJSBootstrapMatch;la.backendCost=ka.backendCost;la.bootstrapCost=ka.bootstrapCost;}this._replaceCategoryWithTermMatches(la,ka);return la.tuid;};ja.prototype._replaceCategoryWithTermMatches=function(ka,la){'use strict';if(ka.type!=="user"||!ka.term_to_subtitle||!la.termMatches)return;var ma=[];la.termMatches.forEach(function(oa){if(ka.term_to_subtitle[oa])ma.push(ka.term_to_subtitle[oa]);},this);if(ka.category===undefined)ka.category="";var na=ka.category.split(" \xB7 ");na.unshift.apply(na,ma);na=na.filter(function(oa,pa,qa){return pa==qa.indexOf(oa);});ka.category=na.splice(0,2).join(" \xB7 ");};ja.prototype.getRawStructure=function(ka){'use strict';if(typeof ka=='string')ka=q.fromString(ka);if(this.resultStore)return this.resultStore.transformStructured(ka.toArray());};ja.prototype.saveResult=function(ka){'use strict';this._initialQueryData=this.getUID(ka.uid,ka.fetchType);};ja.prototype.isDefaultKeywordQuery=function(ka){'use strict';return ka.type===n.keywordType&&p.getTextFromResult(ka).toLowerCase()===this.value.getHash().trim().toLowerCase();};ja.prototype.buildUids=function(ka){'use strict';if(!ka||!this.resultStore)return [];if(typeof ka==='string')ka=q.fromString(ka);var la=this.getRawStructure(ka),ma=this.resultStore.getResults(la,this.getMaxResults()),na=ma.results;if(typeof na==='undefined')return [];var oa=ma.null_state===true,pa=0;na=na.filter(function(ta,ua){if(!k.allowGrammar&&ta.type=='grammar')return false;return ta.semantic!='<blank>'&&(ta.type!='unimplemented'||pa++===0);},this);var qa=[],ra=[],sa=[];na.forEach(function(ta){if(ta.forcedPosition>0){sa.push(ta);}else if(ta.isSeeMore){qa.push(ta);}else ra.push(ta);});if(oa){na=this.orderNullState(na,this.getMaxResults());}else na=ra;if(sa.length>0){sa.sort(function(ta,ua){return ta.forcedPosition-ua.forcedPosition;});sa.forEach(function(ta){na.splice(ta.forcedPosition,0,ta);});}if(qa.length>0)na.push.apply(na,qa);return na.map(this.toTypeaheadEntryUid,this);};ja.prototype.orderNullState=function(ka,la){'use strict';var ma={top:[],bottom:[],middle:[]},na=function(qa){var ra=qa.null_state_position;return ma.hasOwnProperty(ra)?ra:'middle';},oa=function(qa,ra){return qa.original_cost-ra.original_cost;};ka&&ka.forEach(function(qa){ma[na(qa)].push(qa);},this);for(var pa in ma){ma[pa]=ma[pa].sort(oa).slice(0,la);la-=ma[pa].length;}return [].concat(ma.top,ma.middle,ma.bottom);};ja.prototype.isEntity=function(ka){'use strict';if(!ka)return false;return (/^\d+$/.test(ka));};ja.prototype.handleResponse=function(ka,la){'use strict';if(!(ka.payload.errors)){this.processEntries(ka.payload.entities);if(ka.payload.blockees)ka.payload.blockees.forEach((function(ma){if(!this.blockees.hasOwnProperty(ma))this.blockees[ma.toLocaleLowerCase()]=ma;}).bind(this));ka.payload.results.forEach((function(ma){ma.qid=ka.queryId;if(!ma.parse)ma.parse={};ma.parse.entTokens=ma.parse.entTokens||[];ma.parse.remTokens=ma.parse.remTokens||[];ma.parse.suffix=ma.parse.suffix||'';if(this.isEntity(ma.semantic))ma=this._buildCommonEntityFields(ma,la.tokens);}).bind(this));this.saveResults(ka,la);}};ja.prototype.saveResults=function(ka,la){'use strict';var ma=[];if(ka.payload.seemore&&this._typeNamedXResults)ka.payload.seemore.forEach(function(na){ma.push(this._typeNamedXResults[na]);},this);if(ka.payload.prefetched)this.processPrefetched(ka.payload.prefetched);this.resultStore.saveResults(ka.payload.results,la,ka.payload.incomplete,{},ma);};ja.prototype.processPrefetched=function(ka){'use strict';for(var la in ka){var ma=q.fromString(la),na=this.getRawStructure(ma),oa=ka[la];this.processEntries(oa.entities);oa.results.forEach((function(pa){if(this.isEntity(pa.semantic))pa=this._buildCommonEntityFields(pa,na.tokens);}).bind(this));this.resultStore.saveResults(oa.results,na,oa.incomplete);}};ja.prototype.processEntries=function(ka){'use strict';return ka.map(function(la,ma){var na=la.uid=la.uid+'';la.textToIndex=this.getTitleTerms(la);la.titleToIndex=this.getTitleTerms(la);na=this.getUID(na,la.fetchType);var oa=this.getEntry(na);if(!oa){this.setEntry(na,{});oa=this.getEntry(na);}else{delete la.photo;if(!k.facebarUpdateSnippets){delete la.category;delete la.subtext;}}Object.assign(oa,la);oa.tuid=na;oa.index===undefined&&(oa.index=ma);return na;},this);};ja.prototype.getUID=function(ka,la){'use strict';ka=ka+'';if(la!==undefined){la=/([^:]+:)?([^:]+)(:.*)?/.exec(la)[2];return JSON.stringify([ka,la]);}return ka;};ja.prototype.getEntry=function(ka,la){'use strict';var ma;ka=''+ka;ma=la!=null?ia.getEntry.call(this,this.getUID(ka,la))||ia.getEntry.call(this,ka):ia.getEntry.call(this,ka);return ma;};ja.prototype.getEntryForFragment=function(ka){'use strict';return this.getEntry(ka.getUID(),ka.getTypePart(2));};ja.prototype.getMaxResults=function(){'use strict';return this._numResults.max;};ja.prototype.query=function(ka,la,ma){'use strict';this.executeQueryThrottled(ka,this._initialQueryData,{keyPress:r.getTimestamp()});this._initialQueryData=null;};ja.prototype.executeQuery=function(ka,la,ma){'use strict';this._curQueryId++;ma.queryId=this._curQueryId;ma.startCacheQuery=r.getTimestamp();var na=this.getMaxResults()+w.additionalResultsToFetch;this.setQueryData({qid:this._curQueryId,max_results:na});this.inform('beforeQuery',{value:ka,queryId:this._curQueryId});this.value=ka;var oa=this.buildUids(ka,[]);ma.endCacheQuery=r.getTimestamp();if(la&&oa.length===0)oa.push(la);if(k.sendExistingIDs){var pa=[];oa.forEach(function(qa){var ra=this.getEntry(qa);if(ra&&ra.type in n.entityTypes)pa.push(ra.uid);},this);if(pa.length>0)this.setQueryData({qid:this._curQueryID,existing_ids:JSON.stringify(pa),max_results:na});}this.inform('query',{value:ka,results:oa,queryId:this._curQueryId});if(this.resultStore)this.respond(ka,oa,false,false,ma);};ja.prototype.shouldFetchMore=function(ka,la){'use strict';if(ka.is_empty)return false;if(this.resultStore.alreadyKnown(ka.cache_id))return false;if(ka.raw_text&&this._isQueryTooShort(ka.raw_text))return false;if(k.alwaysFetchMore)return true;if(la.length<this.getMaxResults()||this._performShortQuery)return true;return this.countValidResults(la)<this.getMaxResults()||this._performShortQuery;};ja.prototype.countValidResults=function(ka){'use strict';var la=0;ka.forEach(function(ma){if(ma&&!ma.isNullState&&!ma.isSeeMore)la++;},this);return la;};ja.prototype.sendRemoteQuery=function(ka,la,ma,na,oa){'use strict';var pa=this._single_state,qa=this.getQueryData(ka.text_form);qa.gs_prefetch_mode=na;if(oa)qa.max_results=oa;var ra=new i().setURI(this.queryEndpoint).setData(qa).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler((function(sa,ta){if(na&&ta.payload.is_user)return;var ua=ta.payload;ta.queryId=sa;ta.inputQuery=ka.text_form;if(ua.results!=null)ua.results.forEach(function(wa){wa.isSingleState=pa;wa.isFromGSEF=na;});ma.endRemoteQuery=r.getTimestamp();this.inform('response_received',ta);this.handleResponse(ta,ka);var va=[];if(ua.abandon_cache)va=ua.results.map(this.toTypeaheadEntryUid,this);this.respond(la,va,true,ua&&(!ua.results||ua.results.length===0),ma,ua.num_topresults_to_show);this.inform('backend_response',ta);if(k.disable_snowballing){this.resultStore.resetQueryCache();this.saveResults(ta,ka);}}).bind(this,ma.queryId)).setFinallyHandler(this.activityEnd.bind(this));this.inform('sending_request',ra);this._maxRemoteQueryId=ma.queryId;ma.waitingQueries=this._waitingQueries;ma.inflightRequests=i.getInflightCount();ma.startRemoteQuery=r.getTimestamp();ra.send();this.activityStart();};ja.prototype.activityStart=function(){'use strict';if(!this._waitingQueries)this.inform('activity',{activity:true},h.BEHAVIOR_STATE);this._waitingQueries++;};ja.prototype.activityEnd=function(){'use strict';this._waitingQueries--;if(!this._waitingQueries)this.inform('activity',{activity:false},h.BEHAVIOR_STATE);};ja.prototype._bucketizeResults=function(ka,la,ma){'use strict';la=this._tagKeywordsSuggestions(la);la=v.addL2Terms(la,this.getMaxResults(),ka.toString(),k);la=t.addTypeNamedX(la,this.getMaxResults(),ka.toString(),k);var na=Math.min(la.length,this.getMaxResults());return this._resultsBucketizer.bucketize(la,na,null,ma);};ja.prototype._tagKeywordsSuggestions=function(ka){'use strict';if(!ka||ka.length===0)return ka;var la=ka[0];if(la.bootstrapped)return ka;if(la.type==='grammar'||la.cost<k.closeEntityThreshold&&la.type==='user')return ka;return ka.map(function(ma){if(ma.type!==n.keywordType)return ma;ma=babelHelpers._extends({},ma);ma.tags.topBucket=true;return ma;});};ja.prototype._buildCommonEntityFields=function(ka,la){'use strict';if(ka.queryTypeText)return ka;if(k.unbreakParseDisplay){ka.parse.display=[{type:'ent:'+ka.type,uid:ka.semantic}];}else ka.parse.display=[{type:'ent:'+ka.type,uid:parseInt(ka.semantic,10)}];if(ka.parse.fetchType)ka.parse.display[0].fetchType=ka.parse.fetchType;ka.parse.entTokens=la;ka.parse.pos=0;ka.resultsSetType='{'+ka.type+'}';ka.queryTypeText=n.defaultQueryTypeText;return ka;};ja.prototype.setBypassBucketizer=function(ka){'use strict';this._bypassBucketizer=ka;};ja.prototype.respond=function(ka,la,ma,na,oa,pa){'use strict';if(ma&&this.value){if(typeof this.value==='string')this.value=q.fromString(this.value);this.inform('remote_query_match',{isMatch:this.value.matches(ka),queryId:oa?oa.queryId:0});ka=this.value;if(!la||la.length===0)la=this.buildUids(ka);}this.inform('reorderResults',la);this.inform('respondValidUids',la);var qa=la.map(this.getEntry,this);qa.forEach(function(sa,ta){sa.fromCache=!ma;sa.isSingleState=this._single_state;},this);if(!ma&&(ka.getHash().length<512||ka.getHash().startsWith('http://')||ka.getHash().startsWith('https://'))){var ra=this.getRawStructure(ka);if(this.shouldFetchMore(ra,qa)){if(oa!=null)oa.dispatchRemoteQuery=r.getTimestamp();if(this.hasGSPreload){this.sendRemoteQueryThrottled(ra,ka,oa,true,this.gsPreloadOptions.max_entities_to_fetch);this.sendRemoteQueryThrottled(ra,ka,oa);}else this.sendRemoteQueryThrottled(ra,ka,oa);}}if(!ma||!oa||oa.queryId===this._maxRemoteQueryId)this.renderResultsThrottled(ka,qa,ma,na,pa);if(oa!=null)this.logLatencies(ma,oa);};ja.prototype.renderResults=function(ka,la,ma,na,oa){'use strict';if(!!ka&&(ka instanceof q&&!ka.isEmptyOrWhitespace())&&!this._bypassBucketizer)la=this._bucketizeResults(ka,la,oa);la.length=Math.min(la.length,this.getMaxResults());this.injectExtraResults(ka,la);na=ma&&la.length===0;this.inform('respond',{value:ka,results:la,isAsync:!!ma,isEmptyResults:na});};ja.prototype.injectExtraResults=function(ka,la,ma){'use strict';l.insertInto(ka,la,!ma,this._single_state);j.insertInto(ka,la,!ma,this._single_state);m.insertInto(ka,la,!ma,this._single_state);};ja.prototype.logLatencies=function(ka,la){'use strict';var ma=r.getTimestamp();if(ka){this.inform('remote_query_latency',{queryId:la.queryId,latencies:{queryStart:Math.max(la.startRemoteQuery-la.dispatchRemoteQuery,0),queryEnd:Math.max(la.endRemoteQuery-la.startRemoteQuery,0),keyPressToQueryDispatch:Math.max(la.dispatchRemoteQuery-la.keyPress,0),keyPressToQueryStart:Math.max(la.startRemoteQuery-la.keyPress,0),keyPressToQueryEnd:Math.max(la.endRemoteQuery-la.keyPress,0),render:Math.max(ma-la.endRemoteQuery,0),inflightRequests:la.inflightRequests,waitingQueries:la.waitingQueries,keyPressToRender:Math.max(ma-la.keyPress,0)}});}else this.inform('cache_query_latency',{queryId:la.queryId,latencies:{queryStart:Math.max(la.startCacheQuery-la.keyPress,0),queryEnd:Math.max(la.endCacheQuery-la.startCacheQuery,0),keyPressToQueryEnd:Math.max(la.endCacheQuery-la.keyPress,0),render:Math.max(ma-la.endCacheQuery,0),keyPressToRender:Math.max(ma-la.keyPress,0)}});};ja.prototype._updateMaxResults=function(){'use strict';fa((function(){var ka=ba.getViewportDimensions().y,la=ca.getTop()||42,ma=56,na=48,oa=ka-la-na-25;this._maxResults=Math.max(this._numResults.min,Math.min(this._numResults.max,Math.floor(oa/ma)-1));this.value&&this.query(this.value);}).bind(this));};ja.prototype.getCurQueryId=function(){'use strict';return this._curQueryId;};ja.prototype.setTypenamedXOption=function(ka){'use strict';k.showTypeNamedX=ka;};ja.prototype.setMinQueryLength=function(ka){'use strict';this._minQueryLength=ka;};ja.prototype.setGrammarOption=function(ka){'use strict';k.allowGrammar=ka;};Object.assign(ja.prototype,{events:['query','respond','bootstrapped','activity','ready']});f.exports=ja;},null);
__d('FacebarTypeaheadDebugPane.react',['Banzai','LeftRight.react','React','Image.react'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=j.PropTypes,m=j.createClass({displayName:'FacebarTypeaheadDebugPane',propTypes:{result:l.object.isRequired},getInitialState:function(){return {feedbackSent:false};},componentWillReceiveProps:function(n){if(n.result!==this.props.result)this.setState({feedbackSent:false});},sendFeedback:function(n){var o=this.props.result;if(o.decoration.entity===o)o.decoration.entity='';var p=JSON.stringify(o),q=JSON.stringify(o.debug.allResults),r={result:p,query:o.debug.query,position:o.debug.position,sid:o.debug.sid,allResults:q,isOK:n};h.post('facebar_feedback',r,{delay:0});this.setState({feedbackSent:true});this.setState({feedbackOK:n});return false;},renderDebugText:function(n){return j.createElement('div',null,n);},render:function(){var n=this.sendFeedback.bind(this,true),o=this.sendFeedback.bind(this,false),p=this.state.feedbackSent,q=p&&this.state.feedbackOK,r=p&&!this.state.feedbackOK;return (j.createElement('div',{className:'fsm pam'},j.createElement(i,null,j.createElement('div',null,this.props.result.debug.map(this.renderDebugText)),j.createElement('div',null,j.createElement('div',{className:q?'':'hidden_elem'},j.createElement('strong',null,'Feedback sent'),j.createElement(k,{className:'mls',src:'/images/green_up.gif'})),j.createElement('div',{className:r?'':'hidden_elem'},j.createElement('strong',null,'Feedback sent'),j.createElement(k,{className:'mls',src:'/images/red_down.gif'})),j.createElement('div',{className:p?'hidden_elem':''},j.createElement('a',{href:'#',onClick:n},j.createElement(k,{src:'/images/green_up.gif'})),j.createElement('a',{href:'#',onClick:o},j.createElement(k,{className:'mls',src:'/images/red_down.gif'})))))));}});f.exports=m;},null);
__d('FacebarTypeaheadDiffText.react',['React','cx'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=h.PropTypes,k=h.createClass({displayName:'FacebarTypeaheadDiffText',propTypes:{prefix:j.string,text:j.string},renderDiff:function(l,m){return (h.createElement('span',{className:"diffNode _5td3",key:m},l));},renderParts:function(){var l=this.props.prefix,m=this.props.text;if(l==null)return this.renderDiff(m,0);var n=m.toLowerCase().indexOf(l.toLowerCase());l=l.trim();if(n===0)m=m.slice(l.length);var o=m.split(/\b/).map(this.renderDiff);if(n===0)o.unshift(l);return o;},render:function(){return (h.createElement('span',this.props,this.renderParts()));}});k.generatePrefixes=function(l,m){var n=[],o,p;for(var q=0,r=m.length;q<r;q++){p=m[q].getText();o=l.slice(0,Math.min(l.length,p.length));if(o==='')return n;if(p.toLowerCase().indexOf(o.toLowerCase())===0){n.push(o);l=l.slice(o.length);}else return n;}return n;};f.exports=k;},null);
__d('FacebarTypeaheadHighlightedText.react',['BrowseFacebarHighlighter','React'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=i.PropTypes,k=i.createClass({displayName:'FacebarTypeaheadHighlightedText',propTypes:{text:j.string,tokens:j.array},renderHighlight:function(l,m){if((m+1)%3===0){return i.createElement('span',{className:'highlightNode',key:m},l);}else if(l)return l;},renderParts:function(){var l=this.props.text,m=this.props.tokens;if(m&&l){var n=h.createRegex(m),o=l.split(n);return o.map(this.renderHighlight);}else return l;},render:function(){return (i.createElement('span',this.props,this.renderParts()));}});f.exports=k;},null);
__d('FacebarTypeaheadItem.react',['Badge.react','React','FacebarGlobalOptions','FacebarTypeaheadDebugPane.react','FacebarTypeaheadDiffText.react','FacebarTypeaheadHighlightedText.react','TimelineFilterOptions','URI','XUICloseButton.react','TypeaheadCanvasConfig','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();var t=i.PropTypes;function u(w){var x=w.getTypePart(0);return x?"fragment"+x.charAt(0).toUpperCase()+x.substr(1):"fragment";}var v=i.createClass({displayName:'FacebarTypeaheadItem',propTypes:{result:t.object.isRequired,className:t.string,icon:t.object,token:t.object,highlight:t.array,prefix:t.string,message:t.object,valign:t.bool},getDefaultProps:function(){return {valign:true};},renderHighlightedFragment:function(w,x){return (i.createElement(m,{className:u(w),key:x,text:w.getText(),tokens:this.props.highlight}));},renderDiffedFragment:function(w,x,y){return (i.createElement(l,{className:u(w),key:y,prefix:x,text:w.getText()}));},renderText:function(){var w=this.props.result,x=w.structure.toArray(),y=this.props.prefix;if(j.graphSearchV2&&!w.isSeeMore&&y!=null&&y.trim()!==''){var z=l.generatePrefixes(y,x);return x.map((function(aa,ba){if(!z[ba])z[ba]='';return this.renderDiffedFragment(aa,z[ba],ba);}).bind(this));}else return x.map(this.renderHighlightedFragment);},renderBadge:function(){if(this.props.result.category&&this.props.result.category.toLowerCase()==='game'&&q.in_games_v1&&q.show_controller){return (i.createElement(h,{type:'gamegreen',size:'medium'}));}else if(this.props.result.is_verified){return (i.createElement(h,{type:'verified',size:'medium'}));}else if(this.props.result.is_work_user){return (i.createElement(h,{type:'work',size:'medium'}));}else if(this.props.result.pages_verified_badge===1)return (i.createElement(h,{type:'page_gray_check',size:'medium'}));},renderIcon:function(){var w=this.props.result,x=w.icon_class;if(x){return (i.createElement('span',{className:"_k83"},i.createElement('span',{className:x})));}else if(w.photo)return (i.createElement('img',{className:"_20h",alt:'',src:w.photo}));},renderLabel:function(){var w=' \u00B7 ',x=this.props.result,y="_53ad"+(this.props.valign&&this.props.token&&this.props.token.props&&this.props.token.props.text.length>0?' '+"_55y-":'')+(!x.category&&!x.subtext?' '+"_2vzo":'')+(!x.category&&!!x.subtext||x.category&&x.category.indexOf(w)<0&&!x.subtext?' '+"_2vzp":'')+(x.category&&!!x.subtext||x.category&&x.category.indexOf(w)>0?' '+"_2vzq":''),z=i.createElement('span',{className:y},this.renderText(),this.renderBadge(),this.props.token),aa="_7gk"+(this.props.message?' '+"_5byz":'');return (i.createElement('span',{className:aa},z,this.props.message));},renderMain:function(){var w=i.createElement('a',{className:"_6i1",href:this.props.result.uri},i.createElement('span',null,this.props.icon||this.renderIcon(),this.renderLabel()));if(this.props.result.isAsync)w=i.createElement('a',{className:"_6i1",href:'#',ajaxify:this.props.result.asyncURI,rel:'async'},i.createElement('span',null,this.props.icon||this.renderIcon(),this.renderLabel()));return (i.createElement('span',{className:"_205",rel:'ignore'},this.renderActivityLogXButton(),w));},renderActivityLogXButton:function(){if(!this.props.result.isRecentSearchSuggestion)return null;var w=new o('/me/allactivity');w.setQueryData({privacy_source:'activity_log',log_filter:n.SEARCH});return (i.createElement(p,{size:'medium',className:"_2d9t",href:w}));},renderDebug:function(){return this.props.result.debug?i.createElement(k,{result:this.props.result}):null;},render:function(){var w="_202"+(' '+"_5bl2")+(' '+"_6_k")+(j.graphSearchV2?' '+"_1et7":'')+(j.renderKeywordSnippets?' '+"_28vg":'')+(this.props.result.isCelebrity?' '+"_5g-n":'')+(this.props.result.isTrending?' '+"_5g-o":'')+(this.props.result.isRecent?' '+"_jsd":'')+(this.props.result.isLocal?' '+"_1821":'')+(this.props.result.isFootball?' '+"_1822":'')+(this.props.result.isHashtag?' '+"_4z1b":'')+(this.props.result.isPhotos?' '+"_4z1c":'')+(this.props.result.isVideos?' '+"_4z1d":'')+(j.typeaheadkeywordStyle==='relaxed'?' '+"_3bzk":'')+(j.typeaheadkeywordStyle==='baggy'?' '+"_3bzl":'');return (i.createElement('li',{className:s(w,this.props.className),onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,role:'option'},this.renderMain(),this.renderDebug()));}});f.exports=v;},null);
__d('FacebarTypeaheadToken.react',['FacebarTypeaheadHighlightedText.react','React','cx','TypeaheadCanvasConfig'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=i.PropTypes,m=' \u00B7 ',n=i.createClass({displayName:'FacebarTypeaheadToken',propTypes:{text:l.array.isRequired,highlight:l.array,limit:l.number,mainClass:l.string,innerClass:l.string,leadingMiddot:l.bool,savedContext:l.string,category:l.string},render:function(){var o=null;if(this.props.savedContext)o=i.createElement('span',{className:"_10j2"},this.props.savedContext);var p=this.props.text;if(this.props.limit)p.splice(this.props.limit);p.forEach((function(t,u){if(u!==0||this.props.leadingMiddot||o)p[u]=m+t;}).bind(this));var q;if(this.props.category&&this.props.category.toLowerCase()==='game'&&k.in_games_v1&&k.green_category_text===true){q=i.createElement('span',{className:"_2qeb"},p.shift());}else q=i.createElement(h,{className:this.props.mainClass,tokens:this.props.highlight,text:p.shift()});var r=p.length?i.createElement(h,{tokens:this.props.highlight,className:"_53ab",text:p.join('')}):null,s=this.props.innerClass||"_53aa";return (i.createElement('span',{className:"_53a9"},i.createElement('span',{className:s},o,q,r)));}});f.exports=n;},null);
__d('FacebarTypeaheadTokenText',['HTML','FbtResult','getElementText'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k='\u00B7';function l(p){if(p instanceof i){return p.toString();}else if(typeof p==='object'){return j(h(p).getRootNode());}else return p||'';}function m(p){return l(p).split(k).map(function(q){return q.trim();});}function n(p){var q={};return p.filter(function(r){var s=!q[r];q[r]=true;return s&&r;});}var o={textForEntity:function(p,q){var r=p.category||q[p.type]||'',s=p.subtext||'',t=p.boldedSubtext||'',u=m(r).concat(m(t)).concat(m(s));return n(u);},text:function(p){return n(m(p));}};f.exports=o;},null);
__d('FacebarTypeaheadEntityItem.react',['FacebarGlobalOptions','FacebarTypeaheadItem.react','FacebarTypeaheadToken.react','FacebarTypeaheadTokenText','React','TypeaheadFacepileX.react','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=l.createClass({displayName:'FacebarTypeaheadEntityItem',renderToken:function(){return (l.createElement(j,{highlight:this.getHighlightTokens(),text:k.textForEntity(this.props.result,{}),category:this.props.result.category,savedContext:this.props.result.saved_context}));},renderIcon:function(){if(this.props.result.isNullState){var q=this.props.result.icon_class?l.createElement('span',{className:this.props.result.icon_class}):l.createElement('img',{className:"_20h",src:this.props.result.photo});return (l.createElement('span',{className:!h.renderKeywordSnippets?"_k83":''},q));}if(this.props.result.size>1&&this.props.result.photos){return (l.createElement(m,{className:"_51l_",photos:this.props.result.photos,size:this.props.result.size}));}else if(this.props.result.photo)return (l.createElement('img',{className:"_20h",alt:'',src:this.props.result.photo}));},getHighlightTokens:function(){if(this.props.result.original_query){var q=this.props.result.original_query.toString().trim(),r=q.split(' '),s=r.length>1?[q].concat(r):[q];return s.filter(function(t){return t!=='';});}},render:function(){var q=this.props.className;if(this.props.result.isNullState)q=o(this.props.className,!h.renderKeywordSnippets?"_207":'');return (l.createElement(i,babelHelpers._extends({},this.props,{className:q,icon:this.renderIcon(),token:this.renderToken(),highlight:this.getHighlightTokens(),valign:true})));}});f.exports=p;},null);
__d('FacebarDisambiguationDialog',['Event','BrowseLogger','CSS','cx','Dialog','DOM','FacebarStructuredText','FacebarTypeaheadEntityItem.react','React','ReactDOM','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();var s=650;function t(u,v,w,x,y){'use strict';this._sets=u;this._path=v;this._ondone=w;this._oncancel=x;this._selection=[];this._typeaheadSID=y;}t.prototype.show=function(){'use strict';new l().setTitle(r._("Which of these did you mean?")).setBody(this._createBody()).setContentWidth(s).setModal(true).setButtons([l.CONFIRM,l.CANCEL]).setHandler(this._handleDone.bind(this)).setCancelHandler(this._handleCancel.bind(this)).show();this._sets.forEach((function(u){var v=[];u.forEach(function(x){v.push(x.uid);});var w=u[0];i.logDisambiguationImpression(w.text,w.type,this._path,v.join(','),this._typeaheadSID);}).bind(this));};t.prototype._createBody=function(){'use strict';var u=[];this._sets.forEach((function(v,w){u.length&&u.push(m.create('li',{className:"_200"}));v.forEach((function(x){var y=this._createItem(x,w);this._selection[w]||this._selectItem(y);u.push(y.root);}).bind(this));}).bind(this));return m.create('ul',{className:'viewList disambiguationList'},u);};t.prototype._createItem=function(u,v){'use strict';var w={uri:null,subtext:u.subtext,category:u.category,photo:u.photo,type:u.type,structure:n.fromStruct([{text:u.text,type:'ent:'+u.type,uid:u.uid}])},x=m.create('div',{className:"_201"}),y=p.createElement(o,{result:w}),z=m.create('div');q.render(y,z);var aa=z.firstChild;j.addClass(aa,"_6i3");m.appendContent(aa,j.hide(x));var ba={setId:v,result:u,root:aa,check:x};h.listen(aa,'mouseover',this._toggleHover.bind(this,ba,true));h.listen(aa,'mouseout',this._toggleHover.bind(this,ba,false));h.listen(aa,'click',(function(event){this._selectItem(ba);return event.kill();}).bind(this));return ba;};t.prototype._toggleHover=function(u,v){'use strict';j.conditionClass(u.root,'selected',v);};t.prototype._toggleCheck=function(u,v){'use strict';j.conditionShow(u.check,v);};t.prototype._selectItem=function(u){'use strict';var v=this._selection[u.setId];this._selection[u.setId]=u;v&&this._toggleCheck(v,false);this._toggleCheck(u,true);};t.prototype._handleDone=function(u){'use strict';this._ondone(u==l.CONFIRM?this._selection.map((function(v){var w=v.result;i.logDisambiguationClick(w.text,w.type,this._path,w.index,w.uid,this._typeaheadSID);return w;}).bind(this)):null);};t.prototype._handleCancel=function(){'use strict';this._oncancel();};f.exports=t;},null);
__d('FacebarTypeahead',['Arbiter','Typeahead','emptyFunction'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k,l;k=babelHelpers.inherits(m,i);l=k&&k.prototype;function m(n,o,p,q,r,s){'use strict';l.constructor.call(this,n,o,p,q);this.getCore();this.proxyEvents();this.initBehaviors(r||[]);var t=this.core.subscribe('focus',(function(){if(s)s.init(this);this.core.unsubscribe(t);this.data.bootstrap(false);this.core.input.focus();}).bind(this));this.data.bootstrap(true);this.inform('init',this,h.BEHAVIOR_PERSISTENT);h.inform('Facebar/init',this,h.BEHAVIOR_PERSISTENT);}m.prototype.proxyEvents=function(){'use strict';var n,o=[],p=null,q=(function(){while(n=o.shift())this.inform(n[0],n[1]);p=null;}).bind(this);[this.data,this.view,this.core].forEach(function(r){r.subscribe(r.events,(function(s,t){o.push([s,t]);p=p||setTimeout(q,0);}).bind(this));},this);};Object.assign(m.prototype,{init:j});f.exports=m;},null);
__d('StructuredInputDOM',['createArrayFromMixed','CSS','cx','DOM','FacebarGlobalOptions','getElementText'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=function(){return l.graphSearchV2?"_4v1s":"_586o";},o={ENTITY_CLASS:n(),encodeText:function(p){return p.replace(/ /g,'\u00a0');},decodeText:function(p){return p.replace(/\u00a0/g,' ');},createIconNode:function(p){if(p&&typeof p=='object'){var q=k.create('i',{className:p.className,style:p.uri&&{backgroundImage:'url("'+p.uri+'")'}});q.setAttribute('data-select','ignore');return q;}},createTextNode:function(p){return k.create('span',{'data-si':true},o.encodeText(p||""));},createEntityNode:function(p,q){var r=o.encodeText(p.text),s=o.createIconNode(q.icon),t=k.create('span',{},s?[s,r]:r),u=(q.className||'').split(/\s+/);u.push(o.ENTITY_CLASS);u.forEach(i.addClass.bind(i,t));var v={si:true,uid:p.uid,type:p.type,text:r,fulltext:r,group:q.group,select:q.select,icon:JSON.stringify(q.icon||null)};for(var w in v)if(v[w]!=null)t.setAttribute('data-'+w,v[w]);return t;},convertToTextNode:function(p){p.className='';p.setAttribute('data-type','text');p.removeAttribute('data-group');p.removeAttribute('data-select');p.removeAttribute('data-icon');p.removeAttribute('data-uid');for(var q=p.firstChild;q;q=q.nextSibling)if(!k.isTextNode(q))k.remove(q);},isEntityNode:function(p){return k.isElementNode(p)&&i.hasClass(p,o.ENTITY_CLASS);},containsOnlyText:function(p,q){q=h(q);for(var r=p.firstChild;r;r=r.nextSibling)if(!(k.isTextNode(r)||p.nodeName in q))return false;return true;},getText:function(p){return m(p).replace(/ /g,'\u00a0');},getDecodedText:function(p){return o.decodeText(m(p));},getLength:function(p){return m(p).length;},getMarker:function(p,q,r){var s=p.firstChild;while(s){var t=o.getLength(s);if(t>q||!s.nextSibling){if(k.isTextNode(s)||!r){return {node:s,offset:Math.min(q,t)};}else return o.getMarker(s,q);}else q-=t;s=s.nextSibling;}}};f.exports=o;},null);
__d('StructuredInputUtil',['StructuredInputDOM'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(o,p,q){var r=o.substr(0,p).lastIndexOf(q);return r!==-1?r+1:0;}function j(o,p,q){var r=o.indexOf(q,p);return r!==-1?r:o.length;}function k(o,p,q){return (p===0||p===o.length||o.substr(p,q.length)==q);}function l(o,p,q,r){switch(p){case 'none':return q;case 'all':return r?o.length:0;case 'word':if(k(o,q,'\u00a0')){return q;}else if(r){return j(o,q,'\u00a0');}else return i(o,q,'\u00a0');}}function m(o,p){return p&&h.isEntityNode(o)&&!h.isEntityNode(p);}var n={getMarkerAtOffset:function(o,p){var q=o.firstChild,r=0,s=0;while(q){r+=s;s=h.getLength(q);if(r+s>p){break;}else q=q.nextSibling;}return {node:q||o.lastChild,offset:p-r};},validateEntityText:function(o){var p=h.getText(o),q=o.getAttribute('data-fulltext'),r=o.getAttribute('data-group');if(r=='hashtag'){var s=p.match(/#[^\s]+/);q=s&&s[0];}var t=p.indexOf(q),u={prefix:null,entity:null,suffix:null};switch(r){case 'none':u.entity=p;break;case 'hashtag':case 'all':if(t!=-1){u.prefix=p.substr(0,t);u.entity=p.substr(t,q.length);u.suffix=p.substr(t+q.length);}else u.suffix=p;break;case 'word':if(t!=-1){u.prefix=p.substr(0,t);p=p.substr(t);}var v=0,w=0;while(v<q.length){w=j(q,v+1,'\u00a0');if(p.substr(0,w)!=q.substr(0,w)){break;}else v=w;}u.entity=p.substr(0,v)||null;u.suffix=p.substr(v)||null;}return u;},getGrouping:function(o,p){var q=o.getAttribute('data-group'),r=o.getAttribute('data-select');if(p=='select'){return r=='group'?q:'none';}else return q;},snapMarkerToText:function(o,p){var q=o.node;if(h.isEntityNode(q)){var r=o.offset,s=n.getGrouping(q,p);if(s!='none')if(r===0){var t=q.previousSibling;if(m(q,t))return {node:t,offset:h.getLength(t)};}else if(r==h.getLength(q)){var u=q.nextSibling;if(m(q,u))return {node:u,offset:0};}}return o;},nextMarkerBoundary:function(o,p,q){var r=o.node;if(h.isEntityNode(r)&&(!p||o.offset!==0)){var s=n.getGrouping(r,q);if(s!='none')return {node:o.node,offset:l(h.getText(r),s,o.offset,p)};}return o;}};f.exports=n;},null);
__d('StructuredInputCleaner',['DOM','createArrayFromMixed','StructuredInputUtil','StructuredInputDOM','UserAgent_DEPRECATED','getElementText'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();function n(o,p,q){'use strict';this._node=o;this._selection=p;this._wrapText=q;}n.prototype._cleanEntityNode=function(o){'use strict';var p=o.getAttribute('data-text'),q=k.getText(o);o.style.cssText='';if(p==q&&k.containsOnlyText(o,{I:true}))return null;var r=[],s=j.validateEntityText(o),t=k.createIconNode(JSON.parse(o.getAttribute('data-icon')));if(!s.entity&&(s.suffix&&!s.prefix||s.prefix&&!s.suffix)){k.convertToTextNode(o);o.setAttribute('data-text',q);return null;}if(s.prefix)r.push(this._createTextNode(s.prefix));if(s.entity){if(this._selection&&m(o)!==s.entity)this._selection.markDirty(o);h.setContent(o,t?[t,s.entity]:s.entity);o.setAttribute('data-text',s.entity);r.push(o);}if(s.suffix)r.push(this._createTextNode(s.suffix));return r;};n.prototype._removeSpecialNodes=function(){'use strict';var o=i(this._node.getElementsByTagName('script')),p=i(this._node.getElementsByTagName('style'));o.forEach(h.remove);p.forEach(h.remove);};n.prototype._collapseNodes=function(){'use strict';for(var o,p=this._node.firstChild;p;p=o){o=p.nextSibling;if(!h.isTextNode(p)&&!k.isEntityNode(p)&&!k.containsOnlyText(p))for(var q=p.lastChild;q;q=p.lastChild){this._node.insertBefore(q,o);o=q;}}};n.prototype._createTextNode=function(o){'use strict';if(this._wrapText){return k.createTextNode(o);}else return document.createTextNode(o);};n.prototype.replaceNodes=function(o,p){'use strict';if(p==null)return;var q=o.length?o[o.length-1].nextSibling:null;o.forEach(function(r){if(p.indexOf(r)===-1)h.remove(r);},this);p.reverse().forEach(function(r){if(o.indexOf(r)===-1)this._node.insertBefore(r,q);q=r;},this);};n.prototype.clean=function(){'use strict';this._removeSpecialNodes();this._collapseNodes();var o=[],p=(function(){if(o.length){this.replaceNodes(o,this._cleanTextNodes(o));o.length=0;}}).bind(this);i(this._node.childNodes).forEach((function(q){if(k.isEntityNode(q)){this.replaceNodes([q],this._cleanEntityNode(q));p(o);}else o.push(q);}).bind(this));p();if(!this._node.firstChild&&l.firefox())this._node.appendChild(this._createTextNode());};n.prototype.endOnText=function(){'use strict';var o=(function(p,q){if(k.isEntityNode(p))this._node.insertBefore(this._createTextNode(),q?p:null);}).bind(this);o(this._node.firstChild,true);o(this._node.lastChild,false);};Object.assign(n.prototype,{_cleanTextNodes:(function(){var o=function(q){return (q.nodeName==='BR'||q.nodeName==='SPAN'&&p(q));},p=function(q){return q.getAttribute('data-si')&&k.containsOnlyText(q)&&k.getLength(q)>0;};return function(q){if(q.length!=1||!o(q[0])){var r=q.map(k.getText).join('').replace(/\s+/g,' ');return r?[this._createTextNode(r)]:[];}else{q[0].style.cssText='';return;}};})()});f.exports=n;},null);
__d("DOMSelection",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();(function(){var h=this,i={isPreceding:function(o,p){return p.compareDocumentPosition(o)&2;},contains:function(o,p){if(o.compareDocumentPosition!=null){return o.compareDocumentPosition(p)&16;}else return o.contains(p);},isCursorPreceding:function(o,p,q,r){if(o===q)return p<=r;if(i.isText(o)&&i.isText(q))return i.isPreceding(o,q);if(i.isText(o)&&!i.isText(q))return !i.isCursorPreceding(q,r,o,p);if(!i.contains(o,q))return i.isPreceding(o,q);if(o.childNodes.length<=p)return false;if(o.childNodes[p]===q)return 0<=r;return i.isPreceding(o.childNodes[p],q);},isText:function(o){return (o!=null?o.nodeType==3:false);},getChildIndex:function(o){var p=0;while(o=o.previousSibling)p++;return p;}},j=h.Selection=(function(){function o(p){this.win=p;}o.prototype.hasSelection=function(){return o.hasSelection(this.win);};o.prototype.isBidirectional=function(){return o.isBidirectional(this.win);};o.prototype.getOrigin=function(){return o.getOrigin(this.win);};o.prototype.getFocus=function(){return o.getFocus(this.win);};o.prototype.getStart=function(){return o.getStart(this.win);};o.prototype.getEnd=function(){return o.getEnd(this.win);};o.prototype.trySelection=function(p,q,r,s){return o.trySelection(this.win,p,q,r,s);};o.prototype.setSelection=function(p,q,r,s){return o.setSelection(this.win,p,q,r,s);};o.prototype.clearSelection=function(){return o.clearSelection(this.win);};return o;})();function k(){if(h.document.selection&&/MSIE 9\./.test(navigator.userAgent)){return false;}else return !!h.getSelection;}if(k()){j.supported=true;j.hasSelection=function(o){var p;return (p=o.getSelection())&&(p.focusNode!=null)&&(p.anchorNode!=null);};j.isBidirectional=function(o){return true;};j.getOrigin=function(o){var p;if(!((p=o.getSelection())&&(p.anchorNode!=null)))return null;return [p.anchorNode,p.anchorOffset];};j.getFocus=function(o){var p;if(!((p=o.getSelection())&&(p.focusNode!=null)))return null;return [p.focusNode,p.focusOffset];};j.getStart=function(o){var p,q,r,s,t,u;if(!j.hasSelection(o))return null;t=j.getOrigin(o),p=t[0],r=t[1];u=j.getFocus(o),q=u[0],s=u[1];if(i.isCursorPreceding(p,r,q,s))return [p,r];return [q,s];};j.getEnd=function(o){var p,q,r,s,t,u;if(!j.hasSelection(o))return null;t=j.getOrigin(o),p=t[0],r=t[1];u=j.getFocus(o),q=u[0],s=u[1];if(i.isCursorPreceding(p,r,q,s))return [q,s];return [p,r];};var l=function(o,p,q,s,t,u){var v=p.getSelection();if(!v)return;if(t==null)t=q;if(u==null)u=s;if(v.collapse&&v.extend){v.collapse(q,s);v.extend(t,u);}else{r=p.document.createRange();r.setStart(q,s);r.setEnd(t,u);if(o||!j.hasSelection(p)||(r.endContainer===t&&r.endOffset===u&&r.startContainer===q&&r.startOffset===s)){try{v.removeAllRanges();}catch(w){}v.addRange(r);}}};j.setSelection=l.bind(j,true);j.trySelection=l.bind(j,false);j.clearSelection=function(o){try{var q=o.getSelection();if(!q)return;q.removeAllRanges();}catch(p){}};j.getText=function(o){var p=o.getSelection();if(!p)return;return p.toString();};}else if(h.document.selection){var m=function(o,p,q){var r,s,t,u,v;s=o.createElement('a');r=p.duplicate();r.collapse(q);v=r.parentElement();while(true){v.insertBefore(s,s.previousSibling);r.moveToElementText(s);if(!(r.compareEndPoints((q?'StartToStart':'StartToEnd'),p)>0&&(s.previousSibling!=null)))break;}if(r.compareEndPoints((q?'StartToStart':'StartToEnd'),p)===-1&&s.nextSibling){r.setEndPoint((q?'EndToStart':'EndToEnd'),p);t=s.nextSibling;u=r.text.length;}else{t=s.parentNode;u=i.getChildIndex(s);}s.parentNode.removeChild(s);return [t,u];},n=function(o,p,q,r,s){var t,u,v,w,x;x=0;t=i.isText(r)?r:r.childNodes[s];u=i.isText(r)?r.parentNode:r;if(i.isText(r))x=s;w=o.createElement('a');u.insertBefore(w,t||null);v=o.body.createTextRange();v.moveToElementText(w);w.parentNode.removeChild(w);p.setEndPoint((q?'StartToStart':'EndToEnd'),v);return p[q?'moveStart':'moveEnd']('character',x);};j.supported=true;j.hasSelection=function(o){var p;if(!o.document.selection)return false;p=o.document.selection.createRange();return p&&p.parentElement().document===o.document;};j.getStart=function(o){var p;if(!j.hasSelection(o))return null;p=o.document.selection.createRange();return m(o.document,p,true);};j.getEnd=function(o){var p;if(!j.hasSelection(o))return null;p=o.document.selection.createRange();return m(o.document,p,false);};j.isBidirectional=function(o){return false;};j.getOrigin=function(o){return j.getStart(o);};j.getFocus=function(o){return j.getEnd(o);};var l=function(o,p,q,r,s,t){if(s==null)s=q;if(t==null)t=r;var u=p.document.body.createTextRange();n(p.document,u,false,s,t);n(p.document,u,true,q,r);return u.select();};j.setSelection=l.bind(j,true);j.trySelection=l.bind(j,false);j.clearSelection=function(o){return o.document.selection.empty();};j.getText=function(o){if(!j.hasSelection(o))return null;var p=o.document.selection.createRange();return p&&p.text;};}else j.supported=false;}).call(this);f.exports=Selection;},null,{});
__d('StructuredInputSelection',['DOM','DOMSelection','Scroll','Vector','StructuredInputUtil','StructuredInputDOM'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();function n(p){'use strict';var q=p.ownerDocument;this.window=q.defaultView||q.parentWindow;this.root=p;this.selection=false;this.start=new o(this,[]);this.end=new o(this,[]);this.update();}n.prototype.isSupported=function(){'use strict';return !!(i&&i.hasSelection);};n.prototype.update=function(){'use strict';this.selection=false;if(this.isSupported()&&this.root==document.activeElement)if(i.hasSelection(this.window)){var p=i.getStart(this.window),q=i.getEnd(this.window),r=i.getFocus(this.window);this.start=this.makeMarker(p);this.end=this.makeMarker(q);this.backward=p[0]==r[0]&&p[1]==r[1];this.selection=this.start.node&&this.end.node;}};n.prototype.makeMarker=function(p){'use strict';if(p[0]===this.root){return new o(this,[this.root.childNodes[p[1]],0]);}else return new o(this,p);};n.prototype.getFocus=function(){'use strict';return this.backward?this.start:this.end;};n.prototype.getOrigin=function(){'use strict';return this.backward?this.end:this.start;};n.prototype.move=function(p){'use strict';if(this.selection){this.start.move(p);this.start.snap();this.end.setPosition(this.start);return this.apply();}};n.prototype.expand=function(p){'use strict';if(this.selection){if(i.isBidirectional()){this.start.move(!p);this.start.snap();this.end.move(p);this.end.snap();}return this.apply();}};n.prototype.getText=function(){'use strict';if(this.selection&&this.isSupported()){var p=i.getText(this.window);return p;}};n.prototype.getOffset=function(){'use strict';if(this.selection)return this.start.rootOffset;};n.prototype.getLength=function(){'use strict';return (this.getText()||"").length;};n.prototype.setPosition=function(p,q){'use strict';this.backward=false;this.selection=true;this.start.setPosition(l.getMarkerAtOffset(this.root,p));this.start.snap();if(q>0){this.end.setPosition(l.getMarkerAtOffset(this.root,p+q));this.end.snap();}else this.end.setPosition(this.start);return this.apply();};n.prototype.hasRange=function(){'use strict';return this.selection&&(this.start.node!=this.end.node||this.start.offset!=this.end.offset);};n.prototype.scrollToFocus=function(){'use strict';var p=5,q=this.getFocus();if(q.node){var r=k.getElementDimensions(this.root).x,s=j.getLeft(this.root),t=q.node.offsetLeft+q.node.offsetWidth;if(t-s<p){j.setLeft(this.root,t-p);}else if(t-s>r-p)j.setLeft(this.root,t-r+p);}};n.prototype.apply=function(){'use strict';if(this.start.hasChanged()||this.end.hasChanged()){var p=this.getOrigin().getMarker(true),q=this.getFocus().getMarker(true);this.selection=this.selection&&p&&p.node&&q&&q.node;if(this.selection&&this.isSupported()){this.start.changed=false;this.end.changed=false;i.trySelection(this.window,p.node,p.offset,q.node,q.offset);return true;}}};n.prototype.markDirty=function(p){'use strict';if(h.contains(p,this.start.node,p))this.start.changed=true;if(h.contains(p,this.end.node,p))this.end.changed=true;};function o(p,q){'use strict';this.selection=p;this.node=q[0];this.offset=q[1];this.rootOffset=this.getRootOffset(q[0],q[1]);this.sibling=this.node&&this.node.previousSibling;this.changed=false;}o.prototype.hasChanged=function(){'use strict';return this.changed||!this.isNodeValid();};o.prototype.isNodeValid=function(){'use strict';if(m.getLength(this.node)>this.offset){var p=this.node;while(p=p.parentNode)if(p==this.selection.root)return true;}};o.prototype.getMarker=function(p){'use strict';if(this.isNodeValid()&&(p&&!this.node.firstChild||!p&&this.node.parentNode==this.selection.root)){return this;}else return m.getMarker(this.selection.root,this.rootOffset,p);};o.prototype.move=function(p){'use strict';this.node&&this.setPosition(l.nextMarkerBoundary(this.getMarker(false),p,'select'));};o.prototype.snap=function(){'use strict';this.node&&this.setPosition(l.snapMarkerToText(this.getMarker(false),'select'));};o.prototype.setPosition=function(p){'use strict';if(p.offset!=this.offset||p.node!=this.node){this.changed=true;this.node=p.node;this.offset=p.offset;this.rootOffset=this.getRootOffset(this.node,this.offset);}};o.prototype.getRootOffset=function(p,q){'use strict';var r=0,s=5;while(p&&r++<s)if(p===this.selection.root){return q;}else{var t=p;while(t=t.previousSibling)q+=m.getLength(t);p=p.parentNode;}};f.exports=n;},null);
__d('StructuredInput',['Arbiter','ArbiterMixin','CSS','DOM','DataStore','Event','Input','InputSelection','JSLogger','Keys','Locale','Parent','Scroll','StructuredInputCleaner','StructuredInputDOM','StructuredInputSelection','StructuredInputUtil','Style','UserAgent_DEPRECATED','createArrayFromMixed','createObjectFrom','cx','csx','emptyFunction','fbt','getActiveElement','setTimeoutAcrossTransitions','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia){if(c.__markCompiled)c.__markCompiled();var ja,ka,la=229,ma=ba([q.UP,q.DOWN,q.LEFT,q.RIGHT,q.HOME,q.END]),na=ba([q.BACKSPACE,q.DELETE]),oa=ba([q.SPACE,q.RETURN]),pa=ba('IUB'.split('').map(function(ua){return ua.charCodeAt(0);})),qa=z.firefox(),ra=z.ie(),sa=z.webkit();ja=babelHelpers.inherits(ta,ia(i));ka=ja&&ja.prototype;function ta(ua){'use strict';ka.constructor.call(this);l.set(ua,'StructuredInput',this);this._root=ua;this._richInput=k.find(ua,"._586i");this._textInput=k.find(ua,"._586f");this._placeholderText=k.scry(ua,"._586j")[0];this._hintText=k.find(ua,"._586k");this._contentWidth=null;this._richWidth=null;this._hintNodes=[];h.subscribe(p.DUMP_EVENT,(function(va,wa){wa.structuredInputState={initInputsFinished:!!this._initInputsFinished,initEventsFinished:!!this._initEventsFinished,cleanInputPreTogglesFinished:!!this._cleanInputPreTogglesFinished,cleanInputFinished:!!this._cleanInputFinished,elements:{richInput:!!this._richInput,textInput:!!this._textInput,placeholderText:!!this._placeholderText,hintText:!!this._hintText}};}).bind(this));this.init();}ta.prototype.init=function(){'use strict';this.init=ea;this._initSelection();this._initCleaner();this._initInputs();this._initInputsFinished=true;this._initEvents();this._initEventsFinished=true;this._scheduledCleanInput=false;this._richChanged=false;this._textChanged=false;this._selectionChanged=false;this._selectionIgnore=false;this._imeMode=false;this.cleanInput();this.inform('init',null,h.BEHAVIOR_PERSISTENT);};ta.prototype._initInputs=function(){'use strict';this._richInput.contentEditable=true;this._richInput.spellcheck=false;this._richInput.tabIndex=0;this._richInput.setAttribute('aria-label',fa._("Search Facebook"));this._textInput.tabIndex=-1;this._multiline=this._textInput.nodeName=='TEXTAREA';if(!j.shown(this._richInput)){var ua=o.get(this._textInput),va=ga()===this._textInput;k.setContent(this._richInput,v.encodeText(n.getValue(this._textInput)));j.hide(this._textInput);j.show(this._richInput);this.cleanInput();if(va){this._richInput.focus();this.setSelection({offset:ua.start,length:ua.end-ua.start});}}this.togglePlaceholder();this._toggleHint();};ta.prototype._initEvents=function(){'use strict';var ua=null,va=false,wa=(function(){this._richChanged=true;va||this.scheduleCleanInput(true);}).bind(this),xa=(function(){this._textChanged=true;va||this.scheduleCleanInput(false);}).bind(this),ya=(function(){this._selectionChanged=true;this.scheduleCleanInput(false);}).bind(this),za=(function(){this._imeMode=true;this._placeholderText&&j.hide(this._placeholderText);j.hide(this._hintText);}).bind(this),ab=(function(){this._imeMode=false;this._richChanged=true;this.cleanInput();}).bind(this);m.listen(this._richInput,'keydown',(function(bb){ua=bb.keyCode;if(bb.ctrlKey&&bb.keyCode in pa){return bb.kill();}else if(bb.keyCode in ma){ya();}else if(bb.keyCode===q.BACKSPACE&&this._deleteTrailingChunk()){this._richChanged=true;this.cleanInput();return bb.kill();}else if(bb.keyCode in na){wa();}else if(bb.keyCode==la)za();}).bind(this));m.listen(this._richInput,'keypress',(function(bb){if(bb.keyCode==q.RETURN){this._multiline&&this._insertText("\n");return bb.kill();}else if(!this._selectionChanged&&this._selectionIsText()){xa();}else wa();}).bind(this));if(!va){m.listen(this._richInput,'keyup',(function(bb){if((this._imeMode||bb.keyCode!=ua)&&bb.keyCode in oa){ab();return bb.kill();}else if(this._imeMode){this._textChanged=true;this.cleanInput();}}).bind(this));if(qa)m.listen(this._richInput,'input',(function(){this._textChanged=true;this.cleanInput();}).bind(this));}else{m.listen(this._richInput,'compositionstart',za);m.listen(this._richInput,'compositionend',function(){setTimeout(ab,0);});m.listen(this._richInput,'input',(function(){this._textChanged=true;if(!this._imeMode)if(!this._richChanged){this.cleanInput();}else this.scheduleCleanInput();}).bind(this));}m.listen(document,'selectionchange',(function(){if(this._selectionIgnore){this._selectionIgnore=false;}else this._selectionChanged=true;}).bind(this));m.listen(this._richInput,'mousedown',(function(){this._selectionChanged=true;this._selectionLength=0;this._selectionOffset=0;}).bind(this));m.listen(this._richInput,'mouseup',(function(){this._selectionChanged=true;this.scheduleCleanInput();}).bind(this));m.listen(this._richInput,'cut',(function(){this._richChanged=true;this.scheduleCleanInput(false);}).bind(this));m.listen(this._richInput,'paste',(function(bb){this._richChanged=true;this.scheduleCleanInput(true);}).bind(this));m.listen(this._richInput,'drop',(function(bb){this.focus();this.selectAll();this._insertClipboard(bb&&bb.dataTransfer);return bb.kill();}).bind(this));m.listen(this._richInput,'dragover',function(bb){bb.dataTransfer.dropEffect='move';bb.dataTransfer.effectAllowed='move';return bb.kill();});m.listen(this._richInput,'focus',(function(bb){this._toggleHint();this.inform('focus');}).bind(this));m.listen(this._richInput,'blur',(function(bb){j.hide(this._hintText);this._imeMode=false;this._richChanged=true;this.scheduleCleanInput(false);this.inform('blur');}).bind(this));};ta.prototype._initCleaner=function(){'use strict';this._cleaner=new u(this._richInput,this._selection,true);};ta.prototype._initSelection=function(){'use strict';this._selection=new w(this._richInput);this._selectionLength=0;this._selectionOffset=0;};ta.prototype._insertClipboard=function(ua){'use strict';if(ua&&typeof ua.getData==='function'){var va=ua.getData('Text');this._insertText(va);}};ta.prototype._deleteTrailingChunk=function(ua){'use strict';var va=this.getSelection();if(va.length>0||va.offset===0)return false;var wa=this.getSelection().offset-1,xa=x.getMarkerAtOffset(this._richInput,wa);if(xa&&v.isEntityNode(xa.node)&&x.getGrouping(xa.node,'select')!=='none'){k.remove(xa.node);return true;}return false;};ta.prototype._selectionIsText=function(){'use strict';var ua=this._selection.start.node,va=this._selection.end.node;return ua&&ua===va&&!v.isEntityNode(ua)&&!v.isEntityNode(ua.parentNode);};ta.prototype._insertText=function(ua){'use strict';if(ua){var va=k.create('div',{},ua);return this._insertNodes(va);}};ta.prototype._insertHTML=function(ua){'use strict';if(ua){var va=k.create('div'),wa=new u(va,null,false);va.innerHTML=ua;wa.clean();return this._insertNodes(va);}};ta.prototype._insertNodes=function(ua){'use strict';if(document.selection){document.selection.createRange().pasteHTML(ua.innerHTML);}else document.execCommand('insertHTML',false,ua.innerHTML);this._richChanged=true;this.cleanInput();};ta.prototype.togglePlaceholder=function(ua){'use strict';if(!this._placeholderText)return;var va=v.getLength(this._richInput)===0;if(ua&&va){j.show(this._placeholderText);}else j.conditionShow(this._placeholderText,va&&!this._imeMode);};ta.prototype._toggleHint=function(){'use strict';var ua=aa(this._hintNodes),va=null,wa='',xa=v.getText(this._richInput).toLowerCase();if(!this.hasFocus())return;if(this._contentOverflows()){j.hide(this._hintText);return;}while(ua.length&&wa.length<xa.length){va=ua.shift();wa+=v.getText(va);}if(xa.length&&wa.substr(0,xa.length).toLowerCase()==xa.toLowerCase()){k.setContent(this._hintText,aa(this._richInput.cloneNode(true).childNodes).filter(function(za){return za.tagName!=='BR';}));var ya=v.createTextNode(wa.substr(xa.length));ua.unshift(ya);k.appendContent(this._hintText,k.create('span',{className:"_586h"},ua));j.show(this._hintText);j.hide(this._placeholderText);}else j.hide(this._hintText);};ta.prototype._contentOverflows=function(){'use strict';if(this._richWidth===null)this._richWidth=this._richInput.clientWidth;if(this._contentWidth===null){var ua=this._richInput.lastChild;this._contentWidth=k.isElementNode(ua)?ua.offsetLeft+ua.offsetWidth:0;}return this._contentWidth>this._richWidth;};ta.prototype._forceTop=function(){'use strict';if(!this._multiline)t.setTop(this._richInput,0);t.setTop(this._root,0);};ta.prototype._createStructureNodes=function(ua){'use strict';return ua.map((function(va){return va.uid||va.type&&va.type!='text'?v.createEntityNode(va,va.display||{}):v.createTextNode(va.text);}).bind(this));};ta.prototype._suppressInput=function(){'use strict';if(qa||ra){if(this._richClean)return;this._richClean=this._richInput.cloneNode(true);this._richClean.contentEditable=false;this._root.insertBefore(this._richClean,this._richInput.nextSibling);t.setLeft(this._richClean,t.getLeft(this._richInput));y.set(this._richInput,'padding',0);y.set(this._richInput,'height',0);}};ta.prototype._revealInput=function(){'use strict';if(!this._richClean)return;y.set(this._richInput,'height','');y.set(this._richInput,'padding','');this._root.removeChild(this._richClean);this.focus();this._richClean=null;};ta.prototype._cleanInput=function(){'use strict';var ua;if(this._textChanged&&!this._richChanged){this._selection.update();ua='change';}else if(this._richChanged||this._selectionChanged){this._selection.update();if(this._richChanged){this._contentWidth=null;this._cleaner.clean();this._cleaner.endOnText();this._selection.apply();ua='change';}if(this._selectionChanged){this._cleanSelection();if(this._selectionLength||!this._richChanged)ua='select';}}this._revealInput();this._forceTop();this._cleanInputPreTogglesFinished=true;if(this._richChanged||this._textChanged){this.togglePlaceholder();this._toggleHint();}this._selectionIgnore=true;this._selectionChanged=false;this._richChanged=false;this._textChanged=false;this._cleanInputFinished=true;ua&&this.inform(ua);};ta.prototype._cleanSelection=function(){'use strict';var ua=this._selection.getLength(),va=this._selection.getOffset();if(ua){this._selection.expand(ua>=this._selectionLength);ua=this._selection.getLength();va=this._selection.getOffset();}this._selectionLength=ua;this._selectionOffset=va;};ta.prototype.cleanInput=function(){'use strict';this._scheduledCleanInput||this._cleanInput();};ta.prototype.scheduleCleanInput=function(ua){'use strict';ua&&this._suppressInput();if(!this._scheduledCleanInput){this._scheduledCleanInput=true;ha((function(){this._cleanInput();this._scheduledCleanInput=false;}).bind(this),0);}};ta.prototype.setEnabled=function(ua){'use strict';this._textInput.disabled=!ua;this._richInput.contentEditable=ua;};ta.prototype.getRoot=function(){'use strict';return this._root;};ta.prototype.getRichInput=function(){'use strict';return this._richInput;};ta.prototype.getEnabled=function(){'use strict';return !this._textInput.disabled;};ta.prototype.getText=function(){'use strict';return v.getDecodedText(this._richInput);};ta.prototype.setText=function(ua){'use strict';k.setContent(this._richInput,v.createTextNode(ua));this._richChanged=false;this._selectionChanged=false;this.inform('change');};ta.prototype.setHint=function(ua){'use strict';this._hintNodes=this._createStructureNodes(ua);this._toggleHint();};ta.prototype.getStructure=function(){'use strict';var ua=[];aa(this._richInput.childNodes).forEach((function(va){var wa=!k.isTextNode(va),xa=v.getDecodedText(va);xa.length&&ua.push({text:xa,uid:wa?va.getAttribute('data-uid'):null,type:wa&&va.getAttribute('data-type')||'text'});}).bind(this));return ua;};ta.prototype.setStructure=function(ua){'use strict';k.setContent(this._richInput,this._createStructureNodes(ua));this._cleaner.clean();this._cleaner.endOnText();this.togglePlaceholder();this._toggleHint();this._richChanged=false;this._selectionChanged=false;this.inform('change');};ta.prototype.getContentDimensions=function(){'use strict';var ua=this._richInput.lastChild;return {width:ua?ua.offsetLeft+ua.offsetWidth:0,height:ua?ua.offsetTop+ua.offsetHeight:0};};ta.prototype.getSelection=function(){'use strict';if(this._selection)return {offset:this._selection.getOffset(),length:this._selection.getLength()};};ta.prototype.setSelection=function(ua){'use strict';if(this.hasFocus()&&this._selection){this._selection.update();this._selection.setPosition(ua.offset,ua.length);this._selection.scrollToFocus();this._selectionChanged=false;this.inform('select');}};ta.prototype.moveSelectionToEnd=function(){'use strict';this.setSelection({length:0,offset:v.getLength(this._richInput)});};ta.prototype.isSelectionAtEnd=function(){'use strict';var ua=this.getSelection().offset,va=v.getLength(this._richInput);return ua>=va;};ta.prototype.selectAll=function(){'use strict';this.setSelection({offset:0,length:v.getLength(this._richInput)});};ta.prototype.hasFocus=function(){'use strict';return k.contains(this._root,document.activeElement);};ta.prototype.focus=function(){'use strict';this._richInput.focus();};ta.prototype.blur=function(){'use strict';var ua={position:'absolute',top:0,width:'1px',height:'1px'};if(r.isRTL()){ua.right='-100px';}else ua.left='-100px';var va=k.create('input',{type:'text',tabIndex:-1,style:ua});k.appendContent(this._root,va);var wa=function(){if(this.hasFocus()||sa&&document.activeElement===document.body){va.focus();va.blur();}};this.blur=wa;this.blur();};ta.getInstance=function(ua){var va=s.byClass(ua,"_586g");if(!va)throw new Error('No DOMElement structured input found using '+ua);return l.get(va,'StructuredInput')||new ta(va);};f.exports=ta;},null);
__d('FacebarTypeaheadInput',['ArbiterMixin','csx','DOM','FacebarStructuredText','StructuredInput','Vector','Locale','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p,q,r={text:{className:"text",group:"all",select:"none"},ent:{className:"entity",group:"all",select:"group"},'ent:hashtag_exact':{className:"entity",group:"hashtag",select:"none"}};function s(u){return Object.assign(u.toStruct(),{display:r[u.getType()]||r[u.getTypePart(0)]});}p=babelHelpers.inherits(t,o(h));q=p&&p.prototype;function t(u){'use strict';q.constructor.call(this);this.root=u;this.input=l.getInstance(u);this.value=null;this.selection={offset:0,length:0};this.resetOnChange=true;this.initEvents();}t.prototype.initEvents=function(){'use strict';var u=(function(v,w){this.inform(v,w);}).bind(this);this.input.subscribe('blur',u);this.input.subscribe('focus',u);this.input.subscribe('change',(function(v,w){if(this.resetOnChange)this.value=null;this.inform('change',w);}).bind(this));};t.prototype.togglePlaceholder=function(u){'use strict';return this.input.togglePlaceholder(u);};t.prototype.focus=function(){'use strict';this.input.focus();};t.prototype.blur=function(){'use strict';this.input.blur();};t.prototype.getElement=function(){'use strict';return this.root;};t.prototype.getRawPlaceholderElement=function(){'use strict';return j.find(this.root,"._586j");};t.prototype.getRawInputElement=function(){'use strict';return j.scry(this.root,"._586i")[0];};t.prototype.getValue=function(){'use strict';if(this.value===null)this.value=k.fromStruct(this.input.getStructure());return this.value;};t.prototype.getLength=function(){'use strict';return this.getValue().getLength();};t.prototype.resetPlaceholder=function(){'use strict';this.input.resetPlaceholder();};t.prototype.setValue=function(u,v){'use strict';this.value=u;this.resetOnChange=!!v;var w=u.toArray().map(s);this.input.setStructure(w);this.input.setSelection({offset:u.getLength(),length:0});this.resetOnChange=true;};t.prototype.storeSelection=function(){'use strict';this.selection=this.input.getSelection();};t.prototype.restoreSelection=function(){'use strict';if(this.selection)this.input.setSelection(this.selection);};t.prototype.clearSelection=function(){'use strict';this.input.setSelection({offset:this.getLength(),length:0});};t.prototype.setHint=function(u){'use strict';var v=u&&!u.hasRTL()&&!n.isRTL()?u.toArray().map(s):[];this.input.setHint(v);};t.prototype.isSelectionAtEnd=function(){'use strict';return this.input.isSelectionAtEnd();};t.prototype.selectInput=function(u){'use strict';this.input.setSelection({offset:u||0,length:this.getLength()});};t.prototype.getEndOffset=function(){'use strict';var u=m.getElementDimensions(this.root),v=this.input.getContentDimensions();return Math.min(u.x,v.width);};Object.assign(t.prototype,{events:['change','focus','blur']});f.exports=t;},null);
__d('FacebarTypeaheadWebSearch',['FacebarStructuredFragment','FacebarStructuredText'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=new h({type:'ent:websuggestion',text:'Web Search: ',uid:null}),k=j.getText().toLowerCase().trim();function l(o,p){if(!o||o.type!=='websuggestion')return;var q=p.getValue().toArray();q.forEach(function(r){if(r.isType('ent')&&!r.isType('ent','user')&&r.getUID())if(o.extra_uri_params){o.extra_uri_params.qh=r.getUID();return;}});}function m(o){return o.getType()===j.getType();}function n(o){'use strict';this._core=o.getCore();this._view=o.getView();this._input=this._core.input;this._isEnabled=false;}n.prototype.enable=function(){'use strict';this._isEnabled=true;this.changeListener=this._input.subscribe('change',this._changeWebSearch.bind(this));this.lockListener=this._input.subscribe('shortcut',this._lockWebSearch.bind(this));this.beforeSelectListener=this._view.subscribe('beforeSelect',this._beforeSelect.bind(this));this.beforeRenderListener=this._view.subscribe('beforeRender',this._beforeRender.bind(this));};n.prototype._changeWebSearch=function(){'use strict';var o=this._input.getValue(),p=o.toArray(),q=p[0];if(q&&q.getType()==='text')if(q.getText().toLowerCase().startsWith(k)){p.splice(0,1,j,new h({text:q.getText().substr(k.length).replace(/^ /,'')}));this._replaceFragments(p);}else if(p.length>1&&p.some(m)){var r='';p.forEach(function(s){if(m(s))return;r+=s.getText();});this._input.storeSelection();this._input.setValue(i.fromString(r));this._input.restoreSelection();}};n.prototype._replaceFragments=function(o){'use strict';this._input.storeSelection();this._input.setValue(new i(o));this._input.restoreSelection();};n.prototype._beforeSelect=function(o,p){'use strict';l(p.selected,this._input);return true;};n.prototype._beforeRender=function(o,p){'use strict';var q=this._input.getValue().toArray()[0],r=q&&m(q);p.results.forEach(function(s){if(s.type==='websuggestion')s.isLockedWebSearchMode=r;});return true;};n.prototype._lockWebSearch=function(o,p){'use strict';if(p.shift){var q=this._input.getValue().toArray()[0];if(!q||!m(q))this._input.setValue(new i([j]));}};n.prototype.disable=function(){'use strict';this.beforeSelectListener.unsubscribe();this.changeListener.unsubscribe();this.lockListener.unsubscribe();this.beforeRenderListener.unsubscribe();this._isEnabled=false;};n.addPrefix=function(o){'use strict';var p=m(o.getFragment(0))||o.getFragment(0).getText().toLowerCase().startsWith(k);if(!p){var q=[j].concat(o.toArray());return new i(q);}else return o;};f.exports=n;},null);
__d('FacebarTypeaheadCore',['Animation','Arbiter','ArbiterMixin','Base64','DOM','Event','FacebarGlobalOptions','FacebarJSConstants','FacebarKeywordSearchUtils','FacebarResultStoreUtils','FacebarStructuredText','FacebarTypeaheadInput','FacebarTypeaheadWebSearch','Keys','KeywordsSearchResultConfig','Parent','Style','URI','arrayContains','cx','csx','getActiveElement','invariant','mixin','setTimeout'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa){if(c.__markCompiled)c.__markCompiled();var ga,ha;ga=babelHelpers.inherits(ia,ea(j));ha=ga&&ga.prototype;function ia(ja){'use strict';ha.constructor.call(this);Object.assign(this,ja);}ia.prototype.init=function(ja,ka,la){'use strict';if(window.getSelection===null)throw new Error('Facebar: window.getSelection is null!');this.init=function(){};this.data=ja;this.view=ka;this.root=la;this.facebarRoot=w.byClass(la,"_585-");this.windowFocused=true;this.isFocused=false;this.hoverAnimation=null;this.stickyQuery=null;this.settedQuery=null;this.selectedQuery=null;this.currentQuery=null;this.initSubcomponents();this.initEvents();this.checkValue();};ia.prototype.initSubcomponents=function(){'use strict';var ja=l.find(this.root,"._5861");this.input=new s(ja);this.view.setInputElement(this.input.getRawInputElement());};ia.prototype.initEvents=function(){'use strict';m.listen(this.root,'keydown',this.keydown.bind(this));m.listen(this.root,'keyup',this.keyup.bind(this));m.listen(this.root.parentNode,'mousedown',this.mousedown.bind(this));m.listen(this.view.getElement(),'mousedown',this.mousedown.bind(this));m.listen(window,'focus',this.focusWindow.bind(this));m.listen(window,'blur',this.blurWindow.bind(this));this.view.subscribe('select',this.selectView.bind(this));this.view.subscribe('highlight',this.highlightView.bind(this));this.view.subscribe('render',this.highlightView.bind(this));this.view.subscribe('hideHelp',this.performQuery.bind(this));this.input.subscribe('focus',this.focusInput.bind(this));this.input.subscribe('blur',this.blurInput.bind(this));this.input.subscribe('change',this.changeInput.bind(this));this.data.subscribe('activity',this.typeaheadActivity.bind(this));this.data.subscribe('respond',this.completeData.bind(this));this.data.subscribe('nullstateReady',this.performQueryIfVisible.bind(this));i.subscribe('FacebarTypeahead.clearRecentSearches',(function(){return this.clearRecentSearches();}).bind(this));i.subscribe('FacebarTypeahead.focus',(function(){this.input.focus();fa((function(){this.input.clearSelection();}).bind(this),0);}).bind(this));fa(this.initFocus.bind(this),0);};ia.prototype.initFocus=function(){'use strict';if(!this.lazyFocused&&l.contains(this.input.root,ca())){this.lazyFocused=true;this.isFocused=true;this._newSession();this.inform('focus',{catchup:true});this.open(true);}};ia.prototype.setStartTime=function(ja){'use strict';this.inform('focusStartTime',{time:ja});};ia.prototype.cleanQuery=function(ja){'use strict';ja=babelHelpers._extends({},ja)||{};if(!ja.structure)ja.structure=new r();if(!n.allowGrammar||o.nonGrammarTypes[ja.type])ja.structure=r.fromString(ja.structure.toString());!(ja.structure instanceof r)?da(0):undefined;if(ja.type=='websuggestion'&&n.allowGrammar&&n.webSearchLockedInMode)ja.structure=t.addPrefix(ja.structure);return ja;};ia.prototype._unlockQuery=function(){'use strict';var ja=this.input.getValue();if(ja.hasType('ent')&&ja.trim().getCount()===1){this.input.storeSelection();this.input.setValue(r.fromString(ja.toString()));this.input.restoreSelection();}};ia.prototype.setPageQuery=function(ja){'use strict';ja=this.cleanQuery(ja);var ka=this.input.getValue(),la=ja.structure,ma=!la.isEmptyOrWhitespace()&&(ka.isEmptyOrWhitespace()||!ka.matches(la));return this.selectQuery(ja,ma);};ia.prototype.selectQuery=function(ja,ka){'use strict';ka=ka!==false;ja=this.cleanQuery(ja);if(ka||!this.selectedQuery){if(ka||this.getValue().isEmptyOrWhitespace())this.setQuery(ja);this.selectedQuery=ja;}return ja;};ia.prototype.completeSelection=function(){'use strict';var ja=this.view.getSelection();if(ja&&!ja.search){this.data.saveResult(ja);ja.structure=ja.structure.pad();this.setQuery(ja);return true;}};ia.prototype.setQuery=function(ja,ka){'use strict';ja=this.cleanQuery(ja);if(ja.structure.hasType('blank'))ja.structure=new r(ja.structure.toArray().filter(function(la){return la.getType()!='blank';}));this.input.setValue(ja.structure);this.settedQuery=ja;this.stickyQuery=ka===false?this.stickyQuery:ja;this.checkValue();};ia.prototype.checkValue=function(){'use strict';if(this.value&&this.value.getHash()==this.input.getValue().getHash())return;this.checkBlockedSearch();this.performQueryIfVisible();};ia.prototype.checkBlockedSearch=function(){'use strict';var ja=this.input.getValue().toString().toLocaleLowerCase();if(!this.data.blockees||!this.data.blockees.hasOwnProperty(ja)){this.view.hideBlockNotification();}else this.view.showBlockNotification(this.data.blockees[ja]);};ia.prototype.isNullState=function(){'use strict';return this.input.getValue().getHash()==='';};ia.prototype.performQueryIfVisible=function(){'use strict';if(!this.view.visible)return;this.value=this.nextQuery=this.getValue();this.performQuery();};ia.prototype.performQuery=function(){'use strict';if(n.graphSearchV2)this.view.resetIndex();this.data.query(this.nextQuery);this.currentQuery=this.nextQuery;};ia.prototype.requery=function(){'use strict';if(this.currentQuery)this.data.query(this.currentQuery);};ia.prototype.executeQuery=function(ja){'use strict';ja=this.cleanQuery(ja);var ka=this.inform('execute',ja),la=this.getSessionID();this.close();if(n.allowGrammar){this.selectQuery(ja);}else this.selectQuery();if(n.hasRecentSearchNullState&&ja.type!=='shortcut')this.data.resultStore.addRecentEntryToNullState(ja);if(!ka)this._navigateToQuery(ja,la);};ia.prototype.getSearchType=function(){'use strict';return 'facebar';};ia.prototype._newSession=function(){'use strict';if(this._sessionID!=null)return;this._sessionID=Math.random().toString();this.inform('session',this._sessionID,i.BEHAVIOR_STATE);};ia.prototype._closeSession=function(){'use strict';this._sessionID=null;this.inform('session',null,i.BEHAVIOR_STATE);};ia.prototype.getSessionID=function(){'use strict';return this._sessionID;};ia.prototype._navigateToQuery=function(ja,ka){'use strict';var la=this.data.facebarConfig;if(ja.uri){ja.uri.addQueryData(ja.extra_uri_params);ja.uri.addQueryData({ref:'br_tf'});if(ja.structure&&(ja.type=='websuggestion'||ja.type==v.result_type||ja.type=='grammar'&&(!la||String(ja.uri.getPath()).startsWith(la.search_path)))){var ma=this.data.getRawStructure(ja.structure).text_form,na=k.encode(encodeURIComponent(ma)).replace(/\=+$/,''),oa={sid:ka,qs:na,gv:this.data.getQueryData().grammar_version},pa=k.encode(JSON.stringify(oa)).replace(/\=+$/,'');ja.uri.addQueryData({ref:pa,bs:ja.alternateSemantic});}ja.uri.go();return;}};ia.prototype.reset=function(){'use strict';this.selectQuery();this.inform('reset');};ia.prototype.animateInputValue=function(ja,ka,la){'use strict';this.hoverAnimation&&this.hoverAnimation.stop();var ma=new h(ka).from('opacity',1).to('opacity',0).duration(150).ondone((function(){this.input.setValue(la);this.hoverAnimation=na.go();}).bind(this)),na=new h(ja).from('opacity',0).to('opacity',1).duration(150).ondone((function(){this.hoverAnimation=null;x.set(ka,'opacity','');x.set(ja,'opacity','');}).bind(this));x.set(ja,'opacity',0);this.hoverAnimation=ma.go();};ia.prototype.open=function(ja){'use strict';this.inform('open');this.view.show(this.facebarRoot.offsetWidth);this.input.focus({catchup:ja});this.checkValue();if(!this.isFocused){this.isFocused=true;this._newSession();this.inform('focus');}};ia.prototype.close=function(){'use strict';this._closeSession();if(this.inform('close')===false)return;if((!this.value||this.value.isEmptyOrWhitespace())&&this.selectedQuery){this.input.setValue(this.selectedQuery.structure);}else if(this.stickyQuery)this.input.setValue(this.stickyQuery.structure);this.input.blur();this.view.hide();this.view.setAutoSelect(false);this.inform('session',null,i.BEHAVIOR_STATE);if(this.isFocused){this.isFocused=false;fa(this.inform.bind(this,'blur'),0);}};ia.prototype.getElement=function(){'use strict';return this.root;};ia.prototype.getValue=function(){'use strict';return this.input.getValue();};ia.prototype.getText=function(){'use strict';return this.getValue().toString();};ia.prototype.submitQuery=function(ja){'use strict';if(n.graphSearchV2&&this.view.index<0){var ka=this.input.getValue(),la=this.data.getRawStructure(ka);if(la&&!la.is_empty){var ma=!la.raw_text?q.getRawTextFromStructured(ka.toArray()):la.raw_text,na=p.makeFacebarEntry(ma);na.position=ja;this.inform('magSearch',na);this.executeQuery(na);}}else this.view.select();};ia.prototype.keydown=function(event){'use strict';var ja=true,ka=m.getKeyCode(event);switch(ka){case u.ESC:this.close();break;case u.RIGHT:if(!n.disableLockingEntitiesOnRightArrow){ja=this.input.isSelectionAtEnd()&&this.completeSelection();}else ja=false;break;case u.TAB:var la=this.cleanQuery(this.view.getSelection()),ma=la.structure.hasType('blank');if(event.getModifiers().shift||!this.completeSelection()&&!this.loading){this.view.setAutoSelect(false);this.view.hide();ja=false;}else if(!ma&&!n.graphSearchV2)this.tabQueued=true;break;case u.UP:this.view.prev();break;case u.DOWN:this.view.next();break;case u.RETURN:var na=-2;this.submitQuery(na);break;case u.PAGE_UP:this.view.first();break;case 222:var oa=this.input.value.trim();if(!event.getModifiers().shift&&oa.endsOnType('ent'))this.input.setValue(oa);ja=false;break;default:var pa=ka<=46&&ka!==8&&ka!==32,qa=ka>=112&&ka<=126,ra=ka===144||ka===145,sa=ka===91||ka===92||ka===93||ka===224;if(!pa&&!qa&&!ra&&!event.metaKey&&!sa){this.data.setSingleState(false);if(n.autohighlight)this.view.setAutoSelect(true);}this.stickyQuery=null;ja=false;break;}this.input.storeSelection();if(ja)return event.kill();};ia.prototype.keyup=function(event){'use strict';var ja=m.getKeyCode(event),ka=ja<=46&&ja!==8&&ja!==32,la=ja>=112&&ja<=126,ma=ja===144||ja===145,na=ja===91||ja===92||ja===93||ja===224;if(!ka&&!la&&!ma&&!event.metaKey&&!na)if(n.unlockTextOnKeypress)this._unlockQuery();};ia.prototype.mousedown=function(event){'use strict';if(n.autohighlight)this.view.setAutoSelect(true);this.input.storeSelection();if(w.byClass(event.target,"_50c9"))event.preventDefault();};ia.prototype.focusWindow=function(){'use strict';this.windowFocused=true;};ia.prototype.blurWindow=function(){'use strict';this.windowFocused=false;};ia.prototype.selectView=function(ja,ka){'use strict';if(!ka||!ka.selected)return;this.data.setSingleState(true);this.inform('select',ka);var la=this.cleanQuery(ka.selected);this.executeQuery(la);};ia.prototype.highlightView=function(){'use strict';var ja=this.view.getSelection();if(n.graphSearchV2){this.input.setHint(ja?ja.structure:null);}else ja&&this.input.setHint(ja.structure);};ia.prototype.blurInput=function(){'use strict';fa((function(){if(this.windowFocused||y.getRequestURI().getSubdomain()==='apps'){this.input.togglePlaceholder();this.close();}}).bind(this),0);};ia.prototype.changeInput=function(){'use strict';this.inform('change');this.checkValue();this.inform('change_end');};ia.prototype.focusInput=function(){'use strict';this.open();this.input.togglePlaceholder(false);};ia.prototype.updateData=function(){'use strict';this.view.setLoading(this.loading);};ia.prototype.completeData=function(ja,ka){'use strict';this.checkBlockedSearch();if(ka.forceDisplay||this.value&&this.value.matches(ka.value)){var la=n.graphSearchV2?!ka.results.length:!ka.results.length&&!this.loading&&ka.isEmptyResults;this.view.render(ka.value,ka.results,ka.isAsync,la);if(this.tabQueued&&this.completeSelection())delete this.tabQueued;}};ia.prototype.typeaheadActivity=function(ja,ka){'use strict';this.fetching=ka.activity;if(this.loading!==this.fetching){this.loading=this.fetching;this.updateData();}};ia.prototype.getNameTextFromSelected=function(){'use strict';var ja=this.settedQuery&&this.settedQuery.semantic,ka=this.data.facebarConfig&&this.data.facebarConfig.name_functions,la=ja&&ka&&ja.match(/[a-z-]+\([^()]+\)/g);if(la)for(var ma=0;ma<la.length;ma++){var na=la[ma].match(/([a-z-]+)\(([^()]+)\)/);if(na&&z(ka,na[1]))return na[2];}return this.value.toString();};ia.prototype.clearRecentSearches=function(){'use strict';this.data.resultStore.clearRecentSearches();};ia.clearRecentSearches=function(){'use strict';i.inform('FacebarTypeahead.clearRecentSearches');};Object.assign(ia.prototype,{events:['session','focus','select','change','execute','blur','focusStartTime','open']});f.exports=ia;},null);
__d('FacebarTypeaheadRecorder',['clickRefAction','Event','Keys','SearchTypeaheadRecorder','URI','Arbiter','FacebarTimerUtils','FacebarGlobalOptions','FacebarJSConstants'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q,r;q=babelHelpers.inherits(s,k);r=q&&q.prototype;function s(t){'use strict';r.constructor.call(this,t);this.userText="";this.nullStateCandidates=null;this.singleStateCandidates=null;this.queryTimes={};this._sessionDisabled=false;this.type="facebar";this._maxQueryID=0;this._isQueryMatch=true;}s.prototype.initEvents=function(t){'use strict';t.getCore().subscribe('session',(function(u,v){if(v===null){this.sessionEnd();}else this.sessionStart(v);}).bind(this));t.getCore().subscribe('select',(function(u,v){this.recordSelectInfo(v);}).bind(this));t.getCore().subscribe('magSearch',(function(u,v){this.recordMagSearch(v);}).bind(this));t.getCore().input.subscribe('shortcut',(function(u,v){this.recordShortcut(v);}).bind(this));t.getCore().subscribe('quickSelectRedirect',(function(u,v){this.recordQuickSelectInfo(v);}).bind(this));t.getView().subscribe('render',(function(u,v){this.recordRender(v);if(this.allFromNullState){this.nullStateCandidates=this.buildListTypeaheadRecords();}else if(this.allFromSingleState)this.singleStateCandidates=this.buildListTypeaheadRecords();}).bind(this));t.getView().subscribe('show',(function(u,v){if(!this.data.lastNullOrSingleStateFetchStartTime)return;this.recordStat('time_render_null_state',Date.now()-this.data.lastNullOrSingleStateFetchStartTime);this.data.lastNullOrSingleStateFetchStartTime=null;}).bind(this));t.getView().subscribe('logPerformanceTiming',(function(u,v){this.performanceTimings[v.field]=v.value;}).bind(this));t.data.subscribe('query',(function(u,v){if(!v.value.isEmpty())this.recordCountStat('num_queries');this.recordAvgStat('num_results_from_cache',v.results.length);this.queryTimes[v.queryId]={send:n.getTimestamp()};}).bind(this));t.data.subscribe('sending_request',(function(u,v){var w=v.data.value;if(!w)return;this.backendQueries.push(w);}).bind(this));t.subscribe('navigation',(function(u,v){if(v&&v.structure){this.recordStat('navigation_input',JSON.stringify(v.structure.toStruct()));this.recordStat('navigation_text',v.structure.toString());}}).bind(this));t.data.subscribe('response_received',(function(u,v,w){if(this.queryTimes[v.queryId]){var x=this.queryTimes[v.queryId];x.recv=n.getTimestamp()-x.send;if(v&&v.payload)x.payload_size=JSON.stringify(v.payload).length;}}).bind(this));t.data.subscribe('remote_query_latency',(function(u,v){if(this.queryTimes[v.queryId]){var w=this.queryTimes[v.queryId];w.remoteQueryLatencies=v.latencies;}}).bind(this));t.data.subscribe('cache_query_latency',(function(u,v){if(this.queryTimes[v.queryId]){var w=this.queryTimes[v.queryId];w.cacheQueryLatencies=v.latencies;}}).bind(this));t.data.subscribe('backend_response',(function(u,v){if(this.queryTimes[v.queryId]){var w=this.queryTimes[v.queryId];w.render=n.getTimestamp()-w.send;if(v.payload.incomplete)w.incomplete=true;w.backendInfo=v.payload.info;if(this.core.scubaInfo)this.logToScuba(v,w,this.core.scubaInfo,v.inputQuery,this.type);}}).bind(this));t.getCore().subscribe('change',(function(u,v){this.userInput(this.core.getText());}).bind(this));t.data.subscribe('remote_query_match',(function(u,v){if(this._maxQueryID<v.queryId){this._maxQueryID=v.queryId;this._isQueryMatch=v.isMatch;}}).bind(this));m.subscribe('BrowseNUX/typing',this.disableThisSession.bind(this));m.subscribe('TestConsole/typing',this.disableThisSession.bind(this));t.subscribe('clear',(function(){this.recordAppendStat('before_clear_queries',this.userText);}).bind(this));i.listen(this.element,'keydown',(function(event){this.recordStat('keypressed',1);this.recordCountStat('count_keys_pressed');if(i.getKeyCode(event)==j.BACKSPACE){if(!this._backspacing){this._backspacing=true;this.recordAppendStat('before_backspace_queries',this.core.getText());}}else this._backspacing=false;}).bind(this));this.core.subscribe('open',(function(u,v){if(v&&v.catchup)return;this.data.lastNullOrSingleStateFetchStartTime=Date.now();}).bind(this));this.core.subscribe('focusStartTime',(function(u,v){this.data.lastNullOrSingleStateFetchStartTime=v.time;}).bind(this));this.data.subscribe('beforeQuery',(function(u,v){if(!this.queryStartTime)this.queryStartTime=[];if(!this.query&&!this.data.lastNullOrSingleStateFetchStartTime)this.data.lastNullOrSingleStateFetchStartTime=Date.now();this.queryStartTime[this.query]=Date.now();}).bind(this));t.subscribe('filter',(function(u,v){this._unsupportedGrammarInfo=this.buildUnsupportedGrammarInfo(v);}).bind(this));t.getCore().subscribe('recordFunction',(function(u,v){this._extraRecorder.push(v);}).bind(this));this.data.subscribe('bootstrapped',(function(u,v){this.recordStat('bootstrap_size',v.size||-1);}).bind(this));};s.prototype._reset=function(t){'use strict';this.stats={};this.avgStats={};this.appendStats={};this._backspacing=false;this.backendQueries=[];this._topreplace=false;this._inflightRequests={};};s.prototype.sessionStart=function(t){'use strict';this._sessionEnded=false;this.data.setQueryData({sid:t});this.recordStat('sid',t);if(!this.stats.session_start_time){this.recordStat('session_start_time',n.getTimestamp());var u=new Date(),v=u.getTimezoneOffset(),w=Date.now()-v*60*1000;this.recordStat('session_start_time_user_timezone',w);}this.recordStat('keypressed',0);this.queryTimes={};};s.prototype.sessionEnd=function(){'use strict';if(this._sessionEnded||this._sessionDisabled){if(this._sessionDisabled){this.reset();this._sessionDisabled=false;this._sessionEnded=true;}return;}this._sessionEnded=true;var t='typed';if(this.allFromNullState){t='nullstate';}else if(this.allFromSingleState)t='singlestate';this.recordStat('last_state',t);this.recordStat('session_end_time',n.getTimestamp());this.recordStat('grammar_version',this.data.getQueryData().grammar_version);this.submit();this.nullStateCandidates=null;this.singleStateCandidates=null;};s.prototype.disableThisSession=function(){'use strict';this._sessionDisabled=true;};s.prototype.userInput=function(t){'use strict';this.userText=t;};s.prototype.buildUnsupportedGrammarInfo=function(t){'use strict';var u=t.results?t.results[0]:null;if(!u||u.results_set_type!=='unimplemented')return null;return {unsupported_grammar:{category:u.error_info.category||'unknown',edge:u.error_info.blamed_edge}};};s.prototype.buildTypeaheadRecord=function(t,u){'use strict';var v=t.rankType||t.render_type||t.type,w=0,x=u;if(typeof t.groupIndex=='number'){w=t.groupIndex;x=t.indexInGroup;}var y={group_index:w,index_in_group:x,cost:t.cost,s_value:t.s_value||0,semantic:t.semantic,text:t.structure.toString(),cache_only:t.cacheOnlyResult?1:0,prefetched:t.isPrefetched?1:0,parse:t.parse,category:t.category,type:v,source:t.bootstrapped,grammar_results_type:(t.results_set_type||'').replace(/[\[\{](.*)[\]\}]/,'$1'),result_from_memcache:t.memcache,websuggestion_source:t.websuggestion_source,dynamic_cost:t.dynamic_cost,is_js_bootstrap_match:t.isJSBootstrapMatch,backend_cost:t.backendCost,bootstrap_cost:t.bootstrapCost,match_type:t.match_type,l_type:t.l_type,vertical_type:t.vertical_type,prefix_match:t.prefix_match,prefix_length:t.prefix_length,index_before_buckets:t.indexBeforeBuckets,bucket_lineage:t.bucketLineage,nullstate:t.isNullState,singlestate:t.isSingleState,query_id:t.qid,template_id:t.templateID,coeff_cost:typeof t.grammar_costs=='undefined'?-1:t.grammar_costs["{"+t.type+"}"],suggestion:t.isSuggestion,recent_search_suggestion:t.isRecentSearchSuggestion?1:0,keyword_bootstrap:t.isJSBootstrapMatch&&t.type===p.keywordType?1:0,popular_search_suggestion:t.isPopularSearchSuggestion?1:0,keyword_source:t.keywordSource,exact_match_suggestion:t.exactMatchKeyword?1:0};if(t.logInfo)y.backend_log_info=t.logInfo;if(t.s_token)y.s_token=t.s_token;if(t.s_categories)y.s_categories=t.s_categories;return y;};s.prototype.buildListTypeaheadRecords=function(){'use strict';var t=[];this.results&&this.results.forEach((function(u,v){if(u.uid!=='search')t.push(this.buildTypeaheadRecord(u,v));}).bind(this));return t;};s.prototype.recordShortcut=function(t){'use strict';this.recordStat('shortcut',1);this.recordStat('shortcut_with_shift',t.shift);};s.prototype.recordStats=function(t,u){'use strict';for(var v in u)this.recordStat(t+'_'+v,u[v]);};s.prototype.getTypeaheadIndex=function(t,u){'use strict';var v=typeof t.groupIndex=='number'?t.groupIndex+1:0;return u-v;};s.prototype.recordQuickSelectInfo=function(t){'use strict';var u={input_query:t.input_query,semantic:t.semantic,type:t.type,position:t.position,with_mouse:t.with_mouse,text:t.text,quick_select:1};this.recordStats('selected',u);this.recordStat('quick_select',1);};s.prototype.recordMagSearch=function(t){'use strict';var u={};u.text=t.text;u.semantic=t.semantic;u.type=t.type;u.input_query=t.text;u.position=t.position;this.recordStats('selected',u);};s.prototype.recordSelectInfo=function(t){'use strict';var u=t.selected,v=this.getTypeaheadIndex(u,t.index),w={};if(u.uid=='search'){w.selected_search=1;}else{w=this.buildTypeaheadRecord(u);var x=w.type=='friend'?'user':w.type;w.position=v;w[x]=1;}w.with_mouse=t.clicked?1:0;w.quick_select=0;w.input_query=this.userText;w.input_fragments=JSON.stringify(this.core.currentQuery.toStruct());var y=u.dataGT?{gt:JSON.parse(u.dataGT)}:{},z={href:u.path};h('click',z,null,null,y);this.recordStats('selected',w);this.recordAppendStat('selection_history',{selected:w,candidate_results:this.buildListTypeaheadRecords(),timestamp:n.getTimestamp()});var aa={};this._extraRecorder.forEach((function(ba){ba(t,this.results,aa);}).bind(this));this.recordStat('extra_select_info',JSON.stringify(aa));this.recordStat('selected_with_mouse',t.clicked?1:0);};s.prototype._dataToSubmit=function(){'use strict';this.recordStat('max_results',this.data._maxResults);if(this.stats&&this.stats.selected_input_query){this.recordStat('input_query',this.stats.selected_input_query);}else this.recordStat('input_query',this.userText);this.recordStat('uri',new l(window.location.href).toString());if(!this.stats.shortcut){this.recordStat('shortcut',0);this.recordStat('shortcut_with_shift',false);}var t=this.stats;for(var u in this.avgStats){var v=this.avgStats[u];t[u]=v[0]/v[1];}var w={candidate_results:this.buildListTypeaheadRecords(),timestamp:n.getTimestamp(),input_query:this.userText,remote_query_match:this._isQueryMatch};if(this._unsupportedGrammarInfo)Object.assign(w,this._unsupportedGrammarInfo);this.recordAppendStat('suggestions_at_end_of_session',w);if(this.nullStateCandidates)this.recordAppendStat('suggestions_at_nullstate_session',{candidate_results:this.nullStateCandidates});if(this.singleStateCandidates)this.recordAppendStat('suggestions_at_singlestate_session',{candidate_results:this.singleStateCandidates});this.recordAppendStat('query_times',this.queryTimes);if(this.backendQueries.length>0){if(this.backendQueries.length>this.data.logBackendQueriesWindow)this.backendQueries=this.backendQueries.slice(this.backendQueries.length-this.data.logBackendQueriesWindow);this.recordStat('backend_queries',this.backendQueries);}if(o.taSessionLoggingSample){var x=[];this.results.forEach(function(z){x.push([z.text||'',z.category||'',z.subtext||'']);});this.recordStat('raw_suggestions_text',x);}if(o.graphSearchV2){this.recordStat('experience_type','gsv2');}else this.recordStat('experience_type','facebar');for(var y in this.appendStats)t[y]=JSON.stringify(this.appendStats[y]);return t;};s.prototype.getDataToSubmit=function(){'use strict';return this._dataToSubmit();};s.prototype.reset=function(){'use strict';return this._reset();};s.prototype.submit=function(){'use strict';if(!this._sessionDisabled)r.submit.call(this);this.view.inform('feedback');this._reset();};Object.assign(s.prototype,{_sessionEnded:true,_extraRecorder:[],_banzaiRoute:'facebar'});f.exports=s;},null);
__d('FacebarTypeaheadGrammarItem.react',['React','FacebarTypeaheadItem.react','FacebarTypeaheadToken.react','FacebarTypeaheadTokenText','cx','fbt','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o={user:m._("Person")},p=h.createClass({displayName:'FacebarTypeaheadGrammarItem',renderToken:function(){var q=this.props.result.decoration,r=this.props.result.ambiguity,s=r&&r.text,t=q&&q.entity||r&&r.entity;if(this.props.result.isRecent){var u=m._("Recent search");return (h.createElement(j,{text:[u],innerClass:"_53ab"}));}else if(s){return (h.createElement(j,{text:k.text(s)}));}else if(t)return (h.createElement(j,{text:k.textForEntity(t,o),limit:2,leadingMiddot:true}));},getClassName:function(){var q=this.props.result;if(q.isPeopleAndPagesSuggestion)return "_2enu";if(q.tags&&q.tags.displayedSeeMore)return "_10gs";return "_207";},render:function(){var q=this.renderToken(),r=q&&!q.props.leadingMiddot;return (h.createElement(i,babelHelpers._extends({},this.props,{className:n(this.props.className,this.getClassName()),valign:r,token:q})));}});f.exports=p;},null);
__d('FacebarTypeaheadKeywordItem.react',['FacebarGlobalOptions','FacebarTypeaheadItem.react','FacebarTypeaheadToken.react','FacebarTypeaheadTokenText','React','cx','fbt','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=l.createClass({displayName:'FacebarTypeaheadKeywordItem',render:function(){var q=[n._("Search")];if(this.props.result.isTrending){q.push(n._("Trending"));}else if(this.props.result.type=='related')q=[n._("Related search")];if(h.renderKeywordSnippets){var r=k.textForEntity(this.props.result,{});if(r&&r.length)q=r;}var s=h.renderKeywordSnippets&&r&&r.length>1,t=s&&this.props.result.isLocal,u=s&&this.props.result.isSpecialIntent&&!t,v=l.createElement(j,{text:q,mainClass:(s?"_4jt7":'')+(t?' '+"_2xfl":'')+(u?' '+"_4pi4":''),innerClass:"_53ab"});return (l.createElement(i,babelHelpers._extends({},this.props,{className:o(this.props.className,!h.renderKeywordSnippets?"_207":''),token:v,prefix:this.props.result.query_string.toLowerCase()})));}});f.exports=p;},null);
__d('FacebarTypeaheadNodeItem.react',['React','ReactDOM','DOM'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=h.createClass({displayName:'FacebarTypeaheadNodeItem',render:function(){var l=this.props.result.node;return (h.createElement('li',this.props,!j.isElementNode(l)?l:null));},attachNode:function(l){var m=this.props.result.node;if(j.isElementNode(m))j.setContent(l,m);},componentDidMount:function(){this.attachNode(i.findDOMNode(this));},componentDidUpdate:function(l,m,n){this.attachNode(i.findDOMNode(this));},shouldComponentUpdate:function(l){return this.props.result.node!==l.result.node;}});f.exports=k;},null);
__d('FacebarTypeaheadRecentItem.react',['FacebarGlobalOptions','FacebarTypeaheadItem.react','React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=j.createClass({displayName:'FacebarTypeaheadRecentItem',render:function(){return (j.createElement(i,babelHelpers._extends({},this.props,{className:l(this.props.className,!h.renderKeywordSnippets?"_207":''),icon:this.renderIcon()})));},renderIcon:function(){var n=this.props.result;if(!h.allowGrammar)return (j.createElement('img',{className:"_20h",src:n.photo}));var o=n.icon_class?j.createElement('span',{className:n.icon_class}):j.createElement('img',{className:"_20h",src:n.photo});return (j.createElement('span',{className:!h.renderKeywordSnippets||n.icon_class&&h.renderKeywordSnippets?"_k83":''},o));}});f.exports=m;},null);
__d('FacebarTypeaheadTrendingItem.react',['FacebarTypeaheadItem.react','FacebarTypeaheadToken.react','React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=j.createClass({displayName:'FacebarTypeaheadTrendingItem',render:function(){var n=this.props.result.articleTitle||'',o=j.createElement(i,{text:[n],innerClass:"_53ab",leadingMiddot:true});return (j.createElement(h,babelHelpers._extends({},this.props,{className:l(this.props.className,"_207"),token:o,valign:false})));}});f.exports=m;},null);
__d('FacebarTypeaheadList.react',['ARIA','React','ReactDOM','StaticContainer.react','FacebarTypeaheadEntityItem.react','FacebarTypeaheadGrammarItem.react','FacebarTypeaheadKeywordItem.react','FacebarTypeaheadNodeItem.react','FacebarTypeaheadRecentItem.react','FacebarTypeaheadTrendingItem.react','LoadingIndicator.react','FacebarJSConstants','FacebarGlobalOptions','CSS','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();var x=i.PropTypes,y={grammar:m,trending:q,related:n};y[s.browseTypes.keyword]=n;y[s.keywordType]=n;var z=i.createClass({displayName:'FacebarTypeaheadList',propTypes:{results:x.array,onRender:x.func,onSelect:x.func.isRequired,onHighlight:x.func.isRequired,isKeywordList:x.bool},getItemComponentConstructor:function(aa,ba){if(aa.node)return o;if(aa.isRecent)return p;if(aa.results_set_type===s.browseTypes.keyword)return n;if(aa.type&&y[aa.type])return y[aa.type];return l;},renderItem:function(aa,ba){var ca=this.getItemComponentConstructor(aa),da;if(aa.type===s.keywordType){da=aa.query_string+aa.semantic+aa.isRecentSearchSuggestion;}else{da=aa.semantic||aa.uid||aa.tuid;da=da+aa.isNullState;if(t.facebarUpdateSnippets)da=da+aa.category+aa.subtext;}return (i.createElement(k,{key:da},i.createElement(ca,{result:aa,onClick:this.handleClick.bind(null,aa),onMouseEnter:this.handleMouseEnter.bind(null,aa)})));},renderFooter:function(){var aa="_3su"+(!this.props.loading?' '+"hidden_elem":'');return (i.createElement('li',{className:aa},i.createElement('div',{className:"_21f"},w._("Finding results"),i.createElement(r,{size:'medium',color:'white'}))));},componentDidMount:function(){var aa=j.findDOMNode(this);h.owns(this.props.accessibilityElement,aa);},hasValidRecentSearches:function(){if(!t.hasRecentSearchNullState||!this.props.results)return false;return this.props.results.some(function(aa){return aa.isRecent;});},render:function(){var aa=this.props.results,ba=[],ca=[],da=false;if(aa)aa.forEach(function(ia){if(ia.isTrending)da=true;if(ia.isSuggestion){ca.push(this.renderItem(ia));}else ba.push(this.renderItem(ia));},this);var ea=null,fa=null,ga=da?w._("In the News"):w._("Search Suggestions");if(ca.length>0){var ha=null;if(this.hasValidRecentSearches()||t.hasGrammarNullState)ha=i.createElement('div',{className:"_3zsi"+(t.renderKeywordSnippets?' '+"_1ejo":'')},ga);ea=i.createElement('div',null,ha,i.createElement('ul',{id:'facebar_typeahead_view_list',className:"_21c",role:'listbox'},ca,this.renderFooter()));}else fa=this.renderFooter();return (i.createElement('div',null,i.createElement('ul',{id:'facebar_typeahead_view_list',className:"_21c"+(this.props.isKeywordList?' '+"_2yob":''),'data-click':'Search',role:'listbox'},ba,fa),ea));},handleClick:function(aa,ba){if(u.hasClass(ba.target,"_2d9t"))return;if(!ba.nativeEvent.isMiddleClick()&&!ba.nativeEvent.getModifiers().any){this.props.onSelect(aa);ba.preventDefault();}},handleMouseEnter:function(aa){this.props.onHighlight(aa);},componentDidUpdate:function(aa,ba,ca){this.props.onRender();},shouldComponentUpdate:function(aa){return this.props.loading!==aa.loading||this.props.results!==aa.results;}});f.exports=z;},null);
__d('FacebarTypeaheadView',['Arbiter','CSS','ContextualLayer','DOM','FacebarGlobalOptions','FacebarJSConstants','FacebarStructuredText','FacebarTypeaheadList.react','Parent','React','ReactDOM','ScriptPath','Style','TypeaheadView','performanceNow','csx','cx','fbt','URI','Link.react'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){if(c.__markCompiled)c.__markCompiled();var ba,ca,da='unimplemented';ba=babelHelpers.inherits(ea,u);ca=ba&&ba.prototype;function ea(fa,ga){'use strict';ca.constructor.call(this,fa,ga);this.element=fa;this.sid='';this.index=-1;this.warningShown=false;this.autoSelect=false;this.flipCount=0;this.loading=false;this.handleRender=this.handleRender.bind(this);this.handleHighlight=this.handleHighlight.bind(this);this.handleSelect=this.handleSelect.bind(this);this.events=['highlight','render','filter','show'];}ea.prototype.init=function(){'use strict';this.initializeElements();};ea.prototype.initGSV2Elements=function(){'use strict';var fa=this.element;this.contentKeyword=k.find(fa,"._f7s");this.contentEntity=k.find(fa,"._f7t");this.contentRecent=k.find(fa,"._mn8");this.contentSuggestion=k.find(fa,"._2pl-");this.contentAdminedPages=k.find(fa,"._1e-s");this.keywordResultsContainer=k.create('div');this.entityResultsContainer=k.create('div');this.keywordResults=[];this.entityResults=[];};ea.prototype.initGSV2Construct=function(){'use strict';this.currentKeywordContainer=this.contentKeyword;this.currentEntityContainer=this.contentEntity;this.contentKeyword.appendChild(this.keywordResultsContainer);this.contentEntity.appendChild(this.entityResultsContainer);if(this.entityTop){this.resultsContainer.appendChild(this.contentEntity);this.resultsContainer.appendChild(this.contentKeyword);}else{this.resultsContainer.appendChild(this.contentKeyword);this.resultsContainer.appendChild(this.contentEntity);}};ea.prototype.initializeElements=function(){'use strict';var fa=this.element;this.isGSV2=l.graphSearchV2;this.dynamicRank=this.isGSV2;this.fixedBlendingOrder=l.blendingOrderKeywordFirst||l.blendingOrderEntityFirst;this.entityTop=l.blendingOrderEntityFirst&&!l.renderKeywordsFirst;this.content=k.find(fa,"._21r");this.warningNode=k.find(fa,"._553e");this.blockNotificationNode=k.find(fa,"._2hh");this.resultsContainer=k.create('div');if(this.isGSV2)this.initGSV2Elements();};ea.prototype.initializeList=function(){'use strict';this.renderTypeaheadList();this.content.appendChild(this.resultsContainer);if(this.isGSV2)this.initGSV2Construct();};ea.prototype.initializeLayer=function(){'use strict';this.layer=new j({context:p.byClass(this.causalElement,"_585-"),position:'below',causalElement:this.causalElement},this.element);var fa=this.layer.getContentRoot();this.root=k.find(fa,"._50c9");i.addClass(fa,"_5tlx");if(this.isGSV2)i.addClass(fa,"_5xzd");this.wrapper=fa;};ea.prototype.setInputElement=function(fa){'use strict';this.setAccessibilityControlElement(fa);this.causalElement=fa;this.initializeLayer();this.initializeList();};ea.prototype.setAutoSelect=function(fa){'use strict';this.autoSelect=fa;if(this.index===-1&&fa)this.first();};ea.prototype.getIndexOf=function(fa,ga){'use strict';for(var ha=0;ha<ga.length;ha++)if(fa.semantic===ga[ha].semantic)return ha;return -1;};ea.prototype.handleHighlight=function(fa){'use strict';this.highlight(this.getIndexOf(fa,this.results),false);};ea.prototype.handleSelect=function(fa){'use strict';this.handleHighlight(fa);this.select(true);};ea.prototype.show=function(fa){'use strict';if(!this.visible){this.inform('beforeShow',this.layer);t.set(this.wrapper,'minWidth',fa+'px');var ga=ca.show.call(this);this.first();this.layer.show();this.layer.updatePosition();this.inform('show');h.inform('layer_shown',{type:'FacebarTypeahead'});return ga;}};ea.prototype.hide=function(){'use strict';if(this.visible){this.layer.hide();ca.hide.call(this);this.inform('hide');h.inform('layer_hidden',{type:'FacebarTypeahead'});}return this;};ea.prototype.select=function(fa){'use strict';var ga=this.results&&this.results[this.index];if(!ga){this.inform('quickSelect');return;}var ha=this.inform('beforeSelect',{index:this.index,selected:ga});if(ha!==false){s.setClickPointInfo({click:'Search'});ca.select.call(this,fa);}};ea.prototype.doesResultBelongToEntitySection=function(fa){'use strict';switch(fa.type){case m.keywordType:return false;case m.grammarType:return fa.tags&&fa.tags.displayedSeeMore;default:return true;}};ea.prototype.processGSV2Results=function(fa){'use strict';this.keywordResults=[];this.entityResults=[];var ga=[],ha=[],ia=fa.some(function(ja){return ja.isSingleState;});fa.forEach((function(ja){if(this.doesResultBelongToEntitySection(ja)){this.entityResults.push(ja);}else if(ia){if(ja.alternateSemantic){ha.push(ja);}else ga.push(ja);}else this.keywordResults.push(ja);}).bind(this));if(ia)this.keywordResults=ha.concat(ga);if(this.entityTop)return this.entityResults.concat(this.keywordResults);return this.keywordResults.concat(this.entityResults);};ea.prototype.reGenerateContainer=function(){'use strict';var fa=k.create('div');if(this.entityTop){fa.appendChild(this.currentEntityContainer);fa.appendChild(this.currentKeywordContainer);}else{fa.appendChild(this.currentKeywordContainer);fa.appendChild(this.currentEntityContainer);}return fa;};ea.prototype.buildResultsNoRegeneration=function(fa){'use strict';if(this.dynamicRank&&fa.length>0&&!this.fixedBlendingOrder&&!l.renderKeywordsFirst&&this.flipCount<2){var ga=fa[0].type!==m.keywordType;if(l.hasFlipOnce&&this.value.toString()&&this.entityTop!=ga)this.flipCount++;this.entityTop=ga;}var ha=String(this.value);fa.forEach(function(ja){ja.query_string=ha;});this.results=fa;if(this.isGSV2)this.results=this.processGSV2Results(fa);var ia=v();this.renderTypeaheadList({results:this.results,loading:this.loading});this.inform('logPerformanceTiming',{field:'build_results_set_props_duration',value:v()-ia});};ea.prototype.buildResults=function(fa){'use strict';this.buildResultsNoRegeneration(fa);if(this.dynamicRank)this.resultsContainer=this.reGenerateContainer();return this.resultsContainer;};ea.prototype.getGSV2Items=function(){'use strict';var fa=ca.getItems.call(this),ga,ha;if(this.entityTop){ha=fa.slice(0,this.entityResults.length);ga=fa.slice(this.entityResults.length+1,-1);fa=ha.concat(ga);}else{ga=fa.slice(0,this.keywordResults.length);ha=fa.slice(this.keywordResults.length+1,-1);fa=ga.concat(ha);}return fa;};ea.prototype.getItems=function(){'use strict';if(this.isGSV2)return this.getGSV2Items();return ca.getItems.call(this).slice(0,-1);};ea.prototype.handleRender=function(){'use strict';this.items=this.getItems();};ea.prototype.render=function(fa,ga,ha,ia){'use strict';this.inform('filter',{results:ga,value:fa});this.seeMoreResult=null;if(fa.getLength()){this.seeMoreResult=this.inform('seeMore',{value:fa,results:ga});if(!this.loading&&this.seeMoreResult)ga.push(this.seeMoreResult);}var ja=!fa||fa instanceof n&&fa.isEmptyOrWhitespace();i.conditionClass(this.wrapper,"_5qz2",!ga.length&&ja&&!this.getMegaphone());var ka=ga[0];if(ia&&!ja){if(!this.isGSV2)this.showWarning(y._("There are no results for '{query}'",[y.param('query',fa.toString())]));}else if(ka&&ka.results_set_type===da){if(!ka.error_info.suppress)this.showWarning(ka.error_info.errorMessage||y._("This search isn't currently supported."));}else this.hideWarning();if(this.inform('removeUnimplementedGrammar')!==false)ga=ga.filter((function(la){return la.results_set_type!==da;}).bind(this));ca.render.call(this,fa,ga,ha);};ea.prototype.reset=function(){'use strict';this.index=-1;this.items=[];this.results=[];this.value='';this.buildResults([]);this.inform('reset');return this;};ea.prototype.resetIndex=function(){'use strict';this.index=-1;};ea.prototype.getMegaphone=function(){'use strict';return k.scry(this.element,'.megaphone_location_gsv2_typeahead')[0];};ea.prototype.showBlockNotification=function(fa){'use strict';var ga=new z('https://www.facebook.com').setPath('/settings').addQueryData('tab','blocking'),ha=q.createElement('div',null,y._("You've blocked {fullName}. For more info on privacy and blocking, go to your {settings}.",[y.param('fullName',fa),y.param('settings',q.createElement(aa,{href:{url:ga}},y._("settings")))]));i.show(this.blockNotificationNode);r.render(ha,this.blockNotificationNode);};ea.prototype.hideBlockNotification=function(){'use strict';i.hide(this.blockNotificationNode);k.setContent(this.blockNotificationNode,'');};ea.prototype.showWarning=function(fa){'use strict';i.show(this.warningNode);k.setContent(this.warningNode,fa);this.warningShown=true;this.highlight(-1,false);};ea.prototype.hideWarning=function(){'use strict';i.hide(this.warningNode);this.warningShown=false;this.highlight(this.index,false);};ea.prototype.setLoading=function(fa){'use strict';if(this.loading!=fa){this.loading=fa;if(this.seeMoreResult){if(this.loading){this.results.splice(this.results.indexOf(this.seeMoreResult),1);}else this.results.push(this.seeMoreResult);this.buildResultsNoRegeneration(this.results);}else this.renderTypeaheadList({results:this.results,loading:fa});}};ea.prototype.first=function(){'use strict';this.index=this.autoSelect?0:-1;this.highlight(this.index);};ea.prototype.prev=function(){'use strict';if(this.isGSV2){if(this.index<0||this.index===0&&this.autoSelect)this.index=this.items.length;}else if(this.index<=0)this.index=this.items.length;this.ignoreMouseover=true;ca.prev.call(this);};ea.prototype.next=function(){'use strict';if(this.isGSV2&&this.autoSelect&&this.index>=this.items.length-1)this.index=-1;if(!this.isGSV2&&this.index+1>=this.items.length)this.index=-1;this.ignoreMouseover=true;ca.next.call(this);};ea.prototype.highlight=function(fa,ga){'use strict';ga=ga!==false&&this.index!=fa;if(!ga||this.inform('beforeHighlight')!==false){var ha=this.warningShown||!this.autoSelect?-1:0;ca.highlight.call(this,Math.max(ha,fa),ga);}};ea.prototype.updateCurrentKeywordContainer=function(){'use strict';var fa=this.currentKeywordContainer,ga=!String(this.value).trim();if(ga&&this.hasValidRecentSearches()){this.currentKeywordContainer=this.contentRecent;}else if(ga&&l.hasKeywordSuggestionNullState&&!l.hasGrammarNullState){this.currentKeywordContainer=this.contentSuggestion;}else this.currentKeywordContainer=this.contentKeyword;if(fa&&fa!==this.currentKeywordContainer){i.hide(fa);fa.removeChild(this.keywordResultsContainer);this.currentKeywordContainer.appendChild(this.keywordResultsContainer);}};ea.prototype.updateCurrentEntityContainer=function(){'use strict';var fa=this.currentEntityContainer,ga=!String(this.value).trim();if(ga&&this.entityResults){this.currentEntityContainer=this.contentAdminedPages;}else this.currentEntityContainer=this.contentEntity;if(fa&&fa!=this.currentEntityContainer){i.hide(fa);fa.removeChild(this.entityResultsContainer);this.currentEntityContainer.appendChild(this.entityResultsContainer);}};ea.prototype.hasValidRecentSearches=function(){'use strict';if(!l.hasRecentSearchNullState||!this.keywordResults)return false;return this.keywordResults.some(function(fa){return fa.isRecent;});};ea.prototype.copyProps=function(fa){'use strict';return babelHelpers._extends({accessibilityElement:this.accessibilityElement,onRender:this.handleRender,onHighlight:this.handleHighlight,onSelect:this.handleSelect},fa);};ea.prototype.renderList=function(fa,ga){'use strict';r.render(q.createElement(o,this.copyProps(fa)),ga);};ea.prototype.renderGSV2TypeaheadList=function(fa){'use strict';var ga=this.copyProps(Object.assign({},fa,{isKeywordList:true})),ha=this.copyProps(fa);ga.results=this.keywordResults;ha.results=this.entityResults;if(this.entityTop||ha.results.length===0){ha.loading=false;}else ga.loading=false;var ia=this.entityResults.length===0&&ga.loading&&this.keywordResults.length===1&&this.keywordResults[0].exactMatchKeyword;this.renderList(ga,this.keywordResultsContainer);this.renderList(ha,this.entityResultsContainer);this.updateCurrentKeywordContainer();this.updateCurrentEntityContainer();i.conditionShow(this.currentKeywordContainer,!!this.keywordResults.length);i.conditionShow(this.currentEntityContainer,!!this.entityResults.length);i.conditionClass(this.element,"_1z7e",ia);i.conditionClass(this.element,"_3gbv",l.typeaheadkeywordStyle==='relaxed');i.conditionClass(this.element,"_3gbw",l.typeaheadkeywordStyle==='baggy');};ea.prototype.renderTypeaheadList=function(fa){'use strict';fa=fa||{};if(this.isGSV2){this.renderGSV2TypeaheadList(fa);}else this.renderList(fa,this.resultsContainer);};f.exports=ea;},null);
__d('FacebarTypeaheadDecorateEntities',['arrayContains','emptyFunction'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(n){var o=[];n.forEach(function(p){if(p.isType('ent'))o.push(p.getUID());});return o;}function k(n,o){var p=null;n.structure.forEach(function(q){if(q.isType('ent')&&!h(o,q.getUID()))p=q;});return p;}function l(n,o,p){n.forEach(function(q){var r=k(q,o);q.decoration={entity:r&&p.getEntryForFragment(r)};});}function m(n){'use strict';this._typeahead=n;}m.prototype.enable=function(){'use strict';this._typeahead.view.subscribe('filter',(function(n,o){l(o.results,j(this._typeahead.core.getValue()),this._typeahead.data);}).bind(this));};Object.assign(m.prototype,{disable:i});f.exports=m;},null);
__d('FacebarTypeaheadDisambiguateResults',['FacebarDisambiguationDialog','FacebarStructuredFragment','FacebarStructuredText','URI','emptyFunction','getObjectValues'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();function n(w,x){var y={};w.forEach(function(ba){if(ba.type=='grammar'){var ca=x(ba.structure).toLowerCase();y[ca]=y[ca]||[];y[ca].push(ba);}});var z=[];for(var aa in y)if(y[aa].length>1)z.push(y[aa]);return z;}function o(w){var x=[];w.toArray().forEach(function(y,z){if(y.isType('ent'))x.push(z);});return x;}function p(w,x,y){var z={},aa={},ba={};x.forEach(function(da){var ea=w[0].structure.getFragment(da),fa=ea.getHash();aa[fa]=aa[fa]||[];ba[da]=aa[fa];w.forEach(function(ga){var ha=ga.structure.getFragment(da),ia=ha&&ha.getUID();if(ia&&!z.hasOwnProperty(ia)){aa[fa].push(y.getEntryForFragment(ha));z[ia]=true;}});});for(var ca in ba)if(ba[ca].length<=1)delete ba[ca];return ba;}function q(w,x){var y={},z=[];w.forEach(function(aa){var ba=aa.structure.getFragment(x).getUID();if(!y.hasOwnProperty(ba)){y[ba]=z.length;z.push([]);}z[y[ba]].push(aa);});return z;}function r(w,x,y){var z=w.shift();z.ambiguity.entities=x;y.push.apply(y,w);return z;}function s(w,x){var y=[],z=[],aa=false;w.forEach(function(ca){ca.ambiguity={fragment:null,entities:null,text:null};});n(w,function(ca){return ca.getHash();}).forEach(function(ca){var da=ca[0].structure,ea=o(da),fa=p(ca,ea,x);if(aa){r(ca,fa,y);return;}var ga=ea.pop();if(typeof ga=='number'){var ha=q(ca,ga);aa=ha.length>1;if(aa)delete fa[ga];ha.forEach(function(ia){var ja=r(ia,fa,y);if(aa){var ka=ja.structure.getFragment(ga).getUID();ja.ambiguity.entity=x.getEntry(ka);z.push(ja);}});}});y.forEach(function(ca){var da=w.indexOf(ca);da!=-1&&w.splice(da,1);});n(w,function(ca){return ca.toString();}).forEach(function(ca){ca.forEach(function(da){if(!da.ambiguity.entities)da.ambiguity.text=da.queryTypeText;});});var ba=w.indexOf(z[0]);z.slice(1).forEach(function(ca){var da=w.indexOf(ca);if(da!=-1&&da!=++ba){w.splice(da,1);w.splice(ba,0,ca);}});}function t(w,x){var y=w&&w.ambiguity&&w.ambiguity.entities,z=y&&Object.keys(y).map(Number),aa=x.core.input;if(!z||z.length===0)return false;var ba=function(ea){x.core.executeQuery(u(w,z,ea));},ca=function(){aa.focus();aa.input.moveSelectionToEnd();};y=y?m(y):[];var da=new h(y,w.uri.getPath(),ba,ca,x.getCore().getSessionID());aa.blur();da.show();return true;}function u(w,x,y){var z=w.structure.toArray(),aa=new k(w.uri),ba=aa.getPath().split('/');x.forEach(function(ca){var da=z[ca],ea=y.shift(),fa=ba.indexOf(String(da.getUID()));if(fa!=-1)ba[fa]=ea.uid;z[ca]=new i({uid:ea.uid,text:ea.text,type:'ent:'+ea.type});});return {uri:aa.setPath(ba.join('/')),structure:new j(z)};}function v(w){'use strict';this._typeahead=w;}v.prototype.enable=function(){'use strict';this._typeahead.view.subscribe('filter',(function(w,x){s(x.results,this._typeahead.data);}).bind(this));this._typeahead.view.subscribe('beforeSelect',(function(w,x){return !t(x.selected,this._typeahead);}).bind(this));};Object.assign(v.prototype,{disable:l});f.exports=v;},null);
__d("XBrowseWarmUserRequestArgsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/search\/browse\/warm\/requestargs\/",{});},null,{});
__d('FacebarTypeaheadEarlyUserRequest',['AsyncRequest','XBrowseWarmUserRequestArgsController'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k){'use strict';this._core=k.getCore();this._listener=null;}j.prototype.enable=function(){'use strict';this._listener=this._core.subscribe('focus',(function(k,l){new h().setURI(i.getURIBuilder().getURI()).send();this.disable();}).bind(this));};j.prototype.disable=function(){'use strict';this._listener&&this._core.unsubscribe(this._listener);};f.exports=j;},null);
__d('FacebarTypeaheadNavigation',['Arbiter','FacebarNavigation','emptyFunction'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();function k(l){'use strict';this._core=l.core;this._preserveQuery=false;this._typeahead=l;}k.prototype.enable=function(){'use strict';i.registerBehavior(this);this._core.subscribe('execute',this.executedUserQuery.bind(this));};k.prototype.executedUserQuery=function(l,m){'use strict';this._preserveQuery=true;};k.prototype.pageTransition=function(){'use strict';if(!this._preserveQuery){this._core.close();this._core.reset();}else this._preserveQuery=false;};k.prototype.setPageQuery=function(l){'use strict';l=this._core.setPageQuery(l);this._typeahead.inform('navigation',l,h.BEHAVIOR_PERSISTENT);};Object.assign(k.prototype,{disable:j});f.exports=k;},null);
__d('FacebarTypeaheadPrefixLengthOrderedCache',['emptyFunction','Arbiter'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k){'use strict';this._typeahead=k;}j.prototype.enable=function(){'use strict';this._typeahead.data.inform('setSortFunction',function(k,l){if(k.cache_id_length!==l.cache_id_length)return k.cache_id_length-l.cache_id_length;var m=(k.cost||0)-(l.cost||0);if(m!==0)return m;return (k.semantic||'').localeCompare(l.semantic||'');},i.BEHAVIOR_STATE);};Object.assign(j.prototype,{disable:h});f.exports=j;},null);
__d('FacebarTypeaheadQuickSelect',['FacebarStructuredText','URI'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j='/search/web/direct_search.php';function k(l){'use strict';this._core=l.getCore();this._view=l.getView();this._input=this._core.input;this._beforeSelectListener=null;this._quickSelectListener=null;}k.prototype.enable=function(){'use strict';this._beforeSelectListener=this._view.subscribe('beforeSelect',this._quickSelect.bind(this));this._quickSelectListener=this._view.subscribe('quickSelect',this._quickSelect.bind(this));};k.prototype._quickSelect=function(l,m){'use strict';if(m&&m.selected)return true;var n=this._input.getValue().toArray(),o=new h(n),p=o.toString();if(!p)return true;var q=new i(j).addQueryData('q',p),r={input_query:p,type:'quickselect',text:p,position:0,with_mouse:0,semantic:'quickselect('+q.toString()+')',extra_uri_params:{source:'quickselect',sid:this._core.getSessionID()},uri:q};this._core.inform('quickSelectRedirect',r);this._core.executeQuery(r);return false;};k.prototype.disable=function(){'use strict';this._beforeSelectListener&&this._view.unsubscribe(this._beforeSelectListener);this._quickSelectListener&&this._view.unsubscribe(this._quickSelectListener);};f.exports=k;},null);
__d('FacebarTypeaheadRecorderBasic',['FacebarTypeaheadRecorder'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){'use strict';this._typeahead=j;}i.prototype.enable=function(){'use strict';var j=this._typeahead;this._recorder=new h(j);};i.prototype.disable=function(){'use strict';this._typeahead.unsubscribe(this._subscription);this._recorder=null;this._subscription=null;};Object.assign(i.prototype,{_subscription:null});f.exports=i;},null);
__d('FacebarTypeaheadSelectAll',['requestAnimationFrame'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){'use strict';this._core=j.getCore();this._listener=null;}i.prototype.enable=function(){'use strict';var j=this._core.input;this._listener=this._core.subscribe('focus',function(k,l){var m=l&&l.catchup;m||h(function(){j.selectInput();});});};i.prototype.disable=function(){'use strict';this._listener&&this._core.unsubscribe(this._listener);};f.exports=i;},null);
__d('FacebarTypeaheadShortcut',['FacebarTypeaheadShortcutConfig','KeyEventController','Run','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();function l(m){'use strict';this._input=m.core.input;this._view=m.view;this._listener=null;}l.prototype.enable=function(){'use strict';this._registerListener();};l.prototype.disable=function(){'use strict';};l.prototype._registerListener=function(){'use strict';this._listener&&this._listener.remove();this._listener=i.registerKey('SLASH',this._handleKeydown.bind(this));j.onLeave((function(){k(this._registerListener.bind(this),0);}).bind(this));};l.prototype._handleKeydown=function(m){'use strict';var n=m.getModifiers().shift;if(n&&!h.gkWebShortcut)return;this._selectInput(n);return false;};l.prototype._selectInput=function(m){'use strict';this._view.setAutoSelect(true);this._input.focus();this._input.selectInput();this._input.inform('shortcut',{shift:m});};f.exports=l;},null);
__d('FacebarTypeaheadSizeAdjuster',['getElementChildren','confine','emptyFunction','isTextNode','Style','Vector'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=12,o=20,p=50,q=200,r=5;function s(u){if(k(u))return 0;return m.getElementDimensions(u).x;}function t(u){'use strict';this._core=u.getCore();this._view=this._core.view;this._input=this._core.input;this._cachedSizes={};this._appliedSize=null;this._defaultSize=this.getDefaultFontSize();this._calculatedSize=this._defaultSize;this._containerWidth=this.getContainerWidth();}t.prototype.enable=function(){'use strict';this._input.subscribe('change',this.adjustFontSize.bind(this));this.adjustFontSize();};t.prototype.getContainerWidth=function(){'use strict';return m.getElementDimensions(this._input.getElement()).x;};t.prototype.getDefaultFontSize=function(){'use strict';var u=l.get(this._input.getElement(),'font-size'),v=/^([\d\.]+)px$/.exec(u),w=v&&Number(v[1]);return Math.max(n,Math.min(o,w));};t.prototype.calculateFontSize=function(){'use strict';var u=this.getTextWidth(),v=this._calculatedSize;if(u>this._containerWidth-p){v--;}else if(u<this._containerWidth-q)v++;this._calculatedSize=i(v,n,this._defaultSize);return this._calculatedSize;};t.prototype.getTextWidth=function(){'use strict';var u=this._calculatedSize+this.getValueKey();if(!this._cachedSizes.hasOwnProperty(u))this._cachedSizes[u]=this.measureTextWidth();return this._cachedSizes[u];};t.prototype.getValueKey=function(){'use strict';var u=this._core.getValue().getHash(),v=r*Math.floor(u.length/r);return u.substr(0,v);};t.prototype.measureTextWidth=function(){'use strict';var u=h(this._input.getRawInputElement());return u.reduce(function(v,w){return v+s(w);},0);};t.prototype.adjustFontSize=function(){'use strict';for(var u=0;u<10;u++){var v=this.calculateFontSize();if(v!=this._appliedSize){this._appliedSize=v;l.set(this._input.getElement(),'font-size',v+'px');l.set(this._view.content,'font-size',v+'px');}else break;}};Object.assign(t.prototype,{disable:j});f.exports=t;},null);
__d('TypeaheadSearchMegaphone',['AsyncRequest','DOM','DOMQuery','Event','Parent'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();function m(n){'use strict';this.$TypeaheadSearchMegaphone1=n;}m.prototype.enable=function(){'use strict';var n=j.scry(this.$TypeaheadSearchMegaphone1.getView().getElement(),'.megaphone_location_gsv2_typeahead')[0];if(!n)return;this.ajaxify=j.scry(n,'a.megaphone_hide_link[ajaxify]')[0].getAttribute('ajaxify');j.scry(n,'a').forEach(this.processLink,this);k.listen(n,'click',this.onClick.bind(this));};m.prototype.disable=function(){'use strict';};m.prototype.processLink=function(n){'use strict';if(n.getAttribute('ajaxify'))return;i.setAttributes(n,{target:'_blank'});};m.prototype.onClick=function(event){'use strict';var n=l.byTag(event.target,'a');if(!n||n.getAttribute('ajaxify'))return;h.bootstrap(this.ajaxify,n);};f.exports=m;},null);